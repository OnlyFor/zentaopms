var Ht=Object.defineProperty,Pt=Object.defineProperties;var $t=Object.getOwnPropertyDescriptors;var ct=Object.getOwnPropertySymbols;var Ut=Object.prototype.hasOwnProperty,Nt=Object.prototype.propertyIsEnumerable;var lt=(e,n,t)=>n in e?Ht(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Y=(e,n)=>{for(var t in n||(n={}))Ut.call(n,t)&&lt(e,t,n[t]);if(ct)for(var t of ct(n))Nt.call(n,t)&&lt(e,t,n[t]);return e},Ce=(e,n)=>Pt(e,$t(n));var we=(e,n,t)=>new Promise((o,s)=>{var h=C=>{try{S(t.next(C))}catch(p){s(p)}},l=C=>{try{S(t.throw(C))}catch(p){s(p)}},S=C=>C.done?o(C.value):Promise.resolve(C.value).then(h,l);S((t=t.apply(e,n)).next())});import{u as re,E as ae,t as oe,q as Ke,r as Kt,o as Yt,s as Be,v as Gt,w as Se,d as St,x as Ie,g as Xt,C as Wt,H as I,y as Re,a as zt,b as wt,O as qt,F as jt,N as Jt,z as it}from"./useSync.hook-388aab4f.js";import{x as ot,a6 as Tt,aJ as Vt,ah as x,c7 as xt,c8 as Dt,cn as dt,cm as Qt,c4 as Ve,co as j,cc as Ye,ai as Zt,d as ue,bI as Ae,u as ke,a5 as N,o as T,h as q,j as at,F as ve,A as me,ad as de,aQ as ne,f as c,a9 as ce,z,p as le,c as U,w as D,L as ye,bV as Qe,bW as He,bX as Ze,bY as At,a4 as rt,y as $e,aj as ft,R as pe,r as H,cp as en,a3 as Ue,q as Q,cq as pt,H as kt,I as Ft,e as O,m as Ee,t as fe,aI as tn,aT as nn,cr as ge,cs as Pe,ct as sn,c3 as on,cu as an,ak as rn,cv as un,J as bt,Q as vt,c0 as Ge,X as Xe,Y as We,bS as cn,V as ln,cw as dn,cx as fn,W as pn,bT as vn,S as Oe,c1 as ze}from"./index.js";import{u as ut,d as hn}from"./index-be50b3cd.js";import{a as gn,b as ht,l as _n,g as mn}from"./plugin-15f8df0f.js";import{i as Cn,g as yn,a as En,b as Sn,h as wn,o as Tn,f as xn}from"./useItem.hook-3c9439ee.js";import{C as Dn}from"./index-d6c0e89a.js";import{i as De}from"./icon-c8468b5e.js";import{E as An}from"./index-c2bd1e67.js";import"./tables_list-992ce806.js";import"./index-ac76b4c0.js";import"./index-e9ce2be4.js";const Te=re(),kn=()=>{ot(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,document.getElementById("go-chart-edit-layout")),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,document.getElementById("go-chart-edit-content"));const e=Te.listenerScale();Tt(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,null),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,null),e()})})};var Ot={exports:{}};(function(e){(function(n){var t,o={},s={16:!1,18:!1,17:!1,91:!1},h="all",l={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},S={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},C=function(r){return S[r]||r.toUpperCase().charCodeAt(0)},p=[];for(t=1;t<20;t++)S["f"+t]=111+t;function _(r,d){for(var A=r.length;A--;)if(r[A]===d)return A;return-1}function f(r,d){if(r.length!=d.length)return!1;for(var A=0;A<r.length;A++)if(r[A]!==d[A])return!1;return!0}var u={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function a(r){for(t in s)s[t]=r[u[t]]}function v(r){var d,A,k,X,K,ie;if(d=r.keyCode,_(p,d)==-1&&p.push(d),(d==93||d==224)&&(d=91),d in s){s[d]=!0;for(k in l)l[k]==d&&(m[k]=!0);return}if(a(r),!!m.filter.call(this,r)&&d in o){for(ie=W(),X=0;X<o[d].length;X++)if(A=o[d][X],A.scope==ie||A.scope=="all"){K=A.mods.length>0;for(k in s)(!s[k]&&_(A.mods,+k)>-1||s[k]&&_(A.mods,+k)==-1)&&(K=!1);(A.mods.length==0&&!s[16]&&!s[18]&&!s[17]&&!s[91]||K)&&A.method(r,A)===!1&&(r.preventDefault?r.preventDefault():r.returnValue=!1,r.stopPropagation&&r.stopPropagation(),r.cancelBubble&&(r.cancelBubble=!0))}}}function g(r){var d=r.keyCode,A,k=_(p,d);if(k>=0&&p.splice(k,1),(d==93||d==224)&&(d=91),d in s){s[d]=!1;for(A in l)l[A]==d&&(m[A]=!1)}}function y(){for(t in s)s[t]=!1;for(t in l)m[t]=!1}function m(r,d,A){var k,X;k=i(r),A===void 0&&(A=d,d="all");for(var K=0;K<k.length;K++)X=[],r=k[K].split("+"),r.length>1&&(X=b(r),r=[r[r.length-1]]),r=r[0],r=C(r),r in o||(o[r]=[]),o[r].push({shortcut:k[K],scope:d,method:A,key:k[K],mods:X})}function R(r,d){var A,k,X=[],K,ie,he;for(A=i(r),ie=0;ie<A.length;ie++){if(k=A[ie].split("+"),k.length>1&&(X=b(k),r=k[k.length-1]),r=C(r),d===void 0&&(d=W()),!o[r])return;for(K=0;K<o[r].length;K++)he=o[r][K],he.scope===d&&f(he.mods,X)&&(o[r][K]={})}}function L(r){return typeof r=="string"&&(r=C(r)),_(p,r)!=-1}function F(){return p.slice(0)}function P(r){var d=(r.target||r.srcElement).tagName;return!(d=="INPUT"||d=="SELECT"||d=="TEXTAREA")}for(t in l)m[t]=!1;function G(r){h=r||"all"}function W(){return h||"all"}function M(r){var d,A,k;for(d in o)for(A=o[d],k=0;k<A.length;)A[k].scope===r?A.splice(k,1):k++}function i(r){var d;return r=r.replace(/\s/g,""),d=r.split(","),d[d.length-1]==""&&(d[d.length-2]+=","),d}function b(r){for(var d=r.slice(0,r.length-1),A=0;A<d.length;A++)d[A]=l[d[A]];return d}function E(r,d,A){r.addEventListener?r.addEventListener(d,A,!1):r.attachEvent&&r.attachEvent("on"+d,function(){A(window.event)})}E(document,"keydown",function(r){v(r)}),E(document,"keyup",g),E(window,"focus",y);var B=n.key;function $(){var r=n.key;return n.key=B,r}n.key=m,n.key.setScope=G,n.key.getScope=W,n.key.deleteScope=M,n.key.filter=P,n.key.isPressed=L,n.key.getPressedKeyCodes=F,n.key.noConflict=$,n.key.unbind=R,e.exports=m})(Vt)})(Ot);var Z=Ot.exports;const ee=re(),se=e=>`${xt.CTRL}+${e}`,Le=e=>`${xt.SHIFT}+${e}`,J={[x.ARROW_UP]:se("up"),[x.ARROW_RIGHT]:se("right"),[x.ARROW_DOWN]:se("down"),[x.ARROW_LEFT]:se("left"),[x.COPY]:se("c"),[x.CUT]:se("x"),[x.PARSE]:se("v"),[x.DELETE]:"delete",[x.BACK]:se("z"),[x.FORWORD]:se(Le("z")),[x.GROUP]:se("g"),[x.UN_GROUP]:se(Le("g")),[x.LOCK]:se("l"),[x.UNLOCK]:se(Le("l")),[x.HIDE]:se("h"),[x.SHOW]:se(Le("h"))},te=e=>`${Dt.CTRL}+${e}`,Me=e=>`${Dt.SHIFT}+${e}`,V={[x.ARROW_UP]:te("arrowup"),[x.ARROW_RIGHT]:te("arrowright"),[x.ARROW_DOWN]:te("arrowdown"),[x.ARROW_LEFT]:te("arrowleft"),[x.COPY]:te("c"),[x.CUT]:te("x"),[x.PARSE]:te("v"),[x.DELETE]:te("backspace"),[x.BACK]:te("z"),[x.FORWORD]:te(Me("z")),[x.GROUP]:te("g"),[x.UN_GROUP]:te(Me("g")),[x.LOCK]:te("l"),[x.UNLOCK]:te(Me("l")),[x.HIDE]:te("h"),[x.SHOW]:te(Me("h"))},Fn=[J.up,J.right,J.down,J.left,J.delete,J.copy,J.cut,J.parse,J.back,J.forward,J.group,J.unGroup,J.lock,J.unLock,J.hide,J.show],bn=[V.up,V.right,V.down,V.left,V.delete,V.copy,V.cut,V.parse,V.back,V.forward,V.group,V.unGroup,V.lock,V.unLock,V.hide,V.show],On=()=>{window.$KeyboardActive={ctrl:!1,space:!1},document.onkeydown=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(dt(e.keyCode),n){case 17:window.$KeyboardActive.ctrl=!0;break;case 32:window.$KeyboardActive.space=!0;break}},document.onkeyup=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(dt(),n){case 17:window.$KeyboardActive.ctrl=!1;break;case 32:window.$KeyboardActive.space=!1;break}}},Ln=()=>{const n=(t,o)=>{switch(o){case t.up:Z(o,oe(()=>(ee.setMove(x.ARROW_UP),!1),50));break;case t.right:Z(o,oe(()=>(ee.setMove(x.ARROW_RIGHT),!1),50));break;case t.down:Z(o,oe(()=>(ee.setMove(x.ARROW_DOWN),!1),50));break;case t.left:Z(o,oe(()=>(ee.setMove(x.ARROW_LEFT),!1),50));break;case t.delete:Z(o,Ke(()=>(ee.removeComponentList(),!1),50));break;case t.copy:Z(o,Ke(()=>(ee.setCopy(),!1),50));break;case t.cut:Z(o,Ke(()=>(ee.setCut(),!1),50));break;case t.parse:Z(o,oe(()=>(ee.setParse(),!1),50));break;case t.back:Z(o,oe(()=>(ee.setBack(),!1),50));break;case t.forward:Z(o,oe(()=>(ee.setForward(),!1),50));break;case t.group:Z(o,oe(()=>(ee.setGroup(),!1),50));break;case t.unGroup:Z(o,oe(()=>(ee.setUnGroup(),!1),50));break;case t.lock:Z(o,oe(()=>(ee.setLock(),!1),50));break;case t.unLock:Z(o,oe(()=>(ee.setUnLock(),!1),50));break;case t.hide:Z(o,oe(()=>(ee.setHide(),!1),50));break;case t.show:Z(o,oe(()=>(ee.setShow(),!1),50));break}};Fn.forEach(t=>{n(J,t)}),bn.forEach(t=>{n(V,t)}),On()},w=re(),{onClickOutSide:Mn}=ut(),Rn=e=>we(void 0,null,function*(){e.preventDefault();try{gn();const n=e.dataTransfer.getData(Qt.DRAG_KEY);if(!n){ht();return}w.setEditCanvas(ae.IS_CREATE,!1);const t=Ve(n);let o;if(t.sourceID){let h=yield Kt(t.sourceID,t.category);if(!h){window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...");return}o=h.chartConfig}else o=t;let s=yield Yt(o);j(s,e.offsetX-s.attr.w/2,e.offsetY-s.attr.h/2),w.addComponentList(s,!1,!0),w.setTargetSelectChart(s.id),ht()}catch(n){_n(),window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...")}}),gt=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")},Lt=(e,n)=>{if(n){w.setTargetSelectChart(n.id);return}w.setTargetSelectChart(void 0)},Bn=(e,n)=>{var p;if(e.which==2||(p=window.$KeyboardActive)!=null&&p.space)return;Lt();const t=e.offsetX,o=e.offsetY,s=e.screenX,h=e.screenY,l=w.getEditCanvas.scale;w.setMousePosition(void 0,void 0,t,o);const S=Be.exports.throttle(_=>{w.setTargetSelectChart(),w.setEditCanvas(ae.IS_SELECT,!0);const f=t+_.screenX-s,u=o+_.screenY-h;w.setMousePosition(f,u);const a={x1:0,y1:0,x2:0,y2:0};f>t&&u>o?(a.x1=t,a.y1=o,a.x2=Math.round(t+(_.screenX-s)/l),a.y2=Math.round(o+(_.screenY-h)/l)):f>t&&u<o?(a.x1=t,a.y1=Math.round(o-(h-_.screenY)/l),a.x2=Math.round(t+(_.screenX-s)/l),a.y2=o):f<t&&u>o?(a.x1=Math.round(t-(s-_.screenX)/l),a.y1=o,a.x2=t,a.y2=Math.round(o+(_.screenY-h)/l)):(a.x1=Math.round(t-(s-_.screenX)/l),a.y1=Math.round(o-(h-_.screenY)/l),a.x2=t,a.y2=o),w.getComponentList.forEach(v=>{if(!w.getTargetChart.selectId.includes(v.id)){const{x:g,y,w:m,h:R}=v.attr,L={x1:g,y1:y,x2:g+m,y2:y+R};L.x1-a.x1>=0&&L.y1-a.y1>=0&&L.x2-a.x2<=0&&L.y2-a.y2<=0&&!v.status.lock&&!v.status.hide&&w.setTargetSelectChart(v.id,!0)}})},30),C=()=>{S.cancel(),w.setEditCanvas(ae.IS_SELECT,!1),w.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",C)};document.addEventListener("mousemove",S),document.addEventListener("mouseup",C)},Mt=()=>({mouseClickHandle:(s,h)=>{var l;if(s.preventDefault(),s.stopPropagation(),!h.status.lock&&(l=window.$KeyboardActive)!=null&&l.ctrl)if(w.targetChart.selectId.includes(h.id)){const S=w.targetChart.selectId.filter(C=>C!==h.id);w.setTargetSelectChart(S)}else w.setTargetSelectChart(h.id,!0)},mousedownHandle:(s,h)=>{var y;if(s.preventDefault(),s.stopPropagation(),h.status.lock||(Mn(),s.buttons===Ye.LEFT&&((y=window.$KeyboardActive)==null?void 0:y.ctrl)))return;const l=w.getTargetChart.selectId;if(s.buttons===Ye.RIGHT&&l.length>1&&l.includes(h.id)||(w.setTargetSelectChart(h.id),s.buttons===Ye.RIGHT))return;const S=w.getEditCanvas.scale,C=w.getEditCanvasConfig.width,p=w.getEditCanvasConfig.height,_=new Map;w.getTargetChart.selectId.forEach(m=>{const R=w.fetchTargetIndex(m);if(R!==-1){const{x:L,y:F,w:P,h:G}=Zt(w.getComponentList[R]).attr;_.set(m,{x:L,y:F,w:P,h:G})}});const f=s.screenX,u=s.screenY;let a=[];w.getTargetChart.selectId.forEach(m=>{if(!_.has(m))return;const R=w.fetchTargetIndex(m);a.push(Be.exports.cloneDeep(w.getComponentList[R]))}),w.setMousePosition(void 0,void 0,f,u);const v=Be.exports.throttle(m=>{w.setEditCanvas(ae.IS_DRAG,!0),w.setMousePosition(m.screenX,m.screenY);let R=(m.screenX-f)/S,L=(m.screenY-u)/S;w.getTargetChart.selectId.forEach(F=>{if(!_.has(F))return;const P=w.fetchTargetIndex(F),{x:G,y:W,w:M,h:i}=_.get(F),b=w.getComponentList[P];let E=Math.round(G+R),B=Math.round(W+L);const $=50;E=E<-M+$?-M+$:E,B=B<-i+$?-i+$:B,E=E>C-$?C-$:E,B=B>p-$?p-$:B,b&&!Number.isNaN(E)&&!Number.isNaN(B)&&(b.attr=Object.assign(b.attr,{x:E,y:B}))})},20),g=()=>{try{w.setMousePosition(0,0,0,0),w.setEditCanvas(ae.IS_DRAG,!1),a.length&&(w.getTargetChart.selectId.forEach(m=>{if(!_.has(m))return;const R=w.fetchTargetIndex(m),L=w.getComponentList[R];a.forEach(F=>{F.id===m&&(F.attr=Object.assign(F.attr,{offsetX:L.attr.x-F.attr.x,offsetY:L.attr.y-F.attr.y}))})}),w.moveComponentList(a)),document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",g)}catch(m){console.log(m)}};document.addEventListener("mousemove",v),document.addEventListener("mouseup",g)},mouseenterHandle:(s,h)=>{s.preventDefault(),s.stopPropagation(),w.getEditCanvas.isSelect||w.setTargetHoverChart(h.id)},mouseleaveHandle:(s,h)=>{s.preventDefault(),s.stopPropagation(),w.setEditCanvas(ae.IS_DRAG,!1),w.setTargetHoverChart(void 0)}}),In=(e,n,t)=>{e.stopPropagation(),e.preventDefault(),w.setEditCanvas(ae.IS_DRAG,!0);const o=w.getEditCanvas.scale,s=t.x,h=t.y,l=t.w,S=t.h,C=t.lockScale,p=t.scaleRatio,_=t.minWidth,f=e.screenX,u=e.screenY,a=l-_;w.setMousePosition(f,u);const v=Be.exports.throttle(y=>{w.setMousePosition(y.screenX,y.screenY);let m=Math.round((y.screenX-f)/o),R=Math.round((y.screenY-u)/o);const L=/t/.test(n),F=/b/.test(n),P=/l/.test(n),G=/r/.test(n);let W=S+(L?-R:F?R:0),M=l+(P?-m:G?m:0);C&&((L||F)&&(M=Math.round(W*p)),(P||G)&&(W=Math.round(M/p))),P&&(M<_&&a>0&&(m=a),a===0&&m>0&&(m=0)),t.h=W>0?W:0,t.w=M>0?M:0,t.x=s+(P?m:0),t.y=h+(L?R:0)},50),g=()=>{w.setEditCanvas(ae.IS_DRAG,!1),w.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",g)};document.addEventListener("mousemove",v),document.addEventListener("mouseup",g)};const Hn=["onMousedown"],Pn=ue({__name:"index",props:{item:{type:Object,required:!0},hiddenPoint:{type:Boolean,required:!1}},setup(e){Ae(f=>({"026d39a0":l.value}));const n=e,t=ke(),o=re(),s=["t","r","b","l","lt","rt","lb","rb"],h=["n","e","s","w","nw","ne","sw","se"],l=N(()=>t.getAppTheme),S=N(()=>n.item.status.lock?!1:n.item.id===o.getTargetChart.hoverId),C=N(()=>{const f=n.item.id;return n.item.status.lock?!1:o.getTargetChart.selectId.find(u=>u===f)}),p=N(()=>n.item.status.lock),_=N(()=>n.item.status.hide);return(f,u)=>(T(),q("div",{class:de(["go-shape-box",{lock:p.value,hide:_.value}])},[at(f.$slots,"default",{},void 0,!0),e.hiddenPoint?ce("",!0):(T(!0),q(ve,{key:0},me(C.value?s:[],(a,v)=>(T(),q("div",{class:de(`shape-point ${a}`),key:v,style:ne(c(Gt)(a,v,e.item.attr,h)),onMousedown:g=>c(In)(g,a,e.item.attr)},null,46,Hn))),128)),z("div",{class:"shape-modal",style:ne(c(Se)(e.item.attr))},[z("div",{class:de(["shape-modal-select",{active:C.value}])},null,2),z("div",{class:de(["shape-modal-change",{selectActive:C.value,hoverActive:S.value}])},null,2)],4)],2))}});var et=le(Pn,[["__scopeId","data-v-5f8854aa"]]);const $n={class:"go-edit-group-box"},Un=ue({__name:"index",props:{groupData:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){const n=re(),{handleContextMenu:t}=ut(),{mouseenterHandle:o,mouseleaveHandle:s,mousedownHandle:h,mouseClickHandle:l}=Mt(),S=(_,f,u)=>{const a=v=>f.filter(g=>v.includes(g.key));if(n.getTargetChart.selectId.length>1)return a([x.GROUP,x.DELETE]);{const v=[];u.status.lock?v.push(x.LOCK):v.push(x.UNLOCK),u.status.hide?v.push(x.HIDE):v.push(x.SHOW);const g=[x.UN_GROUP];return[...a(g),hn(),..._.filter(y=>!v.includes(y.key))]}},C=N(()=>{const _=n.getEditCanvasConfig.chartThemeColor;return St[_]}),p=N(()=>n.getEditCanvasConfig.chartThemeSetting);return(_,f)=>(T(),q("div",$n,[(T(),U(c(et),{key:e.groupData.id,"data-id":e.groupData.id,index:e.groupIndex,item:e.groupData,hiddenPoint:!0,class:de(c(Qe)(e.groupData.styles.animations)),style:ne(Y(Y(Y(Y(Y({},c(Ie)(e.groupData.attr,e.groupIndex)),c(Se)(e.groupData.attr)),c(He)(e.groupData.styles)),c(Ze)(e.groupData.styles)),c(At)(e.groupData.styles))),onClick:f[0]||(f[0]=u=>c(l)(u,e.groupData)),onMousedown:f[1]||(f[1]=u=>c(h)(u,e.groupData)),onMouseenter:f[2]||(f[2]=u=>c(o)(u,e.groupData)),onMouseleave:f[3]||(f[3]=u=>c(s)(u,e.groupData)),onContextmenu:f[4]||(f[4]=u=>c(t)(u,e.groupData,S))},{default:D(()=>[(T(!0),q(ve,null,me(e.groupData.groupList,u=>(T(),U(c(et),{key:u.id,"data-id":u.id,index:e.groupIndex,item:u,hiddenPoint:!0,style:ne(Y({},c(Ie)(u.attr,e.groupIndex)))},{default:D(()=>[(T(),U(ye(u.chartConfig.chartKey),{class:de(["edit-content-chart",c(Qe)(u.styles.animations)]),chartConfig:u,themeSetting:p.value,themeColor:C.value,style:ne(Y(Y(Y({},c(Se)(u.attr)),c(He)(u.styles)),c(Ze)(u.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","item","style"]))),128))]),_:1},8,["data-id","index","item","class","style"]))]))}});const Nn={class:"go-edit-align-line"},Kn=ue({__name:"index",setup(e){Ae(v=>({"32d4d33a":l.value}));const n=ke(),t=re(),o=rt(),s=$e({lineArr:["rowt","rowc","rowb","coll","colc","colr"],select:new Map,sorptioned:{x:!1,y:!1}}),h=v=>v?{left:`${v.x?v.x:0}px`,top:`${v.y?v.y:0}px`}:{},l=N(()=>n.getAppTheme),S=N(()=>o.getChartAlignRange),C=N(()=>t.getEditCanvas[ae.IS_DRAG]),p=(v,g)=>Math.abs(v-g)<=S.value,_=N(()=>t.getTargetChart.selectId),f=N(()=>t.getComponentList[t.fetchTargetIndex()]),u=N(()=>{var v;return((v=f.value)==null?void 0:v.attr)||{}}),a=N(()=>({id:"0",attr:{w:ft(t.getEditCanvasConfig.width),h:ft(t.getEditCanvasConfig.height),x:0,y:0,offsetX:0,offsetY:0,zIndex:0,scaleRatio:1.5,lockScale:!1,disabledHeight:!1,minWidth:50}}));return pe(()=>t.getMousePosition,oe(()=>{try{if(!C.value||_.value.length!==1)return;const v=u.value.w,g=u.value.h,y=u.value.x,m=y+v/2,R=y+v,L=[y,m,R],F=u.value.y,P=F+g/2,G=F+g,W=[F,P,G];s.select.clear(),s.sorptioned.y=!1;const M=t.getComponentList.map(i=>({id:i.id,attr:i.attr}));M.push(a.value),s.lineArr.forEach(i=>{M.forEach(b=>{if(_.value[0]===b.id)return;const E=b.attr.w,B=b.attr.h,$=b.attr.x,r=$+E/2,d=$+E,A=[$,r,d],k=b.attr.y,X=k+B/2,K=k+B,ie=[k,X,K];i.includes("rowt")&&(p(F,k)&&(s.select.set(i,{y:k}),j(f.value,y,k)),p(F,X)&&(s.select.set(i,{y:X}),j(f.value,y,X)),p(F,K)&&(s.select.set(i,{y:K}),j(f.value,y,K))),i.includes("rowc")&&(p(P,k)&&(s.select.set(i,{y:k}),j(f.value,y,k-g/2)),p(P,X)&&(s.select.set(i,{y:X}),j(f.value,y,X-g/2)),p(P,K)&&(s.select.set(i,{y:K}),j(f.value,y,K-g/2))),i.includes("rowb")&&(p(G,k)&&(s.select.set(i,{y:k}),j(f.value,y,k-g)),p(G,X)&&(s.select.set(i,{y:X}),j(f.value,y,X-g)),p(G,K)&&(s.select.set(i,{y:K}),j(f.value,y,K-g))),i.includes("coll")&&(p(y,$)&&(s.select.set(i,{x:$}),j(f.value,$,F)),p(y,r)&&(s.select.set(i,{x:r}),j(f.value,r,F)),p(y,d)&&(s.select.set(i,{x:d}),j(f.value,d,F))),i.includes("colc")&&(p(m,$)&&(s.select.set(i,{x:$}),j(f.value,$-v/2,F)),p(m,r)&&(s.select.set(i,{x:r}),j(f.value,r-v/2,F)),p(m,d)&&(s.select.set(i,{x:d}),j(f.value,d-v/2,F))),i.includes("colr")&&(p(R,$)&&(s.select.set(i,{x:$}),j(f.value,$-v,F)),p(R,r)&&(s.select.set(i,{x:r}),j(f.value,r-v,F)),p(R,d)&&(s.select.set(i,{x:d}),j(f.value,d-v,F)))})})}catch(v){console.log(v)}},200),{deep:!0}),pe(()=>C.value,v=>{v||(s.select.clear(),s.sorptioned.y=!1)}),(v,g)=>(T(),q("div",Nn,[(T(!0),q(ve,null,me(s.lineArr,y=>(T(),q("div",{class:de(["line",[y.includes("row")?"row":"col",s.select.has(y)&&"visible"]]),key:y,style:ne(h(s.select.get(y)))},null,6))),128))]))}});var Yn=le(Kn,[["__scopeId","data-v-41123ead"]]);const Gn=ue({__name:"index",setup(e){return(n,t)=>{const o=H("n-watermark");return T(),U(o,{id:"go-edit-watermark",content:c(en),cross:"",selectable:"","font-size":16,"line-height":16,width:500,height:150,"x-offset":12,"y-offset":80,rotate:-15},null,8,["content"])}}});var Xn=le(Gn,[["__scopeId","data-v-e5cd93da"]]);const Rt=e=>(kt("data-v-6aae2e54"),e=e(),Ft(),e),Wn=Rt(()=>z("div",{class:"select-background"},null,-1)),zn=Rt(()=>z("div",{class:"select-border"},null,-1)),qn=[Wn,zn],jn=ue({__name:"index",setup(e){Ae(S=>({bb49f51e:h.value}));const n=ke(),t=re(),{isSelect:o,scale:s}=Ue(t.getEditCanvas),h=N(()=>n.getAppTheme),l=Q();return pe(()=>t.getMousePosition,S=>{if(!o.value)return;const{startX:C,startY:p,x:_,y:f}=S,u={zIndex:pt,x:0,y:0,w:0,h:0,offsetX:0,offsetY:0,lockScale:!1,scaleRatio:1.5,disabledHeight:!1,minWidth:50};_>C&&f>p?(u.x=C,u.y=p,u.w=Math.round((_-C)/s.value),u.h=Math.round((f-p)/s.value)):_>C&&f<p?(u.x=C,u.w=Math.round((_-C)/s.value),u.h=Math.round((p-f)/s.value),u.y=p-u.h):_<C&&f>p?(u.y=p,u.w=Math.round((C-_)/s.value),u.h=Math.round((f-p)/s.value),u.x=C-u.w):(u.w=Math.round((C-_)/s.value),u.h=Math.round((p-f)/s.value),u.x=C-u.w,u.y=p-u.h),l.value=Y(Y({},Ie(u,pt)),Se(u))},{deep:!0}),(S,C)=>c(o)?(T(),q("div",{key:0,class:"go-edit-select",style:ne(l.value)},qn,4)):ce("",!0)}});var Jn=le(jn,[["__scopeId","data-v-6aae2e54"]]);const Vn=ue({__name:"index",setup(e){const n=re(),{getEditCanvasConfig:t,getEditCanvas:o}=Ue(n),s=N(()=>({w:t.value.width,h:t.value.height})),h=N(()=>{const S={transform:`scale(${o.value.scale})`};return Y(Y({},Se(s.value)),S)}),l=N(()=>{const S=o.value.isCreate&&{"z-index":99999};return Y(Y({},Se(s.value)),S)});return(S,C)=>(T(),q("div",{class:"go-edit-range go-transition",style:ne(h.value),onMousedown:C[0]||(C[0]=p=>c(Bn)(p,void 0))},[at(S.$slots,"default",{},void 0,!0),O(c(Xn)),O(c(Yn)),O(c(Jn)),z("div",{class:"go-edit-range-model",style:ne(l.value)},null,4)],36))}});var Qn=le(Vn,[["__scopeId","data-v-52e445d0"]]),Bt=!!(typeof window!="undefined"&&window.document&&window.document.createElement),tt=!1,nt=!1;try{var qe={get passive(){return tt=!0},get once(){return nt=tt=!0}};Bt&&(window.addEventListener("test",qe,qe),window.removeEventListener("test",qe,!0))}catch(e){}function Zn(e,n,t,o){if(o&&typeof o!="boolean"&&!nt){var s=o.once,h=o.capture,l=t;!nt&&s&&(l=t.__once||function S(C){this.removeEventListener(n,S,h),t.call(this,C)},t.__once=l),e.addEventListener(n,l,tt?o:h)}e.addEventListener(n,t,o)}function es(e,n,t,o){var s=o&&typeof o!="boolean"?o.capture:o;e.removeEventListener(n,t,s),t.__once&&e.removeEventListener(n,t.__once,s)}function _t(e,n,t,o){return Zn(e,n,t,o),function(){es(e,n,t,o)}}var mt=new Date().getTime();function ts(e){var n=new Date().getTime(),t=Math.max(0,16-(n-mt)),o=setTimeout(e,t);return mt=n,o}var ns=["","webkit","moz","o","ms"],Ct=ts,yt=function(n,t){return n+(n?t[0].toUpperCase()+t.substr(1):t)+"AnimationFrame"};Bt&&ns.some(function(e){var n=yt(e,"request");return n in window&&(yt(e,"cancel"),Ct=function(o){return window[n](o)}),!!Ct});Function.prototype.bind.call(Function.prototype.call,[].slice);Function.prototype.bind.call(Function.prototype.call,[].slice);const ss={class:"go-sketch-rule"},os={key:1,class:"fix-edit-screens-block"},je=20,as=ue({__name:"index",setup(e){Ae(E=>({"6f694401":F.value,ed8dd9a8:R.value,"58b617f4":f.value}));const n=re(),t=Xt(),o=ke();let s=[0,0],h=[0,0];const l=Q(),S=Q(!0),C=Q(),p=Q(),_=Q(!1),f=Q("auto"),{width:u,height:a}=Ue(n.getEditCanvasConfig),v=Q(0),g=Q(0),y=$e({h:[],v:[]}),m=N(()=>n.getEditCanvas.scale),R=N(()=>`${a.value*2}px`),L=N(()=>o.getDarkTheme?{bgColor:"#18181c",longfgColor:"#4d4d4d",shortfgColor:"#4d4d4d",fontColor:"#4d4d4d",shadowColor:"#18181c",borderColor:"#18181c",cornerActiveColor:"#18181c"}:{}),F=N(()=>o.getAppTheme),P=E=>{if(E.ctrlKey||E.metaKey){E.preventDefault();let B=m.value;if(E.wheelDelta>=0&&m.value<2){B=m.value+.05,n.setScale(B);return}E.wheelDelta<0&&m.value>.1&&(B=m.value-.05,n.setScale(B))}},G=()=>{if(!l.value)return;const E=l.value.getBoundingClientRect(),B=C.value.getBoundingClientRect();v.value=(E.left+je-B.left)/m.value,g.value=(E.top+je-B.top)/m.value},W=E=>{var A,k;if(E.preventDefault(),E.stopPropagation(),E.which==2)_.value=!0;else if(!((A=window.$KeyboardActive)!=null&&A.space))return;(k=document.activeElement)==null||k.blur();const B=E.pageX,$=E.pageY,r=_t(window,"mousemove",X=>{const K=X.pageX-B,ie=X.pageY-$,[he,Fe]=s,[Ne,be]=h;s=[Fe,K],h=[be,ie],l.value.scrollLeft-=Fe>he?Math.abs(Fe-he):-Math.abs(Fe-he),l.value.scrollTop-=be>Ne?Math.abs(be-Ne):-Math.abs(be-Ne)}),d=_t(window,"mouseup",()=>{r(),d(),s=[0,0],h=[0,0],_.value=!1})},M=()=>{const E=document.getElementById("go-chart-edit-layout");return E?{height:E.clientHeight-25,width:E.clientWidth}:{width:u.value,height:a.value}},i=()=>{S.value=!1,setTimeout(()=>{S.value=!0},10)},b=()=>{const{width:E,height:B}=p.value.getBoundingClientRect(),{width:$,height:r}=M();l.value.scrollLeft=E/2-$/2,l.value.scrollTop=B/2-r/2};return pe(()=>o.getDarkTheme,()=>{i()}),pe(()=>m.value,(E,B)=>{B!==E?(t.setItemUnHandle(Wt.RE_POSITION_CANVAS,!1),G(),setTimeout(()=>{b(),i()},400)):oe(i,20)}),pe(()=>_.value,E=>{f.value=E?"grab":"auto"}),ot(()=>{l.value&&(l.value.addEventListener("wheel",P,{passive:!1}),b())}),Tt(()=>{l.value&&l.value.removeEventListener("wheel",P)}),window.onKeySpacePressHold=E=>{_.value=E},(E,B)=>{const $=H("sketch-rule");return T(),q("div",ss,[S.value?(T(),U($,{key:0,thick:je,scale:m.value,width:M().width,height:M().height,startX:v.value,startY:g.value,lines:y,palette:L.value},null,8,["scale","width","height","startX","startY","lines","palette"])):ce("",!0),z("div",{ref_key:"$app",ref:l,class:"edit-screens",onScroll:G},[z("div",{ref_key:"$container",ref:p,class:"edit-screen-container",style:ne({width:c(u)*2+"px"})},[z("div",{ref_key:"refSketchRuleBox",ref:C,class:"canvas",onMousedown:W,style:ne({marginLeft:"-"+(M().width/2-25)+"px"})},[z("div",{style:ne({pointerEvents:_.value?"none":"auto"})},[at(E.$slots,"default",{},void 0,!0)],4)],36)],4)],544),c(o).getDarkTheme?(T(),q("div",os)):ce("",!0)])}}});var rs=le(as,[["__scopeId","data-v-12b70182"]]);const Je={[I.ADD]:"\u65B0\u589E",[I.DELETE]:"\u5220\u9664",[I.UPDATE]:"\u66F4\u65B0",[I.MOVE]:"\u79FB\u52A8",[I.PASTE]:"\u7C98\u8D34",[I.COPY]:"\u590D\u5236",[I.CUT]:"\u526A\u5207",[I.TOP]:"\u7F6E\u9876",[I.BOTTOM]:"\u7F6E\u5E95",[I.UP]:"\u4E0A\u79FB",[I.DOWN]:"\u4E0B\u79FB",[I.GROUP]:"\u6210\u7EC4",[I.UN_GROUP]:"\u89E3\u7EC4",[I.LOCK]:"\u9501\u5B9A",[I.UNLOCK]:"\u89E3\u9501",[I.HIDE]:"\u9690\u85CF",[I.SHOW]:"\u663E\u793A",[Re.CANVAS]:"\u753B\u5E03\u521D\u59CB\u5316"};var us=Array.prototype,cs=us.reverse;function ls(e){return e==null?e:cs.call(e)}var is=ls;const It=e=>(kt("data-v-5a4fd660"),e=e(),Ft(),e),ds={class:"go-flex-items-center"},fs=It(()=>z("span",{class:"btn-text"},"\u5386\u53F2\u8BB0\u5F55",-1)),ps={class:"history-list-box"},vs=["title"],hs=It(()=>z("div",{class:"popover-modal"},null,-1)),gs=ue({__name:"index",setup(e){const{DesktopOutlineIcon:n,PencilIcon:t,TrashIcon:o,CopyIcon:s,LayersIcon:h,DuplicateIcon:l,HelpOutlineIcon:S,LockClosedOutlineIcon:C,LockOpenOutlineIcon:p,EyeOffOutlineIcon:_,EyeOutlineIcon:f}=De.ionicons5,{StackedMoveIcon:u,Carbon3DCursorIcon:a,Carbon3DSoftwareIcon:v}=De.carbon,g=zt(),y=L=>{if(L.targetType===Re.CANVAS)return n;switch(L.actionType){case I.UPDATE:return t;case I.DELETE:return o;case I.PASTE:return s;case I.TOP:return h;case I.BOTTOM:return h;case I.UP:return h;case I.DOWN:return h;case I.MOVE:return u;case I.ADD:return l;case I.GROUP:return a;case I.UN_GROUP:return v;case I.LOCK:return C;case I.UNLOCK:return p;case I.HIDE:return _;case I.SHOW:return f;default:return t}},m=L=>{if(L.targetType===Re.CANVAS)return Je[Re.CANVAS];if(L.actionType===I.GROUP||L.actionType===I.UN_GROUP)return`${Je[L.actionType]}`;if(L.historyData.length)return`${Je[L.actionType]} - ${L.historyData[0].chartConfig.title}`},R=N(()=>{const F=g.getBackStack.map(P=>({label:m(P),icon:y(P)}));return is(F.filter(P=>P.label))});return(L,F)=>{const P=H("n-button"),G=H("n-icon"),W=H("n-text"),M=H("n-scrollbar"),i=H("n-popover"),b=H("n-tooltip");return T(),q("div",ds,[O(i,{class:"edit-history-popover","show-arrow":!1,size:"small",trigger:"click",placement:"top-start"},{trigger:D(()=>[O(P,{class:"mr-10",secondary:"",size:"small",disabled:R.value.length===0},{default:D(()=>[fs]),_:1},8,["disabled"])]),default:D(()=>[z("div",ps,[O(M,{style:{"max-height":"500px"}},{default:D(()=>[(T(!0),q(ve,null,me(R.value,(E,B)=>(T(),q("div",{class:"list-item go-flex-items-center go-ellipsis-1",key:B,title:E.label},[O(G,{class:"item-icon",size:"16",depth:2,component:E.icon},null,8,["component"]),O(W,{depth:"2"},{default:D(()=>[Ee(fe(E.label),1)]),_:2},1024)],8,vs))),128))]),_:1}),hs])]),_:1}),O(b,{trigger:"hover"},{trigger:D(()=>[O(G,{size:"21",depth:3},{default:D(()=>[O(c(S))]),_:1})]),default:D(()=>[z("span",null,"\u6700\u591A\u53EA\u4FDD\u7559"+fe(c(tn))+"\u6761\u8BB0\u5F55",1)]),_:1})])}}});var _s=le(gs,[["__scopeId","data-v-5a4fd660"]]);const ms={class:"go-edit-bottom"},Cs=ue({__name:"index",setup(e){Ae(y=>({f3add9fc:s.value}));const{LockClosedOutlineIcon:n,LockOpenOutlineIcon:t}=De.ionicons5,o=ke(),s=Q(o.getAppTheme),h=re(),{lockScale:l,scale:S}=Ue(h.getEditCanvas);let C=[{label:"200%",value:200},{label:"150%",value:150},{label:"100%",value:100},{label:"50%",value:50},{label:"\u81EA\u9002\u5E94",value:0}];const p=Q(""),_=y=>{if(y===0){h.computedScale();return}h.setScale(y/100)},f=()=>{h.setEditCanvas(ae.LOCK_SCALE,!l.value)},u=Q(100),a=y=>`${y}%`,v=y=>{h.setScale(y/100)},g=$e({100:""});return nn(()=>{const y=(S.value*100).toFixed(0);p.value=`${y}%`,u.value=parseInt(y)}),(y,m)=>{const R=H("n-text"),L=H("n-space"),F=H("n-select"),P=H("n-icon"),G=H("n-button"),W=H("n-tooltip"),M=H("n-slider");return T(),q("div",ms,[O(L,null,{default:D(()=>[O(c(_s)),O(R,{id:"keyboard-dress-show",depth:"3"})]),_:1}),O(L,{class:"bottom-ri"},{default:D(()=>[O(An),O(F,{disabled:c(l),class:"scale-btn",value:p.value,"onUpdate:value":[m[0]||(m[0]=i=>p.value=i),_],size:"mini",options:c(C)},null,8,["disabled","value","options"]),O(W,{trigger:"hover"},{trigger:D(()=>[O(G,{onClick:f,text:""},{default:D(()=>[O(P,{class:de(["lock-icon",{color:c(l)}]),size:"18",depth:2},{default:D(()=>[c(l)?(T(),U(c(n),{key:0})):(T(),U(c(t),{key:1}))]),_:1},8,["class"])]),_:1})]),default:D(()=>[z("span",null,fe(c(l)?"\u89E3\u9501":"\u9501\u5B9A")+"\u5F53\u524D\u6BD4\u4F8B",1)]),_:1}),O(M,{class:"scale-slider",value:u.value,"onUpdate:value":[m[1]||(m[1]=i=>u.value=i),v],"default-value":50,min:10,max:200,step:5,"format-tooltip":a,disabled:c(l),marks:g},null,8,["value","disabled","marks"])]),_:1})])}}});var ys=le(Cs,[["__scopeId","data-v-99a534fc"]]);const Es=ue({__name:"index",props:{modelShow:Boolean},emits:["update:modelShow"],setup(e,{emit:n}){const t=e,o=n,{HelpOutlineIcon:s,CloseIcon:h}=De.ionicons5,l=rt(),S=Q(!1),C=$e([{key:ge.ASIDE_ALL_COLLAPSED,value:l.getAsideAllCollapsed,type:"switch",name:"\u83DC\u5355\u6298\u53E0",desc:"\u9996\u9875\u83DC\u5355\u6298\u53E0\u65F6\u9690\u85CF\u81F3\u754C\u9762\u5916"},{key:ge.HIDE_PACKAGE_ONE_CATEGORY,value:l.getHidePackageOneCategory,type:"switch",name:"\u9690\u85CF\u5206\u7C7B",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u8868\u5355\u5206\u7C7B\u53EA\u6709\u5355\u9879\u65F6\u9690\u85CF"},{key:ge.CHANGE_LANG_RELOAD,value:l.getChangeLangReload,type:"switch",name:"\u5207\u6362\u8BED\u8A00",desc:"\u5207\u6362\u8BED\u8A00\u91CD\u65B0\u52A0\u8F7D\u9875\u9762",tip:"\u82E5\u9047\u5230\u90E8\u5206\u533A\u57DF\u8BED\u8A00\u5207\u6362\u5931\u8D25\uFF0C\u5219\u5EFA\u8BAE\u5F00\u542F"},{key:"divider1",type:"divider",name:"",desc:"",value:""},{key:ge.CHART_TOOLS_STATUS_HIDE,value:l.getChartToolsStatusHide,type:"switch",name:"\u9690\u85CF\u5DE5\u5177\u680F",desc:"\u9F20\u6807\u79FB\u5165\u65F6\uFF0C\u4F1A\u5C55\u793A\u5207\u6362\u5230\u5C55\u5F00\u6A21\u5F0F"},{key:ge.CHART_TOOLS_STATUS,value:l.getChartToolsStatus,type:"select",name:"\u5DE5\u5177\u680F\u5C55\u793A",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u5DE5\u5177\u680F\u5C55\u793A\u65B9\u5F0F",options:[{label:"\u4FA7\u8FB9\u680F",value:Pe.ASIDE},{label:"\u5E95\u90E8 Dock",value:Pe.DOCK}]},{key:"divider0",type:"divider",name:"",desc:"",value:""},{key:ge.CHART_MOVE_DISTANCE,value:l.getChartMoveDistance,type:"number",name:"\u79FB\u52A8\u8DDD\u79BB",min:1,step:1,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u65B9\u5411\u952E\u63A7\u5236\u79FB\u52A8\u8DDD\u79BB"},{key:ge.CHART_ALIGN_RANGE,value:l.getChartAlignRange,type:"number",name:"\u5438\u9644\u8DDD\u79BB",min:10,step:2,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u79FB\u52A8\u56FE\u8868\u65F6\u7684\u5438\u9644\u8DDD\u79BB"}]);pe(()=>t.modelShow,f=>{S.value=f});const p=()=>{o("update:modelShow",!1)},_=(f,u)=>{l.setItem(u.key,u.value)};return(f,u)=>{const a=H("n-h3"),v=H("n-icon"),g=H("n-space"),y=H("n-divider"),m=H("n-text"),R=H("n-switch"),L=H("n-input-number"),F=H("n-select"),P=H("n-tooltip"),G=H("n-list-item"),W=H("n-list"),M=H("n-modal");return T(),U(M,{show:S.value,"onUpdate:show":u[0]||(u[0]=i=>S.value=i),onAfterLeave:p},{default:D(()=>[O(W,{bordered:"",class:"go-system-setting"},{header:D(()=>[O(g,{justify:"space-between"},{default:D(()=>[O(a,{class:"go-mb-0"},{default:D(()=>[Ee("\u7CFB\u7EDF\u8BBE\u7F6E")]),_:1}),O(v,{size:"20",class:"go-cursor-pointer",onClick:p},{default:D(()=>[O(c(h))]),_:1})]),_:1})]),default:D(()=>[(T(!0),q(ve,null,me(C,i=>(T(),U(G,{key:i.key},{default:D(()=>[i.type==="divider"?(T(),U(y,{key:0,style:{margin:"0"}})):(T(),U(g,{key:1,size:40},{default:D(()=>[O(g,null,{default:D(()=>[O(m,{class:"item-left"},{default:D(()=>[Ee(fe(i.name),1)]),_:2},1024),i.type==="switch"?(T(),U(R,{key:0,value:i.value,"onUpdate:value":[b=>i.value=b,b=>_(b,i)],size:"small"},null,8,["value","onUpdate:value"])):i.type==="number"?(T(),U(L,{key:1,value:i.value,"onUpdate:value":[b=>i.value=b,b=>_(b,i)],class:"input-num-width",size:"small",step:i.step||null,suffix:i.suffix||null,min:i.min||0},null,8,["value","onUpdate:value","step","suffix","min"])):i.type==="select"?(T(),U(F,{key:2,class:"select-min-width",value:i.value,"onUpdate:value":[b=>i.value=b,b=>_(b,i)],size:"small",options:i.options},null,8,["value","onUpdate:value","options"])):ce("",!0)]),_:2},1024),O(g,null,{default:D(()=>[O(m,{class:"item-right"},{default:D(()=>[Ee(fe(i.desc),1)]),_:2},1024),i.tip?(T(),U(P,{key:0,trigger:"hover"},{trigger:D(()=>[O(v,{size:"21"},{default:D(()=>[O(c(s))]),_:1})]),default:D(()=>[z("span",null,fe(i.tip),1)]),_:2},1024)):ce("",!0)]),_:2},1024)]),_:2},1024))]),_:2},1024))),128))]),_:1})]),_:1},8,["show"])}}});var Ss=le(Es,[["__scopeId","data-v-7cea0aa5"]]);const xe=re(),ws=()=>{xe.setTargetSelectChart(void 0),sn(on(xe.getStorageInfo||[]),void 0,"json");const e=document.querySelector(".go-edit-range"),n=document.getElementById("go-edit-watermark");if(!e||!n){window.$message.error("\u5BFC\u51FA\u5931\u8D25\uFF01");return}const t=xe.getEditCanvas.scale;xe.setScale(1,!0),n.style.display="block",setTimeout(()=>{an(e,()=>{n&&(n.style.display="none"),xe.setScale(t,!0)})},600)};var st=(e=>(e.TXT="text/plain",e.JSON="application/json",e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e))(st||{});const Ts=()=>{const e=Q(),{updateComponent:n}=wt();return{importUploadFileListRef:e,importBeforeUpload:({file:s})=>{e.value=[];const h=s.file.type;return h!==st.JSON&&h!==st.TXT?(window.$message.warning("\u4EC5\u652F\u6301\u4E0A\u4F20 \u3010JSON\u3011 \u683C\u5F0F\u6587\u4EF6\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20\uFF01"),!1):!0},importCustomRequest:s=>{const{file:h}=s;rn(()=>{h.file?un(h.file).then(l=>{mn({message:"\u8BF7\u9009\u62E9\u5BFC\u5165\u65B9\u5F0F:",positiveText:"\u65B0\u589E\uFF08\u53EF\u64A4\u56DE\uFF09",negativeText:"\u8986\u76D6\uFF08\u4E0D\u53EF\u64A4\u56DE\uFF09",negativeButtonProps:{type:"info",ghost:!1},onPositiveCallback:()=>we(void 0,null,function*(){try{l=Ve(l),yield n(l,!1,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(S){console.log(S),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}}),onNegativeCallback:()=>we(void 0,null,function*(){try{l=Ve(l),yield n(l,!0,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(S){console.log(S),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}})})}):window.$message.error("\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u6216\u8054\u7CFB\u7BA1\u7406\u5458\uFF01")})}}},{updateComponent:xs,dataSyncUpdate:Et}=wt(),Ds=re(),As=()=>{const e=h=>xs(h.detail,!0,!1),n=()=>we(void 0,null,function*(){Et&&(yield Et()),dispatchEvent(new CustomEvent(Ge.CHART,{detail:Ds.getStorageInfo}))}),t=()=>{addEventListener("blur",n),addEventListener(Ge.JSON,e)},o=()=>{removeEventListener(Ge.JSON,e),removeEventListener("blur",n)};return(h,l)=>{l==vt.CHART_HOME_NAME&&o(),h==vt.CHART_HOME_NAME&&t()}},ks=()=>{const e=bt();pe(()=>e.name,As(),{immediate:!0})};var _e=(e=>(e.BUTTON="button",e.IMPORTUPLOAD="importUpload",e))(_e||{});const Fs={class:"btn-item"},bs=ue({__name:"index",setup(e){const{DownloadIcon:n,ShareIcon:t,PawIcon:o,SettingsSharpIcon:s,CreateIcon:h}=De.ionicons5,l=rt(),S=re();bt(),ks();let C=null;const p=Q(!1),_=Q(!0),f=Q(!0),{importUploadFileListRef:u,importCustomRequest:a,importBeforeUpload:v}=Ts(),g=N(()=>l.getChartToolsStatus===Pe.ASIDE),y=N(()=>l.getChartToolsStatusHide),m=N(()=>_.value&&y.value),R=N(()=>{if(!g.value)return W;const M=[];return W.map(i=>{M.unshift(i)}),M}),L=()=>{C=setTimeout(()=>{_.value&&(_.value=!1,f.value=!0)},200),setTimeout(()=>{f.value=!1},400)},F=()=>{clearTimeout(C),_.value||(_.value=!0)},P=()=>{window.$message.warning("\u5C06\u5F00\u542F\u5931\u7126\u66F4\u65B0\uFF01"),setTimeout(()=>{const M=ln(dn.CHART_EDIT_NAME,"href");if(!M)return;const i=fn();G(i),pn(M,[i],void 0,!0)},1e3)},G=M=>{const i=S.getStorageInfo,b=vn(Oe.GO_CHART_STORAGE_LIST)||[];if(b!=null&&b.length){const E=b.findIndex(B=>B.id===M);E!==-1?(b.splice(E,1,Ce(Y({},i),{id:M})),ze(Oe.GO_CHART_STORAGE_LIST,b)):(b.push(Ce(Y({},i),{id:M})),ze(Oe.GO_CHART_STORAGE_LIST,b))}else ze(Oe.GO_CHART_STORAGE_LIST,[Ce(Y({},i),{id:M})])},W=[{key:"import",type:_e.IMPORTUPLOAD,name:"\u5BFC\u5165",icon:t},{key:"export",type:_e.BUTTON,name:"\u5BFC\u51FA",icon:n,handle:ws},{key:"edit",type:_e.BUTTON,name:"\u7F16\u8F91",icon:h,handle:P},{key:"setting",type:_e.BUTTON,name:"\u8BBE\u7F6E",icon:s,handle:()=>{p.value=!0}}];return(M,i)=>{const b=H("n-icon"),E=H("n-text"),B=H("n-button"),$=H("n-upload"),r=H("n-tooltip");return T(),q(ve,null,[z("div",{class:de(["go-chart-edit-tools",[c(l).getChartToolsStatus,m.value?"isMini":"unMini"]]),onClick:i[1]||(i[1]=d=>_.value&&(_.value=!1)),onMouseenter:L,onMouseleave:F},[Xe(O(b,{class:"asideLogo",size:"22"},{default:D(()=>[O(c(o))]),_:1},512),[[We,c(l).getChartToolsStatus===c(Pe).ASIDE&&m.value]]),(T(!0),q(ve,null,me(R.value,(d,A)=>(T(),U(r,{key:d.key,disabled:!g.value||y.value&&f.value,trigger:"hover",placement:"left"},{trigger:D(()=>[z("div",Fs,[d.type===c(_e).BUTTON?(T(),U(B,{key:0,circle:g.value,secondary:"",onClick:d.handle},{icon:D(()=>[g.value?(T(),U(b,{key:0,size:"22"},{default:D(()=>[(T(),U(ye(d.icon)))]),_:2},1024)):(T(),U(ye(d.icon),{key:1}))]),default:D(()=>[Xe(O(E,{depth:"3"},{default:D(()=>[Ee(fe(d.name),1)]),_:2},1536),[[We,!g.value]])]),_:2},1032,["circle","onClick"])):d.type===c(_e).IMPORTUPLOAD?(T(),U($,{key:1,"file-list":c(u),"onUpdate:fileList":i[0]||(i[0]=k=>cn(u)?u.value=k:null),"show-file-list":!1,customRequest:c(a),onBeforeUpload:c(v)},{default:D(()=>[O(B,{circle:g.value,secondary:""},{icon:D(()=>[g.value?(T(),U(b,{key:0,size:"22"},{default:D(()=>[(T(),U(ye(d.icon)))]),_:2},1024)):(T(),U(ye(d.icon),{key:1}))]),default:D(()=>[Xe(O(E,{depth:"3"},{default:D(()=>[Ee(fe(d.name),1)]),_:2},1536),[[We,!g.value]])]),_:2},1032,["circle"])]),_:2},1032,["file-list","customRequest","onBeforeUpload"])):ce("",!0)])]),default:D(()=>[z("span",null,fe(d.name),1)]),_:2},1032,["disabled"]))),128))],34),O(c(Ss),{modelShow:p.value,"onUpdate:modelShow":i[2]||(i[2]=d=>p.value=d)},null,8,["modelShow"])],64)}}});var Os=le(bs,[["__scopeId","data-v-4c257f27"]]);const Ls=ue({__name:"index",setup(e){const n=re(),{handleContextMenu:t}=ut();kn();const{mouseenterHandle:o,mouseleaveHandle:s,mousedownHandle:h,mouseClickHandle:l}=Mt(),S=(f,u,a)=>{if(n.getTargetChart.selectId.length>1)return u.filter(g=>[x.GROUP,x.DELETE].includes(g.key));const v=[];return a.status.lock?v.push(x.LOCK):v.push(x.UNLOCK),a.status.hide?v.push(x.HIDE):v.push(x.SHOW),f.filter(g=>!v.includes(g.key))},C=N(()=>n.getEditCanvasConfig.chartThemeSetting),p=N(()=>{const f=n.getEditCanvasConfig.chartThemeColor;return St[f]});N(()=>n.getEditCanvasConfig.filterShow);const _=N(()=>{const f=n.getEditCanvasConfig.background,u=n.getEditCanvasConfig.backgroundImage,g=n.getEditCanvasConfig.selectColor?{background:f||void 0}:{background:`url(${u}) no-repeat center center / cover !important`};return Ce(Y({},g),{width:"inherit",height:"inherit"})});return ot(()=>{Ln()}),(f,u)=>(T(),U(c(Dn),{id:"go-chart-edit-layout",flex:!0,showTop:!1,showBottom:!0,depth:1,xScroll:!0,disabledScroll:!0,onMousedown:c(Lt),onDrop:c(Rn),onDragover:c(gt),onDragenter:c(gt)},{aside:D(()=>[O(c(Os))]),bottom:D(()=>[O(c(ys))]),default:D(()=>[O(c(rs),null,{default:D(()=>[z("div",{id:"go-chart-edit-content",onContextmenu:u[0]||(u[0]=(...a)=>c(t)&&c(t)(...a))},[O(c(Qn),null,{default:D(()=>[z("div",{style:ne(Y(Y({},c(He)(c(n).getEditCanvasConfig)),_.value))},[(T(!0),q(ve,null,me(c(n).getComponentList,(a,v)=>(T(),q("div",{key:a.id},[a.isGroup?(T(),U(c(Un),{key:0,groupData:a,groupIndex:v},null,8,["groupData","groupIndex"])):(T(),U(c(et),{key:1,"data-id":a.id,index:v,style:ne(Y(Y({},c(Ie)(a.attr,v)),c(At)(a.styles))),item:a,onClick:g=>c(l)(g,a),onMousedown:g=>c(h)(g,a),onMouseenter:g=>c(o)(g,a),onMouseleave:g=>c(s)(g,a),onContextmenu:g=>c(t)(g,a,S)},{default:D(()=>{var g,y,m,R;return[c(Cn)(a)&&!((g=a.option)!=null&&g.isDeleted)?(T(),U(c(qt),{key:0,title:c(yn)(a),attr:a.attr,titleSize:c(En)(a),titleStyle:c(Sn)(a)},null,8,["title","attr","titleSize","titleStyle"])):ce("",!0),c(wn)(a)&&!((y=a.option)!=null&&y.isDeleted)?(T(),U(c(jt),{key:1,class:"filter-content",componentIdx:a.id,attr:a.attr,filters:a.chartConfig.filters,type:a.chartConfig.category},null,8,["componentIdx","attr","filters","type"])):ce("",!0),(m=a.option)!=null&&m.isDeleted?(T(),U(c(Jt),{key:2,item:a,style:ne(Ce(Y({},c(it)(a.attr,0)),{lineHeight:a.attr.h+"px"}))},null,8,["item","style"])):ce("",!0),(R=a.option)!=null&&R.isDeleted?ce("",!0):(T(),U(ye(a.chartConfig.chartKey),{key:3,class:de(["edit-content-chart",c(Qe)(a.styles.animations)]),chartConfig:a,themeSetting:C.value,themeColor:p.value,style:ne(Y(Y(Y({},c(it)(a.attr,c(Tn)(a)+c(xn)(a))),c(He)(a.styles)),c(Ze)(a.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]}),_:2},1032,["data-id","index","style","item","onClick","onMousedown","onMouseenter","onMouseleave","onContextmenu"]))]))),128))],4)]),_:1})],32)]),_:1})]),_:1},8,["onMousedown","onDrop","onDragover","onDragenter"]))}});var Xs=le(Ls,[["__scopeId","data-v-f20efb74"]]);export{Xs as default};
