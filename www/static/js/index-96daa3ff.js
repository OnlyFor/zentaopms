var It=Object.defineProperty,Ht=Object.defineProperties;var Pt=Object.getOwnPropertyDescriptors;var ct=Object.getOwnPropertySymbols;var $t=Object.prototype.hasOwnProperty,Ut=Object.prototype.propertyIsEnumerable;var lt=(e,n,t)=>n in e?It(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,K=(e,n)=>{for(var t in n||(n={}))$t.call(n,t)&&lt(e,t,n[t]);if(ct)for(var t of ct(n))Ut.call(n,t)&&lt(e,t,n[t]);return e},Se=(e,n)=>Ht(e,Pt(n));var we=(e,n,t)=>new Promise((a,o)=>{var d=g=>{try{C(t.next(g))}catch(p){o(p)}},h=g=>{try{C(t.throw(g))}catch(p){o(p)}},C=g=>g.done?a(g.value):Promise.resolve(g.value).then(d,h);C((t=t.apply(e,n)).next())});import{u as re,E as ae,t as se,B as Ge,D as Nt,A as Kt,G as Re,J as Gt,K as ye,c as Et,M as Ie,f as Yt,C as Xt,Q as R,R as Be,a as Wt,b as St,O as zt,F as jt,S as qt}from"./useSync.hook-fa34be69.js";import{x as ot,a6 as wt,aJ as Jt,ah as x,c5 as Tt,c6 as xt,cl as it,ck as Vt,c3 as Ve,cm as j,ca as Ye,ai as Qt,j as ce,d as ue,bJ as Ae,f as s,u as ke,a5 as P,o as w,m as z,n as at,F as he,A as _e,ad as ie,aQ as oe,aa as fe,z as W,c as $,w as D,L as me,bU as Qe,bV as He,bW as Ze,bX as Dt,a4 as rt,y as $e,aj as dt,R as pe,r as I,cn as Zt,a3 as Ue,v as Q,co as ft,G as At,H as kt,e as O,p as Ce,t as de,aI as en,aT as tn,cp as ve,cq as Pe,cr as nn,c2 as sn,cs as on,ak as an,ct as rn,J as Ft,Q as pt,b$ as Xe,X as We,Y as ze,bS as un,V as cn,cu as ln,cv as dn,W as fn,aP as pn,S as Oe,c0 as je}from"./index.js";import{u as ut,d as hn}from"./index-84844680.js";import{a as vn,b as ht,l as gn,g as _n}from"./plugin-00b0ac17.js";import{i as mn,g as Cn,a as yn,h as En,o as Sn,f as wn}from"./useItem.hook-9d6dbf6c.js";import{C as Tn}from"./index-cf628c60.js";import{i as De}from"./icon-0db99487.js";import{E as xn}from"./index-8040e122.js";import"./tables_list-38e71280.js";import"./index-0b9f0a02.js";import"./index-8d5dc053.js";const Te=re(),Dn=()=>{ot(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,document.getElementById("go-chart-edit-layout")),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,document.getElementById("go-chart-edit-content"));const e=Te.listenerScale();wt(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,null),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,null),e()})})};var bt={exports:{}};(function(e){(function(n){var t,a={},o={16:!1,18:!1,17:!1,91:!1},d="all",h={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},C={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},g=function(r){return C[r]||r.toUpperCase().charCodeAt(0)},p=[];for(t=1;t<20;t++)C["f"+t]=111+t;function _(r,i){for(var k=r.length;k--;)if(r[k]===i)return k;return-1}function l(r,i){if(r.length!=i.length)return!1;for(var k=0;k<r.length;k++)if(r[k]!==i[k])return!1;return!0}var u={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function c(r){for(t in o)o[t]=r[u[t]]}function f(r){var i,k,F,Y,U,le;if(i=r.keyCode,_(p,i)==-1&&p.push(i),(i==93||i==224)&&(i=91),i in o){o[i]=!0;for(F in h)h[F]==i&&(A[F]=!0);return}if(c(r),!!A.filter.call(this,r)&&i in a){for(le=q(),Y=0;Y<a[i].length;Y++)if(k=a[i][Y],k.scope==le||k.scope=="all"){U=k.mods.length>0;for(F in o)(!o[F]&&_(k.mods,+F)>-1||o[F]&&_(k.mods,+F)==-1)&&(U=!1);(k.mods.length==0&&!o[16]&&!o[18]&&!o[17]&&!o[91]||U)&&k.method(r,k)===!1&&(r.preventDefault?r.preventDefault():r.returnValue=!1,r.stopPropagation&&r.stopPropagation(),r.cancelBubble&&(r.cancelBubble=!0))}}}function m(r){var i=r.keyCode,k,F=_(p,i);if(F>=0&&p.splice(F,1),(i==93||i==224)&&(i=91),i in o){o[i]=!1;for(k in h)h[k]==i&&(A[k]=!1)}}function y(){for(t in o)o[t]=!1;for(t in h)A[t]=!1}function A(r,i,k){var F,Y;F=v(r),k===void 0&&(k=i,i="all");for(var U=0;U<F.length;U++)Y=[],r=F[U].split("+"),r.length>1&&(Y=H(r),r=[r[r.length-1]]),r=r[0],r=g(r),r in a||(a[r]=[]),a[r].push({shortcut:F[U],scope:i,method:k,key:F[U],mods:Y})}function B(r,i){var k,F,Y=[],U,le,Ee;for(k=v(r),le=0;le<k.length;le++){if(F=k[le].split("+"),F.length>1&&(Y=H(F),r=F[F.length-1]),r=g(r),i===void 0&&(i=q()),!a[r])return;for(U=0;U<a[r].length;U++)Ee=a[r][U],Ee.scope===i&&l(Ee.mods,Y)&&(a[r][U]={})}}function M(r){return typeof r=="string"&&(r=g(r)),_(p,r)!=-1}function b(){return p.slice(0)}function G(r){var i=(r.target||r.srcElement).tagName;return!(i=="INPUT"||i=="SELECT"||i=="TEXTAREA")}for(t in h)A[t]=!1;function X(r){d=r||"all"}function q(){return d||"all"}function T(r){var i,k,F;for(i in a)for(k=a[i],F=0;F<k.length;)k[F].scope===r?k.splice(F,1):F++}function v(r){var i;return r=r.replace(/\s/g,""),i=r.split(","),i[i.length-1]==""&&(i[i.length-2]+=","),i}function H(r){for(var i=r.slice(0,r.length-1),k=0;k<i.length;k++)i[k]=h[i[k]];return i}function N(r,i,k){r.addEventListener?r.addEventListener(i,k,!1):r.attachEvent&&r.attachEvent("on"+i,function(){k(window.event)})}N(document,"keydown",function(r){f(r)}),N(document,"keyup",m),N(window,"focus",y);var S=n.key;function L(){var r=n.key;return n.key=S,r}n.key=A,n.key.setScope=X,n.key.getScope=q,n.key.deleteScope=T,n.key.filter=G,n.key.isPressed=M,n.key.getPressedKeyCodes=b,n.key.noConflict=L,n.key.unbind=B,e.exports=A})(Jt)})(bt);var Z=bt.exports;const ee=re(),ne=e=>`${Tt.CTRL}+${e}`,Le=e=>`${Tt.SHIFT}+${e}`,J={[x.ARROW_UP]:ne("up"),[x.ARROW_RIGHT]:ne("right"),[x.ARROW_DOWN]:ne("down"),[x.ARROW_LEFT]:ne("left"),[x.COPY]:ne("c"),[x.CUT]:ne("x"),[x.PARSE]:ne("v"),[x.DELETE]:"delete",[x.BACK]:ne("z"),[x.FORWORD]:ne(Le("z")),[x.GROUP]:ne("g"),[x.UN_GROUP]:ne(Le("g")),[x.LOCK]:ne("l"),[x.UNLOCK]:ne(Le("l")),[x.HIDE]:ne("h"),[x.SHOW]:ne(Le("h"))},te=e=>`${xt.CTRL}+${e}`,Me=e=>`${xt.SHIFT}+${e}`,V={[x.ARROW_UP]:te("arrowup"),[x.ARROW_RIGHT]:te("arrowright"),[x.ARROW_DOWN]:te("arrowdown"),[x.ARROW_LEFT]:te("arrowleft"),[x.COPY]:te("c"),[x.CUT]:te("x"),[x.PARSE]:te("v"),[x.DELETE]:te("backspace"),[x.BACK]:te("z"),[x.FORWORD]:te(Me("z")),[x.GROUP]:te("g"),[x.UN_GROUP]:te(Me("g")),[x.LOCK]:te("l"),[x.UNLOCK]:te(Me("l")),[x.HIDE]:te("h"),[x.SHOW]:te(Me("h"))},An=[J.up,J.right,J.down,J.left,J.delete,J.copy,J.cut,J.parse,J.back,J.forward,J.group,J.unGroup,J.lock,J.unLock,J.hide,J.show],kn=[V.up,V.right,V.down,V.left,V.delete,V.copy,V.cut,V.parse,V.back,V.forward,V.group,V.unGroup,V.lock,V.unLock,V.hide,V.show],Fn=()=>{window.$KeyboardActive={ctrl:!1,space:!1},document.onkeydown=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(it(e.keyCode),n){case 17:window.$KeyboardActive.ctrl=!0;break;case 32:window.$KeyboardActive.space=!0;break}},document.onkeyup=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(it(),n){case 17:window.$KeyboardActive.ctrl=!1;break;case 32:window.$KeyboardActive.space=!1;break}}},bn=()=>{const n=(t,a)=>{switch(a){case t.up:Z(a,se(()=>(ee.setMove(x.ARROW_UP),!1),50));break;case t.right:Z(a,se(()=>(ee.setMove(x.ARROW_RIGHT),!1),50));break;case t.down:Z(a,se(()=>(ee.setMove(x.ARROW_DOWN),!1),50));break;case t.left:Z(a,se(()=>(ee.setMove(x.ARROW_LEFT),!1),50));break;case t.delete:Z(a,Ge(()=>(ee.removeComponentList(),!1),50));break;case t.copy:Z(a,Ge(()=>(ee.setCopy(),!1),50));break;case t.cut:Z(a,Ge(()=>(ee.setCut(),!1),50));break;case t.parse:Z(a,se(()=>(ee.setParse(),!1),50));break;case t.back:Z(a,se(()=>(ee.setBack(),!1),50));break;case t.forward:Z(a,se(()=>(ee.setForward(),!1),50));break;case t.group:Z(a,se(()=>(ee.setGroup(),!1),50));break;case t.unGroup:Z(a,se(()=>(ee.setUnGroup(),!1),50));break;case t.lock:Z(a,se(()=>(ee.setLock(),!1),50));break;case t.unLock:Z(a,se(()=>(ee.setUnLock(),!1),50));break;case t.hide:Z(a,se(()=>(ee.setHide(),!1),50));break;case t.show:Z(a,se(()=>(ee.setShow(),!1),50));break}};An.forEach(t=>{n(J,t)}),kn.forEach(t=>{n(V,t)}),Fn()},E=re(),{onClickOutSide:On}=ut(),Ln=e=>we(void 0,null,function*(){e.preventDefault();try{vn();const n=e.dataTransfer.getData(Vt.DRAG_KEY);if(!n){ht();return}E.setEditCanvas(ae.IS_CREATE,!1);const t=Ve(n);let a;if(t.sourceID){let d=yield Nt(t.sourceID,t.category);if(!d){window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...");return}a=d.chartConfig}else a=t;let o=yield Kt(a);j(o,e.offsetX-o.attr.w/2,e.offsetY-o.attr.h/2),E.addComponentList(o,!1,!0),E.setTargetSelectChart(o.id),ht()}catch(n){gn(),window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...")}}),vt=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")},Ot=(e,n)=>{if(n){E.setTargetSelectChart(n.id);return}E.setTargetSelectChart(void 0)},Mn=(e,n)=>{var p;if(e.which==2||(p=window.$KeyboardActive)!=null&&p.space)return;Ot();const t=e.offsetX,a=e.offsetY,o=e.screenX,d=e.screenY,h=E.getEditCanvas.scale;E.setMousePosition(void 0,void 0,t,a);const C=Re.exports.throttle(_=>{E.setTargetSelectChart(),E.setEditCanvas(ae.IS_SELECT,!0);const l=t+_.screenX-o,u=a+_.screenY-d;E.setMousePosition(l,u);const c={x1:0,y1:0,x2:0,y2:0};l>t&&u>a?(c.x1=t,c.y1=a,c.x2=Math.round(t+(_.screenX-o)/h),c.y2=Math.round(a+(_.screenY-d)/h)):l>t&&u<a?(c.x1=t,c.y1=Math.round(a-(d-_.screenY)/h),c.x2=Math.round(t+(_.screenX-o)/h),c.y2=a):l<t&&u>a?(c.x1=Math.round(t-(o-_.screenX)/h),c.y1=a,c.x2=t,c.y2=Math.round(a+(_.screenY-d)/h)):(c.x1=Math.round(t-(o-_.screenX)/h),c.y1=Math.round(a-(d-_.screenY)/h),c.x2=t,c.y2=a),E.getComponentList.forEach(f=>{if(!E.getTargetChart.selectId.includes(f.id)){const{x:m,y,w:A,h:B}=f.attr,M={x1:m,y1:y,x2:m+A,y2:y+B};M.x1-c.x1>=0&&M.y1-c.y1>=0&&M.x2-c.x2<=0&&M.y2-c.y2<=0&&!f.status.lock&&!f.status.hide&&E.setTargetSelectChart(f.id,!0)}})},30),g=()=>{C.cancel(),E.setEditCanvas(ae.IS_SELECT,!1),E.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",g)};document.addEventListener("mousemove",C),document.addEventListener("mouseup",g)},Lt=()=>({mouseClickHandle:(o,d)=>{var h;if(o.preventDefault(),o.stopPropagation(),!d.status.lock&&(h=window.$KeyboardActive)!=null&&h.ctrl)if(E.targetChart.selectId.includes(d.id)){const C=E.targetChart.selectId.filter(g=>g!==d.id);E.setTargetSelectChart(C)}else E.setTargetSelectChart(d.id,!0)},mousedownHandle:(o,d)=>{var y;if(o.preventDefault(),o.stopPropagation(),d.status.lock||(On(),o.buttons===Ye.LEFT&&((y=window.$KeyboardActive)==null?void 0:y.ctrl)))return;const h=E.getTargetChart.selectId;if(o.buttons===Ye.RIGHT&&h.length>1&&h.includes(d.id)||(E.setTargetSelectChart(d.id),o.buttons===Ye.RIGHT))return;const C=E.getEditCanvas.scale,g=E.getEditCanvasConfig.width,p=E.getEditCanvasConfig.height,_=new Map;E.getTargetChart.selectId.forEach(A=>{const B=E.fetchTargetIndex(A);if(B!==-1){const{x:M,y:b,w:G,h:X}=Qt(E.getComponentList[B]).attr;_.set(A,{x:M,y:b,w:G,h:X})}});const l=o.screenX,u=o.screenY;let c=[];E.getTargetChart.selectId.forEach(A=>{if(!_.has(A))return;const B=E.fetchTargetIndex(A);c.push(Re.exports.cloneDeep(E.getComponentList[B]))}),E.setMousePosition(void 0,void 0,l,u);const f=Re.exports.throttle(A=>{E.setEditCanvas(ae.IS_DRAG,!0),E.setMousePosition(A.screenX,A.screenY);let B=(A.screenX-l)/C,M=(A.screenY-u)/C;E.getTargetChart.selectId.forEach(b=>{if(!_.has(b))return;const G=E.fetchTargetIndex(b),{x:X,y:q,w:T,h:v}=_.get(b),H=E.getComponentList[G];let N=Math.round(X+B),S=Math.round(q+M);const L=50;N=N<-T+L?-T+L:N,S=S<-v+L?-v+L:S,N=N>g-L?g-L:N,S=S>p-L?p-L:S,H&&!Number.isNaN(N)&&!Number.isNaN(S)&&(H.attr=Object.assign(H.attr,{x:N,y:S}))})},20),m=()=>{try{E.setMousePosition(0,0,0,0),E.setEditCanvas(ae.IS_DRAG,!1),c.length&&(E.getTargetChart.selectId.forEach(A=>{if(!_.has(A))return;const B=E.fetchTargetIndex(A),M=E.getComponentList[B];c.forEach(b=>{b.id===A&&(b.attr=Object.assign(b.attr,{offsetX:M.attr.x-b.attr.x,offsetY:M.attr.y-b.attr.y}))})}),E.moveComponentList(c)),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",m)}catch(A){console.log(A)}};document.addEventListener("mousemove",f),document.addEventListener("mouseup",m)},mouseenterHandle:(o,d)=>{o.preventDefault(),o.stopPropagation(),E.getEditCanvas.isSelect||E.setTargetHoverChart(d.id)},mouseleaveHandle:(o,d)=>{o.preventDefault(),o.stopPropagation(),E.setEditCanvas(ae.IS_DRAG,!1),E.setTargetHoverChart(void 0)}}),Bn=(e,n,t)=>{e.stopPropagation(),e.preventDefault(),E.setEditCanvas(ae.IS_DRAG,!0);const a=E.getEditCanvas.scale,o=t.x,d=t.y,h=t.w,C=t.h,g=e.screenX,p=e.screenY;E.setMousePosition(g,p);const _=Re.exports.throttle(u=>{E.setMousePosition(u.screenX,u.screenY);let c=Math.round((u.screenX-g)/a),f=Math.round((u.screenY-p)/a);const m=/t/.test(n),y=/b/.test(n),A=/l/.test(n),B=/r/.test(n),M=C+(m?-f:y?f:0),b=h+(A?-c:B?c:0);t.h=M>0?M:0,t.w=b>0?b:0,t.x=o+(A?c:0),t.y=d+(m?f:0)},50),l=()=>{E.setEditCanvas(ae.IS_DRAG,!1),E.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",l)};document.addEventListener("mousemove",_),document.addEventListener("mouseup",l)};const Rn=["onMousedown"],In=ue({__name:"index",props:{item:{type:Object,required:!0},hiddenPoint:{type:Boolean,required:!1}},setup(e){const n=e;Ae(l=>({"026d39a0":s(h)}));const t=ke(),a=re(),o=["t","r","b","l","lt","rt","lb","rb"],d=["n","e","s","w","nw","ne","sw","se"],h=P(()=>t.getAppTheme),C=P(()=>n.item.status.lock?!1:n.item.id===a.getTargetChart.hoverId),g=P(()=>{const l=n.item.id;return n.item.status.lock?!1:a.getTargetChart.selectId.find(u=>u===l)}),p=P(()=>n.item.status.lock),_=P(()=>n.item.status.hide);return(l,u)=>(w(),z("div",{class:ie(["go-shape-box",{lock:s(p),hide:s(_)}])},[at(l.$slots,"default",{},void 0,!0),e.hiddenPoint?fe("",!0):(w(!0),z(he,{key:0},_e(s(g)?o:[],(c,f)=>(w(),z("div",{class:ie(`shape-point ${c}`),key:f,style:oe(s(Gt)(c,f,e.item.attr,d)),onMousedown:m=>s(Bn)(m,c,e.item.attr)},null,46,Rn))),128)),W("div",{class:"shape-modal",style:oe(s(ye)(e.item.attr))},[W("div",{class:ie(["shape-modal-select",{active:s(g)}])},null,2),W("div",{class:ie(["shape-modal-change",{selectActive:s(g),hoverActive:s(C)}])},null,2)],4)],2))}});var et=ce(In,[["__scopeId","data-v-5f8854aa"]]);const Hn={class:"go-edit-group-box"},Pn=ue({__name:"index",props:{groupData:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){const n=re(),{handleContextMenu:t}=ut(),{mouseenterHandle:a,mouseleaveHandle:o,mousedownHandle:d,mouseClickHandle:h}=Lt(),C=(_,l,u)=>{const c=f=>l.filter(m=>f.includes(m.key));if(n.getTargetChart.selectId.length>1)return c([x.GROUP,x.DELETE]);{const f=[];u.status.lock?f.push(x.LOCK):f.push(x.UNLOCK),u.status.hide?f.push(x.HIDE):f.push(x.SHOW);const m=[x.UN_GROUP];return[...c(m),hn(),..._.filter(y=>!f.includes(y.key))]}},g=P(()=>{const _=n.getEditCanvasConfig.chartThemeColor;return Et[_]}),p=P(()=>n.getEditCanvasConfig.chartThemeSetting);return(_,l)=>(w(),z("div",Hn,[(w(),$(s(et),{key:e.groupData.id,"data-id":e.groupData.id,index:e.groupIndex,item:e.groupData,hiddenPoint:!0,class:ie(s(Qe)(e.groupData.styles.animations)),style:oe(K(K(K(K(K({},s(Ie)(e.groupData.attr,e.groupIndex)),s(ye)(e.groupData.attr)),s(He)(e.groupData.styles)),s(Ze)(e.groupData.styles)),s(Dt)(e.groupData.styles))),onClick:l[0]||(l[0]=u=>s(h)(u,e.groupData)),onMousedown:l[1]||(l[1]=u=>s(d)(u,e.groupData)),onMouseenter:l[2]||(l[2]=u=>s(a)(u,e.groupData)),onMouseleave:l[3]||(l[3]=u=>s(o)(u,e.groupData)),onContextmenu:l[4]||(l[4]=u=>s(t)(u,e.groupData,C))},{default:D(()=>[(w(!0),z(he,null,_e(e.groupData.groupList,u=>(w(),$(s(et),{key:u.id,"data-id":u.id,index:e.groupIndex,item:u,hiddenPoint:!0,style:oe(K({},s(Ie)(u.attr,e.groupIndex)))},{default:D(()=>[(w(),$(me(u.chartConfig.chartKey),{class:ie(["edit-content-chart",s(Qe)(u.styles.animations)]),chartConfig:u,themeSetting:s(p),themeColor:s(g),style:oe(K(K(K({},s(ye)(u.attr)),s(He)(u.styles)),s(Ze)(u.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","item","style"]))),128))]),_:1},8,["data-id","index","item","class","style"]))]))}});const $n={class:"go-edit-align-line"},Un=ue({__name:"index",setup(e){Ae(f=>({42514545:s(h)}));const n=ke(),t=re(),a=rt(),o=$e({lineArr:["rowt","rowc","rowb","coll","colc","colr"],select:new Map,sorptioned:{x:!1,y:!1}}),d=f=>f?{left:`${f.x?f.x:0}px`,top:`${f.y?f.y:0}px`}:{},h=P(()=>n.getAppTheme),C=P(()=>a.getChartAlignRange),g=P(()=>t.getEditCanvas[ae.IS_DRAG]),p=(f,m)=>Math.abs(f-m)<=C.value,_=P(()=>t.getTargetChart.selectId),l=P(()=>t.getComponentList[t.fetchTargetIndex()]),u=P(()=>{var f;return((f=l.value)==null?void 0:f.attr)||{}}),c=P(()=>({id:"0",attr:{w:dt(t.getEditCanvasConfig.width),h:dt(t.getEditCanvasConfig.height),x:0,y:0,offsetX:0,offsetY:0,zIndex:0}}));return pe(()=>t.getMousePosition,se(()=>{try{if(!g.value||_.value.length!==1)return;const f=u.value.w,m=u.value.h,y=u.value.x,A=y+f/2,B=y+f,M=[y,A,B],b=u.value.y,G=b+m/2,X=b+m,q=[b,G,X];o.select.clear(),o.sorptioned.y=!1;const T=t.getComponentList.map(v=>({id:v.id,attr:v.attr}));T.push(c.value),o.lineArr.forEach(v=>{T.forEach(H=>{if(_.value[0]===H.id)return;const N=H.attr.w,S=H.attr.h,L=H.attr.x,r=L+N/2,i=L+N,k=[L,r,i],F=H.attr.y,Y=F+S/2,U=F+S,le=[F,Y,U];v.includes("rowt")&&(p(b,F)&&(o.select.set(v,{y:F}),j(l.value,y,F)),p(b,Y)&&(o.select.set(v,{y:Y}),j(l.value,y,Y)),p(b,U)&&(o.select.set(v,{y:U}),j(l.value,y,U))),v.includes("rowc")&&(p(G,F)&&(o.select.set(v,{y:F}),j(l.value,y,F-m/2)),p(G,Y)&&(o.select.set(v,{y:Y}),j(l.value,y,Y-m/2)),p(G,U)&&(o.select.set(v,{y:U}),j(l.value,y,U-m/2))),v.includes("rowb")&&(p(X,F)&&(o.select.set(v,{y:F}),j(l.value,y,F-m)),p(X,Y)&&(o.select.set(v,{y:Y}),j(l.value,y,Y-m)),p(X,U)&&(o.select.set(v,{y:U}),j(l.value,y,U-m))),v.includes("coll")&&(p(y,L)&&(o.select.set(v,{x:L}),j(l.value,L,b)),p(y,r)&&(o.select.set(v,{x:r}),j(l.value,r,b)),p(y,i)&&(o.select.set(v,{x:i}),j(l.value,i,b))),v.includes("colc")&&(p(A,L)&&(o.select.set(v,{x:L}),j(l.value,L-f/2,b)),p(A,r)&&(o.select.set(v,{x:r}),j(l.value,r-f/2,b)),p(A,i)&&(o.select.set(v,{x:i}),j(l.value,i-f/2,b))),v.includes("colr")&&(p(B,L)&&(o.select.set(v,{x:L}),j(l.value,L-f,b)),p(B,r)&&(o.select.set(v,{x:r}),j(l.value,r-f,b)),p(B,i)&&(o.select.set(v,{x:i}),j(l.value,i-f,b)))})})}catch(f){console.log(f)}},200),{deep:!0}),pe(()=>g.value,f=>{f||(o.select.clear(),o.sorptioned.y=!1)}),(f,m)=>(w(),z("div",$n,[(w(!0),z(he,null,_e(o.lineArr,y=>(w(),z("div",{class:ie(["line",[y.includes("row")?"row":"col",o.select.has(y)&&"visible"]]),key:y,style:oe(d(o.select.get(y)))},null,6))),128))]))}});var Nn=ce(Un,[["__scopeId","data-v-403a9eed"]]);const Kn=ue({__name:"index",setup(e){return(n,t)=>{const a=I("n-watermark");return w(),$(a,{id:"go-edit-watermark",content:s(Zt),cross:"",selectable:"","font-size":16,"line-height":16,width:500,height:150,"x-offset":12,"y-offset":80,rotate:-15},null,8,["content"])}}});var Gn=ce(Kn,[["__scopeId","data-v-e5cd93da"]]);const Mt=e=>(At("data-v-71d41248"),e=e(),kt(),e),Yn=Mt(()=>W("div",{class:"select-background"},null,-1)),Xn=Mt(()=>W("div",{class:"select-border"},null,-1)),Wn=[Yn,Xn],zn=ue({__name:"index",setup(e){Ae(C=>({c29aca42:s(d)}));const n=ke(),t=re(),{isSelect:a,scale:o}=Ue(t.getEditCanvas),d=P(()=>n.getAppTheme),h=Q();return pe(()=>t.getMousePosition,C=>{if(!a.value)return;const{startX:g,startY:p,x:_,y:l}=C,u={zIndex:ft,x:0,y:0,w:0,h:0,offsetX:0,offsetY:0};_>g&&l>p?(u.x=g,u.y=p,u.w=Math.round((_-g)/o.value),u.h=Math.round((l-p)/o.value)):_>g&&l<p?(u.x=g,u.w=Math.round((_-g)/o.value),u.h=Math.round((p-l)/o.value),u.y=p-u.h):_<g&&l>p?(u.y=p,u.w=Math.round((g-_)/o.value),u.h=Math.round((l-p)/o.value),u.x=g-u.w):(u.w=Math.round((g-_)/o.value),u.h=Math.round((p-l)/o.value),u.x=g-u.w,u.y=p-u.h),h.value=K(K({},Ie(u,ft)),ye(u))},{deep:!0}),(C,g)=>s(a)?(w(),z("div",{key:0,class:"go-edit-select",style:oe(h.value)},Wn,4)):fe("",!0)}});var jn=ce(zn,[["__scopeId","data-v-71d41248"]]);const qn=ue({__name:"index",setup(e){const n=re(),{getEditCanvasConfig:t,getEditCanvas:a}=Ue(n),o=P(()=>({w:t.value.width,h:t.value.height})),d=P(()=>{const C={transform:`scale(${a.value.scale})`};return K(K({},ye(o.value)),C)}),h=P(()=>{const C=a.value.isCreate&&{"z-index":99999};return K(K({},ye(o.value)),C)});return(C,g)=>(w(),z("div",{class:"go-edit-range go-transition",style:oe(s(d)),onMousedown:g[0]||(g[0]=p=>s(Mn)(p,void 0))},[at(C.$slots,"default",{},void 0,!0),O(s(Gn)),O(s(Nn)),O(s(jn)),W("div",{class:"go-edit-range-model",style:oe(s(h))},null,4)],36))}});var Jn=ce(qn,[["__scopeId","data-v-52e445d0"]]),Bt=!!(typeof window!="undefined"&&window.document&&window.document.createElement),tt=!1,nt=!1;try{var qe={get passive(){return tt=!0},get once(){return nt=tt=!0}};Bt&&(window.addEventListener("test",qe,qe),window.removeEventListener("test",qe,!0))}catch(e){}function Vn(e,n,t,a){if(a&&typeof a!="boolean"&&!nt){var o=a.once,d=a.capture,h=t;!nt&&o&&(h=t.__once||function C(g){this.removeEventListener(n,C,d),t.call(this,g)},t.__once=h),e.addEventListener(n,h,tt?a:d)}e.addEventListener(n,t,a)}function Qn(e,n,t,a){var o=a&&typeof a!="boolean"?a.capture:a;e.removeEventListener(n,t,o),t.__once&&e.removeEventListener(n,t.__once,o)}function gt(e,n,t,a){return Vn(e,n,t,a),function(){Qn(e,n,t,a)}}var _t=new Date().getTime();function Zn(e){var n=new Date().getTime(),t=Math.max(0,16-(n-_t)),a=setTimeout(e,t);return _t=n,a}var es=["","webkit","moz","o","ms"],mt=Zn,Ct=function(n,t){return n+(n?t[0].toUpperCase()+t.substr(1):t)+"AnimationFrame"};Bt&&es.some(function(e){var n=Ct(e,"request");return n in window&&(Ct(e,"cancel"),mt=function(a){return window[n](a)}),!!mt});Function.prototype.bind.call(Function.prototype.call,[].slice);Function.prototype.bind.call(Function.prototype.call,[].slice);const ts={class:"go-sketch-rule"},ns={key:1,class:"fix-edit-screens-block"},ss=ue({__name:"index",setup(e){Ae(S=>({"6f694401":s(G),ed8dd9a8:s(M),"58b617f4":u.value}));const n=re(),t=Yt(),a=ke(),o=20;let d=[0,0],h=[0,0];const C=Q(),g=Q(!0),p=Q(),_=Q(),l=Q(!1),u=Q("auto"),{width:c,height:f}=Ue(n.getEditCanvasConfig),m=Q(0),y=Q(0),A=$e({h:[],v:[]}),B=P(()=>n.getEditCanvas.scale),M=P(()=>`${f.value*2}px`),b=P(()=>a.getDarkTheme?{bgColor:"#18181c",longfgColor:"#4d4d4d",shortfgColor:"#4d4d4d",fontColor:"#4d4d4d",shadowColor:"#18181c",borderColor:"#18181c",cornerActiveColor:"#18181c"}:{}),G=P(()=>a.getAppTheme),X=S=>{if(S.ctrlKey||S.metaKey){S.preventDefault();let L=B.value;if(S.wheelDelta>=0&&B.value<2){L=B.value+.05,n.setScale(L);return}S.wheelDelta<0&&B.value>.1&&(L=B.value-.05,n.setScale(L))}},q=()=>{if(!C.value)return;const S=C.value.getBoundingClientRect(),L=p.value.getBoundingClientRect();m.value=(S.left+o-L.left)/B.value,y.value=(S.top+o-L.top)/B.value},T=S=>{var F,Y;if(S.preventDefault(),S.stopPropagation(),S.which==2)l.value=!0;else if(!((F=window.$KeyboardActive)!=null&&F.space))return;(Y=document.activeElement)==null||Y.blur();const L=S.pageX,r=S.pageY,i=gt(window,"mousemove",U=>{const le=U.pageX-L,Ee=U.pageY-r,[Ne,Fe]=d,[Ke,be]=h;d=[Fe,le],h=[be,Ee],C.value.scrollLeft-=Fe>Ne?Math.abs(Fe-Ne):-Math.abs(Fe-Ne),C.value.scrollTop-=be>Ke?Math.abs(be-Ke):-Math.abs(be-Ke)}),k=gt(window,"mouseup",()=>{i(),k(),d=[0,0],h=[0,0],l.value=!1})},v=()=>{const S=document.getElementById("go-chart-edit-layout");return S?{height:S.clientHeight-25,width:S.clientWidth}:{width:c.value,height:f.value}},H=()=>{g.value=!1,setTimeout(()=>{g.value=!0},10)},N=()=>{const{width:S,height:L}=_.value.getBoundingClientRect(),{width:r,height:i}=v();C.value.scrollLeft=S/2-r/2,C.value.scrollTop=L/2-i/2};return pe(()=>a.getDarkTheme,()=>{H()}),pe(()=>B.value,(S,L)=>{L!==S?(t.setItemUnHandle(Xt.RE_POSITION_CANVAS,!1),q(),setTimeout(()=>{N(),H()},400)):se(H,20)}),pe(()=>l.value,S=>{u.value=S?"grab":"auto"}),ot(()=>{C.value&&(C.value.addEventListener("wheel",X,{passive:!1}),N())}),wt(()=>{C.value&&C.value.removeEventListener("wheel",X)}),window.onKeySpacePressHold=S=>{l.value=S},(S,L)=>{const r=I("sketch-rule");return w(),z("div",ts,[g.value?(w(),$(r,{key:0,thick:o,scale:s(B),width:v().width,height:v().height,startX:m.value,startY:y.value,lines:A,palette:s(b)},null,8,["scale","width","height","startX","startY","lines","palette"])):fe("",!0),W("div",{ref_key:"$app",ref:C,class:"edit-screens",onScroll:q},[W("div",{ref_key:"$container",ref:_,class:"edit-screen-container",style:oe({width:s(c)*2+"px"})},[W("div",{ref_key:"refSketchRuleBox",ref:p,class:"canvas",onMousedown:T,style:oe({marginLeft:"-"+(v().width/2-25)+"px"})},[W("div",{style:oe({pointerEvents:l.value?"none":"auto"})},[at(S.$slots,"default",{},void 0,!0)],4)],36)],4)],544),s(a).getDarkTheme?(w(),z("div",ns)):fe("",!0)])}}});var os=ce(ss,[["__scopeId","data-v-12b70182"]]);const Je={[R.ADD]:"\u65B0\u589E",[R.DELETE]:"\u5220\u9664",[R.UPDATE]:"\u66F4\u65B0",[R.MOVE]:"\u79FB\u52A8",[R.PASTE]:"\u7C98\u8D34",[R.COPY]:"\u590D\u5236",[R.CUT]:"\u526A\u5207",[R.TOP]:"\u7F6E\u9876",[R.BOTTOM]:"\u7F6E\u5E95",[R.UP]:"\u4E0A\u79FB",[R.DOWN]:"\u4E0B\u79FB",[R.GROUP]:"\u6210\u7EC4",[R.UN_GROUP]:"\u89E3\u7EC4",[R.LOCK]:"\u9501\u5B9A",[R.UNLOCK]:"\u89E3\u9501",[R.HIDE]:"\u9690\u85CF",[R.SHOW]:"\u663E\u793A",[Be.CANVAS]:"\u753B\u5E03\u521D\u59CB\u5316"};var as=Array.prototype,rs=as.reverse;function us(e){return e==null?e:rs.call(e)}var cs=us;const Rt=e=>(At("data-v-5a4fd660"),e=e(),kt(),e),ls={class:"go-flex-items-center"},is=Rt(()=>W("span",{class:"btn-text"},"\u5386\u53F2\u8BB0\u5F55",-1)),ds={class:"history-list-box"},fs=["title"],ps=Rt(()=>W("div",{class:"popover-modal"},null,-1)),hs=ue({__name:"index",setup(e){const{DesktopOutlineIcon:n,PencilIcon:t,TrashIcon:a,CopyIcon:o,LayersIcon:d,DuplicateIcon:h,HelpOutlineIcon:C,LockClosedOutlineIcon:g,LockOpenOutlineIcon:p,EyeOffOutlineIcon:_,EyeOutlineIcon:l}=De.ionicons5,{StackedMoveIcon:u,Carbon3DCursorIcon:c,Carbon3DSoftwareIcon:f}=De.carbon,m=Wt(),y=M=>{if(M.targetType===Be.CANVAS)return n;switch(M.actionType){case R.UPDATE:return t;case R.DELETE:return a;case R.PASTE:return o;case R.TOP:return d;case R.BOTTOM:return d;case R.UP:return d;case R.DOWN:return d;case R.MOVE:return u;case R.ADD:return h;case R.GROUP:return c;case R.UN_GROUP:return f;case R.LOCK:return g;case R.UNLOCK:return p;case R.HIDE:return _;case R.SHOW:return l;default:return t}},A=M=>{if(M.targetType===Be.CANVAS)return Je[Be.CANVAS];if(M.actionType===R.GROUP||M.actionType===R.UN_GROUP)return`${Je[M.actionType]}`;if(M.historyData.length)return`${Je[M.actionType]} - ${M.historyData[0].chartConfig.title}`},B=P(()=>{const b=m.getBackStack.map(G=>({label:A(G),icon:y(G)}));return cs(b.filter(G=>G.label))});return(M,b)=>{const G=I("n-button"),X=I("n-icon"),q=I("n-text"),T=I("n-scrollbar"),v=I("n-popover"),H=I("n-tooltip");return w(),z("div",ls,[O(v,{class:"edit-history-popover","show-arrow":!1,size:"small",trigger:"click",placement:"top-start"},{trigger:D(()=>[O(G,{class:"mr-10",secondary:"",size:"small",disabled:s(B).length===0},{default:D(()=>[is]),_:1},8,["disabled"])]),default:D(()=>[W("div",ds,[O(T,{style:{"max-height":"500px"}},{default:D(()=>[(w(!0),z(he,null,_e(s(B),(N,S)=>(w(),z("div",{class:"list-item go-flex-items-center go-ellipsis-1",key:S,title:N.label},[O(X,{class:"item-icon",size:"16",depth:2,component:N.icon},null,8,["component"]),O(q,{depth:"2"},{default:D(()=>[Ce(de(N.label),1)]),_:2},1024)],8,fs))),128))]),_:1}),ps])]),_:1}),O(H,{trigger:"hover"},{trigger:D(()=>[O(X,{size:"21",depth:3},{default:D(()=>[O(s(C))]),_:1})]),default:D(()=>[W("span",null,"\u6700\u591A\u53EA\u4FDD\u7559"+de(s(en))+"\u6761\u8BB0\u5F55",1)]),_:1})])}}});var vs=ce(hs,[["__scopeId","data-v-5a4fd660"]]);const gs={class:"go-edit-bottom"},_s=ue({__name:"index",setup(e){Ae(y=>({f3add9fc:o.value}));const{LockClosedOutlineIcon:n,LockOpenOutlineIcon:t}=De.ionicons5,a=ke(),o=Q(a.getAppTheme),d=re(),{lockScale:h,scale:C}=Ue(d.getEditCanvas);let g=[{label:"200%",value:200},{label:"150%",value:150},{label:"100%",value:100},{label:"50%",value:50},{label:"\u81EA\u9002\u5E94",value:0}];const p=Q(""),_=y=>{if(y===0){d.computedScale();return}d.setScale(y/100)},l=()=>{d.setEditCanvas(ae.LOCK_SCALE,!h.value)},u=Q(100),c=y=>`${y}%`,f=y=>{d.setScale(y/100)},m=$e({100:""});return tn(()=>{const y=(C.value*100).toFixed(0);p.value=`${y}%`,u.value=parseInt(y)}),(y,A)=>{const B=I("n-text"),M=I("n-space"),b=I("n-select"),G=I("n-icon"),X=I("n-button"),q=I("n-tooltip"),T=I("n-slider");return w(),z("div",gs,[O(M,null,{default:D(()=>[O(s(vs)),O(B,{id:"keyboard-dress-show",depth:"3"})]),_:1}),O(M,{class:"bottom-ri"},{default:D(()=>[O(xn),O(b,{disabled:s(h),class:"scale-btn",value:p.value,"onUpdate:value":[A[0]||(A[0]=v=>p.value=v),_],size:"mini",options:s(g)},null,8,["disabled","value","options"]),O(q,{trigger:"hover"},{trigger:D(()=>[O(X,{onClick:l,text:""},{default:D(()=>[O(G,{class:ie(["lock-icon",{color:s(h)}]),size:"18",depth:2},{default:D(()=>[s(h)?(w(),$(s(n),{key:0})):(w(),$(s(t),{key:1}))]),_:1},8,["class"])]),_:1})]),default:D(()=>[W("span",null,de(s(h)?"\u89E3\u9501":"\u9501\u5B9A")+"\u5F53\u524D\u6BD4\u4F8B",1)]),_:1}),O(T,{class:"scale-slider",value:u.value,"onUpdate:value":[A[1]||(A[1]=v=>u.value=v),f],"default-value":50,min:10,max:200,step:5,"format-tooltip":c,disabled:s(h),marks:m},null,8,["value","disabled","marks"])]),_:1})])}}});var ms=ce(_s,[["__scopeId","data-v-99a534fc"]]);const Cs=ue({__name:"index",props:{modelShow:Boolean},emits:["update:modelShow"],setup(e,{emit:n}){const t=e,{HelpOutlineIcon:a,CloseIcon:o}=De.ionicons5,d=rt(),h=Q(!1),C=$e([{key:ve.ASIDE_ALL_COLLAPSED,value:d.getAsideAllCollapsed,type:"switch",name:"\u83DC\u5355\u6298\u53E0",desc:"\u9996\u9875\u83DC\u5355\u6298\u53E0\u65F6\u9690\u85CF\u81F3\u754C\u9762\u5916"},{key:ve.HIDE_PACKAGE_ONE_CATEGORY,value:d.getHidePackageOneCategory,type:"switch",name:"\u9690\u85CF\u5206\u7C7B",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u8868\u5355\u5206\u7C7B\u53EA\u6709\u5355\u9879\u65F6\u9690\u85CF"},{key:ve.CHANGE_LANG_RELOAD,value:d.getChangeLangReload,type:"switch",name:"\u5207\u6362\u8BED\u8A00",desc:"\u5207\u6362\u8BED\u8A00\u91CD\u65B0\u52A0\u8F7D\u9875\u9762",tip:"\u82E5\u9047\u5230\u90E8\u5206\u533A\u57DF\u8BED\u8A00\u5207\u6362\u5931\u8D25\uFF0C\u5219\u5EFA\u8BAE\u5F00\u542F"},{key:"divider1",type:"divider",name:"",desc:"",value:""},{key:ve.CHART_TOOLS_STATUS_HIDE,value:d.getChartToolsStatusHide,type:"switch",name:"\u9690\u85CF\u5DE5\u5177\u680F",desc:"\u9F20\u6807\u79FB\u5165\u65F6\uFF0C\u4F1A\u5C55\u793A\u5207\u6362\u5230\u5C55\u5F00\u6A21\u5F0F"},{key:ve.CHART_TOOLS_STATUS,value:d.getChartToolsStatus,type:"select",name:"\u5DE5\u5177\u680F\u5C55\u793A",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u5DE5\u5177\u680F\u5C55\u793A\u65B9\u5F0F",options:[{label:"\u4FA7\u8FB9\u680F",value:Pe.ASIDE},{label:"\u5E95\u90E8 Dock",value:Pe.DOCK}]},{key:"divider0",type:"divider",name:"",desc:"",value:""},{key:ve.CHART_MOVE_DISTANCE,value:d.getChartMoveDistance,type:"number",name:"\u79FB\u52A8\u8DDD\u79BB",min:1,step:1,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u65B9\u5411\u952E\u63A7\u5236\u79FB\u52A8\u8DDD\u79BB"},{key:ve.CHART_ALIGN_RANGE,value:d.getChartAlignRange,type:"number",name:"\u5438\u9644\u8DDD\u79BB",min:10,step:2,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u79FB\u52A8\u56FE\u8868\u65F6\u7684\u5438\u9644\u8DDD\u79BB"}]);pe(()=>t.modelShow,_=>{h.value=_});const g=()=>{n("update:modelShow",!1)},p=(_,l)=>{d.setItem(l.key,l.value)};return(_,l)=>{const u=I("n-h3"),c=I("n-icon"),f=I("n-space"),m=I("n-divider"),y=I("n-text"),A=I("n-switch"),B=I("n-input-number"),M=I("n-select"),b=I("n-tooltip"),G=I("n-list-item"),X=I("n-list"),q=I("n-modal");return w(),$(q,{show:h.value,"onUpdate:show":l[0]||(l[0]=T=>h.value=T),onAfterLeave:g},{default:D(()=>[O(X,{bordered:"",class:"go-system-setting"},{header:D(()=>[O(f,{justify:"space-between"},{default:D(()=>[O(u,{class:"go-mb-0"},{default:D(()=>[Ce("\u7CFB\u7EDF\u8BBE\u7F6E")]),_:1}),O(c,{size:"20",class:"go-cursor-pointer",onClick:g},{default:D(()=>[O(s(o))]),_:1})]),_:1})]),default:D(()=>[(w(!0),z(he,null,_e(C,T=>(w(),$(G,{key:T.key},{default:D(()=>[T.type==="divider"?(w(),$(m,{key:0,style:{margin:"0"}})):(w(),$(f,{key:1,size:40},{default:D(()=>[O(f,null,{default:D(()=>[O(y,{class:"item-left"},{default:D(()=>[Ce(de(T.name),1)]),_:2},1024),T.type==="switch"?(w(),$(A,{key:0,value:T.value,"onUpdate:value":[v=>T.value=v,v=>p(v,T)],size:"small"},null,8,["value","onUpdate:value"])):T.type==="number"?(w(),$(B,{key:1,value:T.value,"onUpdate:value":[v=>T.value=v,v=>p(v,T)],class:"input-num-width",size:"small",step:T.step||null,suffix:T.suffix||null,min:T.min||0},null,8,["value","onUpdate:value","step","suffix","min"])):T.type==="select"?(w(),$(M,{key:2,class:"select-min-width",value:T.value,"onUpdate:value":[v=>T.value=v,v=>p(v,T)],size:"small",options:T.options},null,8,["value","onUpdate:value","options"])):fe("",!0)]),_:2},1024),O(f,null,{default:D(()=>[O(y,{class:"item-right"},{default:D(()=>[Ce(de(T.desc),1)]),_:2},1024),T.tip?(w(),$(b,{key:0,trigger:"hover"},{trigger:D(()=>[O(c,{size:"21"},{default:D(()=>[O(s(a))]),_:1})]),default:D(()=>[W("span",null,de(T.tip),1)]),_:2},1024)):fe("",!0)]),_:2},1024)]),_:2},1024))]),_:2},1024))),128))]),_:1})]),_:1},8,["show"])}}});var ys=ce(Cs,[["__scopeId","data-v-7cea0aa5"]]);const xe=re(),Es=()=>{xe.setTargetSelectChart(void 0),nn(sn(xe.getStorageInfo||[]),void 0,"json");const e=document.querySelector(".go-edit-range"),n=document.getElementById("go-edit-watermark");if(!e||!n){window.$message.error("\u5BFC\u51FA\u5931\u8D25\uFF01");return}const t=xe.getEditCanvas.scale;xe.setScale(1,!0),n.style.display="block",setTimeout(()=>{on(e,()=>{n&&(n.style.display="none"),xe.setScale(t,!0)})},600)};var st=(e=>(e.TXT="text/plain",e.JSON="application/json",e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e))(st||{});const Ss=()=>{const e=Q(),{updateComponent:n}=St();return{importUploadFileListRef:e,importBeforeUpload:({file:o})=>{e.value=[];const d=o.file.type;return d!==st.JSON&&d!==st.TXT?(window.$message.warning("\u4EC5\u652F\u6301\u4E0A\u4F20 \u3010JSON\u3011 \u683C\u5F0F\u6587\u4EF6\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20\uFF01"),!1):!0},importCustomRequest:o=>{const{file:d}=o;an(()=>{d.file?rn(d.file).then(h=>{_n({message:"\u8BF7\u9009\u62E9\u5BFC\u5165\u65B9\u5F0F:",positiveText:"\u65B0\u589E\uFF08\u53EF\u64A4\u56DE\uFF09",negativeText:"\u8986\u76D6\uFF08\u4E0D\u53EF\u64A4\u56DE\uFF09",negativeButtonProps:{type:"info",ghost:!1},onPositiveCallback:()=>we(void 0,null,function*(){try{h=Ve(h),yield n(h,!1,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(C){console.log(C),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}}),onNegativeCallback:()=>we(void 0,null,function*(){try{h=Ve(h),yield n(h,!0,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(C){console.log(C),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}})})}):window.$message.error("\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u6216\u8054\u7CFB\u7BA1\u7406\u5458\uFF01")})}}},{updateComponent:ws,dataSyncUpdate:yt}=St(),Ts=re(),xs=()=>{const e=d=>ws(d.detail,!0,!1),n=()=>we(void 0,null,function*(){yt&&(yield yt()),dispatchEvent(new CustomEvent(Xe.CHART,{detail:Ts.getStorageInfo}))}),t=()=>{addEventListener("blur",n),addEventListener(Xe.JSON,e)},a=()=>{removeEventListener(Xe.JSON,e),removeEventListener("blur",n)};return(d,h)=>{h==pt.CHART_HOME_NAME&&a(),d==pt.CHART_HOME_NAME&&t()}},Ds=()=>{const e=Ft();pe(()=>e.name,xs(),{immediate:!0})};var ge=(e=>(e.BUTTON="button",e.IMPORTUPLOAD="importUpload",e))(ge||{});const As={class:"btn-item"},ks=ue({__name:"index",setup(e){const{DownloadIcon:n,ShareIcon:t,PawIcon:a,SettingsSharpIcon:o,CreateIcon:d}=De.ionicons5,h=rt(),C=re();Ft(),Ds();let g=null;const p=Q(!1),_=Q(!0),l=Q(!0),{importUploadFileListRef:u,importCustomRequest:c,importBeforeUpload:f}=Ss(),m=P(()=>h.getChartToolsStatus===Pe.ASIDE),y=P(()=>h.getChartToolsStatusHide),A=P(()=>_.value&&y.value),B=P(()=>{if(!m.value)return q;const T=[];return q.map(v=>{T.unshift(v)}),T}),M=()=>{g=setTimeout(()=>{_.value&&(_.value=!1,l.value=!0)},200),setTimeout(()=>{l.value=!1},400)},b=()=>{clearTimeout(g),_.value||(_.value=!0)},G=()=>{window.$message.warning("\u5C06\u5F00\u542F\u5931\u7126\u66F4\u65B0\uFF01"),setTimeout(()=>{const T=cn(ln.CHART_EDIT_NAME,"href");if(!T)return;const v=dn();X(v),fn(T,[v],void 0,!0)},1e3)},X=T=>{const v=C.getStorageInfo,H=pn(Oe.GO_CHART_STORAGE_LIST)||[];if(H!=null&&H.length){const N=H.findIndex(S=>S.id===T);N!==-1?(H.splice(N,1,Se(K({},v),{id:T})),je(Oe.GO_CHART_STORAGE_LIST,H)):(H.push(Se(K({},v),{id:T})),je(Oe.GO_CHART_STORAGE_LIST,H))}else je(Oe.GO_CHART_STORAGE_LIST,[Se(K({},v),{id:T})])},q=[{key:"import",type:ge.IMPORTUPLOAD,name:"\u5BFC\u5165",icon:t},{key:"export",type:ge.BUTTON,name:"\u5BFC\u51FA",icon:n,handle:Es},{key:"edit",type:ge.BUTTON,name:"\u7F16\u8F91",icon:d,handle:G},{key:"setting",type:ge.BUTTON,name:"\u8BBE\u7F6E",icon:o,handle:()=>{p.value=!0}}];return(T,v)=>{const H=I("n-icon"),N=I("n-text"),S=I("n-button"),L=I("n-upload"),r=I("n-tooltip");return w(),z(he,null,[W("div",{class:ie(["go-chart-edit-tools",[s(h).getChartToolsStatus,s(A)?"isMini":"unMini"]]),onClick:v[1]||(v[1]=i=>_.value&&(_.value=!1)),onMouseenter:M,onMouseleave:b},[We(O(H,{class:"asideLogo",size:"22"},{default:D(()=>[O(s(a))]),_:1},512),[[ze,s(h).getChartToolsStatus===s(Pe).ASIDE&&s(A)]]),(w(!0),z(he,null,_e(s(B),(i,k)=>(w(),$(r,{key:i.key,disabled:!s(m)||s(y)&&l.value,trigger:"hover",placement:"left"},{trigger:D(()=>[W("div",As,[i.type===s(ge).BUTTON?(w(),$(S,{key:0,circle:s(m),secondary:"",onClick:i.handle},{icon:D(()=>[s(m)?(w(),$(H,{key:0,size:"22"},{default:D(()=>[(w(),$(me(i.icon)))]),_:2},1024)):(w(),$(me(i.icon),{key:1}))]),default:D(()=>[We(O(N,{depth:"3"},{default:D(()=>[Ce(de(i.name),1)]),_:2},1536),[[ze,!s(m)]])]),_:2},1032,["circle","onClick"])):i.type===s(ge).IMPORTUPLOAD?(w(),$(L,{key:1,"file-list":s(u),"onUpdate:fileList":v[0]||(v[0]=F=>un(u)?u.value=F:null),"show-file-list":!1,customRequest:s(c),onBeforeUpload:s(f)},{default:D(()=>[O(S,{circle:s(m),secondary:""},{icon:D(()=>[s(m)?(w(),$(H,{key:0,size:"22"},{default:D(()=>[(w(),$(me(i.icon)))]),_:2},1024)):(w(),$(me(i.icon),{key:1}))]),default:D(()=>[We(O(N,{depth:"3"},{default:D(()=>[Ce(de(i.name),1)]),_:2},1536),[[ze,!s(m)]])]),_:2},1032,["circle"])]),_:2},1032,["file-list","customRequest","onBeforeUpload"])):fe("",!0)])]),default:D(()=>[W("span",null,de(i.name),1)]),_:2},1032,["disabled"]))),128))],34),O(s(ys),{modelShow:p.value,"onUpdate:modelShow":v[2]||(v[2]=i=>p.value=i)},null,8,["modelShow"])],64)}}});var Fs=ce(ks,[["__scopeId","data-v-4c257f27"]]);const bs=ue({__name:"index",setup(e){const n=re(),{handleContextMenu:t}=ut();Dn();const{mouseenterHandle:a,mouseleaveHandle:o,mousedownHandle:d,mouseClickHandle:h}=Lt(),C=(l,u,c)=>{if(n.getTargetChart.selectId.length>1)return u.filter(m=>[x.GROUP,x.DELETE].includes(m.key));const f=[];return c.status.lock?f.push(x.LOCK):f.push(x.UNLOCK),c.status.hide?f.push(x.HIDE):f.push(x.SHOW),l.filter(m=>!f.includes(m.key))},g=P(()=>n.getEditCanvasConfig.chartThemeSetting),p=P(()=>{const l=n.getEditCanvasConfig.chartThemeColor;return Et[l]});P(()=>n.getEditCanvasConfig.filterShow);const _=P(()=>{const l=n.getEditCanvasConfig.background,u=n.getEditCanvasConfig.backgroundImage,m=n.getEditCanvasConfig.selectColor?{background:l||void 0}:{background:`url(${u}) no-repeat center center / cover !important`};return Se(K({},m),{width:"inherit",height:"inherit"})});return ot(()=>{bn()}),(l,u)=>(w(),$(s(Tn),{id:"go-chart-edit-layout",flex:!0,showTop:!1,showBottom:!0,depth:1,xScroll:!0,disabledScroll:!0,onMousedown:s(Ot),onDrop:s(Ln),onDragover:s(vt),onDragenter:s(vt)},{aside:D(()=>[O(s(Fs))]),bottom:D(()=>[O(s(ms))]),default:D(()=>[O(s(os),null,{default:D(()=>[W("div",{id:"go-chart-edit-content",onContextmenu:u[0]||(u[0]=(...c)=>s(t)&&s(t)(...c))},[O(s(Jn),null,{default:D(()=>[W("div",{style:oe(K(K({},s(He)(s(n).getEditCanvasConfig)),s(_)))},[(w(!0),z(he,null,_e(s(n).getComponentList,(c,f)=>(w(),z("div",{key:c.id},[c.isGroup?(w(),$(s(Pn),{key:0,groupData:c,groupIndex:f},null,8,["groupData","groupIndex"])):(w(),$(s(et),{key:1,"data-id":c.id,index:f,style:oe(K(K({},s(Ie)(c.attr,f)),s(Dt)(c.styles))),item:c,onClick:m=>s(h)(m,c),onMousedown:m=>s(d)(m,c),onMouseenter:m=>s(a)(m,c),onMouseleave:m=>s(o)(m,c),onContextmenu:m=>s(t)(m,c,C)},{default:D(()=>[s(mn)(c)?(w(),$(s(zt),{key:0,title:s(Cn)(c),attr:c.attr,titleSize:s(yn)(c)},null,8,["title","attr","titleSize"])):fe("",!0),s(En)(c)?(w(),$(s(jt),{key:1,class:"filter-content",componentIdx:c.id,attr:c.attr,filters:c.chartConfig.filters,type:c.chartConfig.category},null,8,["componentIdx","attr","filters","type"])):fe("",!0),(w(),$(me(c.chartConfig.chartKey),{class:ie(["edit-content-chart",s(Qe)(c.styles.animations)]),chartConfig:c,themeSetting:s(g),themeColor:s(p),style:oe(K(K(K({},s(qt)(c.attr,s(Sn)(c)+s(wn)(c))),s(He)(c.styles)),s(Ze)(c.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","style","item","onClick","onMousedown","onMouseenter","onMouseleave","onContextmenu"]))]))),128))],4)]),_:1})],32)]),_:1})]),_:1},8,["onMousedown","onDrop","onDragover","onDragenter"]))}});var Gs=ce(bs,[["__scopeId","data-v-0512ae48"]]);export{Gs as default};
