var It=Object.defineProperty,Ht=Object.defineProperties;var Pt=Object.getOwnPropertyDescriptors;var ct=Object.getOwnPropertySymbols;var $t=Object.prototype.hasOwnProperty,Ut=Object.prototype.propertyIsEnumerable;var lt=(e,n,t)=>n in e?It(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,K=(e,n)=>{for(var t in n||(n={}))$t.call(n,t)&&lt(e,t,n[t]);if(ct)for(var t of ct(n))Ut.call(n,t)&&lt(e,t,n[t]);return e},we=(e,n)=>Ht(e,Pt(n));var Se=(e,n,t)=>new Promise((o,s)=>{var h=m=>{try{w(t.next(m))}catch(v){s(v)}},c=m=>{try{w(t.throw(m))}catch(v){s(v)}},w=m=>m.done?o(m.value):Promise.resolve(m.value).then(h,c);w((t=t.apply(e,n)).next())});import{u as re,E as ae,t as se,A as Ke,B as Nt,z as Kt,D as Re,G as Yt,J as Ee,d as Et,K as Ie,g as Gt,h as Xt,M as B,Q as Be,a as Wt,b as wt,O as zt,F as jt,R as qt}from"./useSync.hook-77adf4de.js";import{x as ot,a6 as St,b3 as Jt,aj as x,c6 as Tt,c7 as xt,cm as it,cl as Vt,c4 as Ve,cn as j,cb as Ye,ak as Qt,d as ue,bJ as Ae,u as ke,a5 as H,o as T,h as z,j as at,F as ve,A as me,ad as ie,aP as oe,f as l,a9 as fe,z as W,p as ce,c as U,w as D,L as Ce,bU as Qe,bV as He,bW as Ze,bX as Dt,a4 as rt,y as $e,al as dt,R as pe,r as R,co as Zt,a3 as Ue,q as Q,cp as ft,H as At,I as kt,e as O,m as ye,t as de,aI as en,aS as tn,cq as ge,cr as Pe,cs as nn,c3 as sn,ct as on,am as an,cu as rn,J as Ft,Q as pt,c0 as Ge,X as Xe,Y as We,bS as un,V as cn,cv as ln,cw as dn,W as fn,aO as pn,S as Oe,c1 as ze}from"./index.js";import{u as ut,d as vn}from"./index-b43c8f2c.js";import{a as hn,b as vt,l as gn,g as _n}from"./plugin-bf1bfb0e.js";import{i as mn,h as Cn,o as yn,f as En}from"./useItem.hook-3e098f10.js";import{C as wn}from"./index-fad084cb.js";import{i as De}from"./icon-bc6d0f16.js";import{E as Sn}from"./index-90b6194b.js";import"./tables_list-38e71280.js";import"./index-1fdb049a.js";import"./index-813d73dc.js";const Te=re(),Tn=()=>{ot(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,document.getElementById("go-chart-edit-layout")),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,document.getElementById("go-chart-edit-content"));const e=Te.listenerScale();St(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,null),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,null),e()})})};var bt={exports:{}};(function(e){(function(n){var t,o={},s={16:!1,18:!1,17:!1,91:!1},h="all",c={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},w={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},m=function(r){return w[r]||r.toUpperCase().charCodeAt(0)},v=[];for(t=1;t<20;t++)w["f"+t]=111+t;function _(r,d){for(var A=r.length;A--;)if(r[A]===d)return A;return-1}function f(r,d){if(r.length!=d.length)return!1;for(var A=0;A<r.length;A++)if(r[A]!==d[A])return!1;return!0}var a={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function u(r){for(t in s)s[t]=r[a[t]]}function p(r){var d,A,k,G,N,le;if(d=r.keyCode,_(v,d)==-1&&v.push(d),(d==93||d==224)&&(d=91),d in s){s[d]=!0;for(k in c)c[k]==d&&(C[k]=!0);return}if(u(r),!!C.filter.call(this,r)&&d in o){for(le=q(),G=0;G<o[d].length;G++)if(A=o[d][G],A.scope==le||A.scope=="all"){N=A.mods.length>0;for(k in s)(!s[k]&&_(A.mods,+k)>-1||s[k]&&_(A.mods,+k)==-1)&&(N=!1);(A.mods.length==0&&!s[16]&&!s[18]&&!s[17]&&!s[91]||N)&&A.method(r,A)===!1&&(r.preventDefault?r.preventDefault():r.returnValue=!1,r.stopPropagation&&r.stopPropagation(),r.cancelBubble&&(r.cancelBubble=!0))}}}function g(r){var d=r.keyCode,A,k=_(v,d);if(k>=0&&v.splice(k,1),(d==93||d==224)&&(d=91),d in s){s[d]=!1;for(A in c)c[A]==d&&(C[A]=!1)}}function y(){for(t in s)s[t]=!1;for(t in c)C[t]=!1}function C(r,d,A){var k,G;k=i(r),A===void 0&&(A=d,d="all");for(var N=0;N<k.length;N++)G=[],r=k[N].split("+"),r.length>1&&(G=b(r),r=[r[r.length-1]]),r=r[0],r=m(r),r in o||(o[r]=[]),o[r].push({shortcut:k[N],scope:d,method:A,key:k[N],mods:G})}function P(r,d){var A,k,G=[],N,le,he;for(A=i(r),le=0;le<A.length;le++){if(k=A[le].split("+"),k.length>1&&(G=b(k),r=k[k.length-1]),r=m(r),d===void 0&&(d=q()),!o[r])return;for(N=0;N<o[r].length;N++)he=o[r][N],he.scope===d&&f(he.mods,G)&&(o[r][N]={})}}function L(r){return typeof r=="string"&&(r=m(r)),_(v,r)!=-1}function F(){return v.slice(0)}function Y(r){var d=(r.target||r.srcElement).tagName;return!(d=="INPUT"||d=="SELECT"||d=="TEXTAREA")}for(t in c)C[t]=!1;function X(r){h=r||"all"}function q(){return h||"all"}function $(r){var d,A,k;for(d in o)for(A=o[d],k=0;k<A.length;)A[k].scope===r?A.splice(k,1):k++}function i(r){var d;return r=r.replace(/\s/g,""),d=r.split(","),d[d.length-1]==""&&(d[d.length-2]+=","),d}function b(r){for(var d=r.slice(0,r.length-1),A=0;A<d.length;A++)d[A]=c[d[A]];return d}function E(r,d,A){r.addEventListener?r.addEventListener(d,A,!1):r.attachEvent&&r.attachEvent("on"+d,function(){A(window.event)})}E(document,"keydown",function(r){p(r)}),E(document,"keyup",g),E(window,"focus",y);var M=n.key;function I(){var r=n.key;return n.key=M,r}n.key=C,n.key.setScope=X,n.key.getScope=q,n.key.deleteScope=$,n.key.filter=Y,n.key.isPressed=L,n.key.getPressedKeyCodes=F,n.key.noConflict=I,n.key.unbind=P,e.exports=C})(Jt)})(bt);var Z=bt.exports;const ee=re(),ne=e=>`${Tt.CTRL}+${e}`,Le=e=>`${Tt.SHIFT}+${e}`,J={[x.ARROW_UP]:ne("up"),[x.ARROW_RIGHT]:ne("right"),[x.ARROW_DOWN]:ne("down"),[x.ARROW_LEFT]:ne("left"),[x.COPY]:ne("c"),[x.CUT]:ne("x"),[x.PARSE]:ne("v"),[x.DELETE]:"delete",[x.BACK]:ne("z"),[x.FORWORD]:ne(Le("z")),[x.GROUP]:ne("g"),[x.UN_GROUP]:ne(Le("g")),[x.LOCK]:ne("l"),[x.UNLOCK]:ne(Le("l")),[x.HIDE]:ne("h"),[x.SHOW]:ne(Le("h"))},te=e=>`${xt.CTRL}+${e}`,Me=e=>`${xt.SHIFT}+${e}`,V={[x.ARROW_UP]:te("arrowup"),[x.ARROW_RIGHT]:te("arrowright"),[x.ARROW_DOWN]:te("arrowdown"),[x.ARROW_LEFT]:te("arrowleft"),[x.COPY]:te("c"),[x.CUT]:te("x"),[x.PARSE]:te("v"),[x.DELETE]:te("backspace"),[x.BACK]:te("z"),[x.FORWORD]:te(Me("z")),[x.GROUP]:te("g"),[x.UN_GROUP]:te(Me("g")),[x.LOCK]:te("l"),[x.UNLOCK]:te(Me("l")),[x.HIDE]:te("h"),[x.SHOW]:te(Me("h"))},xn=[J.up,J.right,J.down,J.left,J.delete,J.copy,J.cut,J.parse,J.back,J.forward,J.group,J.unGroup,J.lock,J.unLock,J.hide,J.show],Dn=[V.up,V.right,V.down,V.left,V.delete,V.copy,V.cut,V.parse,V.back,V.forward,V.group,V.unGroup,V.lock,V.unLock,V.hide,V.show],An=()=>{window.$KeyboardActive={ctrl:!1,space:!1},document.onkeydown=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(it(e.keyCode),n){case 17:window.$KeyboardActive.ctrl=!0;break;case 32:window.$KeyboardActive.space=!0;break}},document.onkeyup=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(it(),n){case 17:window.$KeyboardActive.ctrl=!1;break;case 32:window.$KeyboardActive.space=!1;break}}},kn=()=>{const n=(t,o)=>{switch(o){case t.up:Z(o,se(()=>(ee.setMove(x.ARROW_UP),!1),50));break;case t.right:Z(o,se(()=>(ee.setMove(x.ARROW_RIGHT),!1),50));break;case t.down:Z(o,se(()=>(ee.setMove(x.ARROW_DOWN),!1),50));break;case t.left:Z(o,se(()=>(ee.setMove(x.ARROW_LEFT),!1),50));break;case t.delete:Z(o,Ke(()=>(ee.removeComponentList(),!1),50));break;case t.copy:Z(o,Ke(()=>(ee.setCopy(),!1),50));break;case t.cut:Z(o,Ke(()=>(ee.setCut(),!1),50));break;case t.parse:Z(o,se(()=>(ee.setParse(),!1),50));break;case t.back:Z(o,se(()=>(ee.setBack(),!1),50));break;case t.forward:Z(o,se(()=>(ee.setForward(),!1),50));break;case t.group:Z(o,se(()=>(ee.setGroup(),!1),50));break;case t.unGroup:Z(o,se(()=>(ee.setUnGroup(),!1),50));break;case t.lock:Z(o,se(()=>(ee.setLock(),!1),50));break;case t.unLock:Z(o,se(()=>(ee.setUnLock(),!1),50));break;case t.hide:Z(o,se(()=>(ee.setHide(),!1),50));break;case t.show:Z(o,se(()=>(ee.setShow(),!1),50));break}};xn.forEach(t=>{n(J,t)}),Dn.forEach(t=>{n(V,t)}),An()},S=re(),{onClickOutSide:Fn}=ut(),bn=e=>Se(void 0,null,function*(){e.preventDefault();try{hn();const n=e.dataTransfer.getData(Vt.DRAG_KEY);if(!n){vt();return}S.setEditCanvas(ae.IS_CREATE,!1);const t=Ve(n);let o;if(t.sourceID){let h=yield Nt(t.sourceID,t.category);if(!h){window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...");return}o=h.chartConfig}else o=t;let s=yield Kt(o);j(s,e.offsetX-s.attr.w/2,e.offsetY-s.attr.h/2),S.addComponentList(s,!1,!0),S.setTargetSelectChart(s.id),vt()}catch(n){gn(),window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...")}}),ht=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")},Ot=(e,n)=>{if(n){S.setTargetSelectChart(n.id);return}S.setTargetSelectChart(void 0)},On=(e,n)=>{var v;if(e.which==2||(v=window.$KeyboardActive)!=null&&v.space)return;Ot();const t=e.offsetX,o=e.offsetY,s=e.screenX,h=e.screenY,c=S.getEditCanvas.scale;S.setMousePosition(void 0,void 0,t,o);const w=Re.exports.throttle(_=>{S.setTargetSelectChart(),S.setEditCanvas(ae.IS_SELECT,!0);const f=t+_.screenX-s,a=o+_.screenY-h;S.setMousePosition(f,a);const u={x1:0,y1:0,x2:0,y2:0};f>t&&a>o?(u.x1=t,u.y1=o,u.x2=Math.round(t+(_.screenX-s)/c),u.y2=Math.round(o+(_.screenY-h)/c)):f>t&&a<o?(u.x1=t,u.y1=Math.round(o-(h-_.screenY)/c),u.x2=Math.round(t+(_.screenX-s)/c),u.y2=o):f<t&&a>o?(u.x1=Math.round(t-(s-_.screenX)/c),u.y1=o,u.x2=t,u.y2=Math.round(o+(_.screenY-h)/c)):(u.x1=Math.round(t-(s-_.screenX)/c),u.y1=Math.round(o-(h-_.screenY)/c),u.x2=t,u.y2=o),S.getComponentList.forEach(p=>{if(!S.getTargetChart.selectId.includes(p.id)){const{x:g,y,w:C,h:P}=p.attr,L={x1:g,y1:y,x2:g+C,y2:y+P};L.x1-u.x1>=0&&L.y1-u.y1>=0&&L.x2-u.x2<=0&&L.y2-u.y2<=0&&!p.status.lock&&!p.status.hide&&S.setTargetSelectChart(p.id,!0)}})},30),m=()=>{w.cancel(),S.setEditCanvas(ae.IS_SELECT,!1),S.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",m)};document.addEventListener("mousemove",w),document.addEventListener("mouseup",m)},Lt=()=>({mouseClickHandle:(s,h)=>{var c;if(s.preventDefault(),s.stopPropagation(),!h.status.lock&&(c=window.$KeyboardActive)!=null&&c.ctrl)if(S.targetChart.selectId.includes(h.id)){const w=S.targetChart.selectId.filter(m=>m!==h.id);S.setTargetSelectChart(w)}else S.setTargetSelectChart(h.id,!0)},mousedownHandle:(s,h)=>{var y;if(s.preventDefault(),s.stopPropagation(),h.status.lock||(Fn(),s.buttons===Ye.LEFT&&((y=window.$KeyboardActive)==null?void 0:y.ctrl)))return;const c=S.getTargetChart.selectId;if(s.buttons===Ye.RIGHT&&c.length>1&&c.includes(h.id)||(S.setTargetSelectChart(h.id),s.buttons===Ye.RIGHT))return;const w=S.getEditCanvas.scale,m=S.getEditCanvasConfig.width,v=S.getEditCanvasConfig.height,_=new Map;S.getTargetChart.selectId.forEach(C=>{const P=S.fetchTargetIndex(C);if(P!==-1){const{x:L,y:F,w:Y,h:X}=Qt(S.getComponentList[P]).attr;_.set(C,{x:L,y:F,w:Y,h:X})}});const f=s.screenX,a=s.screenY;let u=[];S.getTargetChart.selectId.forEach(C=>{if(!_.has(C))return;const P=S.fetchTargetIndex(C);u.push(Re.exports.cloneDeep(S.getComponentList[P]))}),S.setMousePosition(void 0,void 0,f,a);const p=Re.exports.throttle(C=>{S.setEditCanvas(ae.IS_DRAG,!0),S.setMousePosition(C.screenX,C.screenY);let P=(C.screenX-f)/w,L=(C.screenY-a)/w;S.getTargetChart.selectId.forEach(F=>{if(!_.has(F))return;const Y=S.fetchTargetIndex(F),{x:X,y:q,w:$,h:i}=_.get(F),b=S.getComponentList[Y];let E=Math.round(X+P),M=Math.round(q+L);const I=50;E=E<-$+I?-$+I:E,M=M<-i+I?-i+I:M,E=E>m-I?m-I:E,M=M>v-I?v-I:M,b&&!Number.isNaN(E)&&!Number.isNaN(M)&&(b.attr=Object.assign(b.attr,{x:E,y:M}))})},20),g=()=>{try{S.setMousePosition(0,0,0,0),S.setEditCanvas(ae.IS_DRAG,!1),u.length&&(S.getTargetChart.selectId.forEach(C=>{if(!_.has(C))return;const P=S.fetchTargetIndex(C),L=S.getComponentList[P];u.forEach(F=>{F.id===C&&(F.attr=Object.assign(F.attr,{offsetX:L.attr.x-F.attr.x,offsetY:L.attr.y-F.attr.y}))})}),S.moveComponentList(u)),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",g)}catch(C){console.log(C)}};document.addEventListener("mousemove",p),document.addEventListener("mouseup",g)},mouseenterHandle:(s,h)=>{s.preventDefault(),s.stopPropagation(),S.getEditCanvas.isSelect||S.setTargetHoverChart(h.id)},mouseleaveHandle:(s,h)=>{s.preventDefault(),s.stopPropagation(),S.setEditCanvas(ae.IS_DRAG,!1),S.setTargetHoverChart(void 0)}}),Ln=(e,n,t)=>{e.stopPropagation(),e.preventDefault(),S.setEditCanvas(ae.IS_DRAG,!0);const o=S.getEditCanvas.scale,s=t.x,h=t.y,c=t.w,w=t.h,m=e.screenX,v=e.screenY;S.setMousePosition(m,v);const _=Re.exports.throttle(a=>{S.setMousePosition(a.screenX,a.screenY);let u=Math.round((a.screenX-m)/o),p=Math.round((a.screenY-v)/o);const g=/t/.test(n),y=/b/.test(n),C=/l/.test(n),P=/r/.test(n),L=w+(g?-p:y?p:0),F=c+(C?-u:P?u:0);t.h=L>0?L:0,t.w=F>0?F:0,t.x=s+(C?u:0),t.y=h+(g?p:0)},50),f=()=>{S.setEditCanvas(ae.IS_DRAG,!1),S.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",f)};document.addEventListener("mousemove",_),document.addEventListener("mouseup",f)};const Mn=["onMousedown"],Bn=ue({__name:"index",props:{item:{type:Object,required:!0},hiddenPoint:{type:Boolean,required:!1}},setup(e){Ae(f=>({"026d39a0":c.value}));const n=e,t=ke(),o=re(),s=["t","r","b","l","lt","rt","lb","rb"],h=["n","e","s","w","nw","ne","sw","se"],c=H(()=>t.getAppTheme),w=H(()=>n.item.status.lock?!1:n.item.id===o.getTargetChart.hoverId),m=H(()=>{const f=n.item.id;return n.item.status.lock?!1:o.getTargetChart.selectId.find(a=>a===f)}),v=H(()=>n.item.status.lock),_=H(()=>n.item.status.hide);return(f,a)=>(T(),z("div",{class:ie(["go-shape-box",{lock:v.value,hide:_.value}])},[at(f.$slots,"default",{},void 0,!0),e.hiddenPoint?fe("",!0):(T(!0),z(ve,{key:0},me(m.value?s:[],(u,p)=>(T(),z("div",{class:ie(`shape-point ${u}`),key:p,style:oe(l(Yt)(u,p,e.item.attr,h)),onMousedown:g=>l(Ln)(g,u,e.item.attr)},null,46,Mn))),128)),W("div",{class:"shape-modal",style:oe(l(Ee)(e.item.attr))},[W("div",{class:ie(["shape-modal-select",{active:m.value}])},null,2),W("div",{class:ie(["shape-modal-change",{selectActive:m.value,hoverActive:w.value}])},null,2)],4)],2))}});var et=ce(Bn,[["__scopeId","data-v-5f8854aa"]]);const Rn={class:"go-edit-group-box"},In=ue({__name:"index",props:{groupData:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){const n=re(),{handleContextMenu:t}=ut(),{mouseenterHandle:o,mouseleaveHandle:s,mousedownHandle:h,mouseClickHandle:c}=Lt(),w=(_,f,a)=>{const u=p=>f.filter(g=>p.includes(g.key));if(n.getTargetChart.selectId.length>1)return u([x.GROUP,x.DELETE]);{const p=[];a.status.lock?p.push(x.LOCK):p.push(x.UNLOCK),a.status.hide?p.push(x.HIDE):p.push(x.SHOW);const g=[x.UN_GROUP];return[...u(g),vn(),..._.filter(y=>!p.includes(y.key))]}},m=H(()=>{const _=n.getEditCanvasConfig.chartThemeColor;return Et[_]}),v=H(()=>n.getEditCanvasConfig.chartThemeSetting);return(_,f)=>(T(),z("div",Rn,[(T(),U(l(et),{key:e.groupData.id,"data-id":e.groupData.id,index:e.groupIndex,item:e.groupData,hiddenPoint:!0,class:ie(l(Qe)(e.groupData.styles.animations)),style:oe(K(K(K(K(K({},l(Ie)(e.groupData.attr,e.groupIndex)),l(Ee)(e.groupData.attr)),l(He)(e.groupData.styles)),l(Ze)(e.groupData.styles)),l(Dt)(e.groupData.styles))),onClick:f[0]||(f[0]=a=>l(c)(a,e.groupData)),onMousedown:f[1]||(f[1]=a=>l(h)(a,e.groupData)),onMouseenter:f[2]||(f[2]=a=>l(o)(a,e.groupData)),onMouseleave:f[3]||(f[3]=a=>l(s)(a,e.groupData)),onContextmenu:f[4]||(f[4]=a=>l(t)(a,e.groupData,w))},{default:D(()=>[(T(!0),z(ve,null,me(e.groupData.groupList,a=>(T(),U(l(et),{key:a.id,"data-id":a.id,index:e.groupIndex,item:a,hiddenPoint:!0,style:oe(K({},l(Ie)(a.attr,e.groupIndex)))},{default:D(()=>[(T(),U(Ce(a.chartConfig.chartKey),{class:ie(["edit-content-chart",l(Qe)(a.styles.animations)]),chartConfig:a,themeSetting:v.value,themeColor:m.value,style:oe(K(K(K({},l(Ee)(a.attr)),l(He)(a.styles)),l(Ze)(a.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","item","style"]))),128))]),_:1},8,["data-id","index","item","class","style"]))]))}});const Hn={class:"go-edit-align-line"},Pn=ue({__name:"index",setup(e){Ae(p=>({42514545:c.value}));const n=ke(),t=re(),o=rt(),s=$e({lineArr:["rowt","rowc","rowb","coll","colc","colr"],select:new Map,sorptioned:{x:!1,y:!1}}),h=p=>p?{left:`${p.x?p.x:0}px`,top:`${p.y?p.y:0}px`}:{},c=H(()=>n.getAppTheme),w=H(()=>o.getChartAlignRange),m=H(()=>t.getEditCanvas[ae.IS_DRAG]),v=(p,g)=>Math.abs(p-g)<=w.value,_=H(()=>t.getTargetChart.selectId),f=H(()=>t.getComponentList[t.fetchTargetIndex()]),a=H(()=>{var p;return((p=f.value)==null?void 0:p.attr)||{}}),u=H(()=>({id:"0",attr:{w:dt(t.getEditCanvasConfig.width),h:dt(t.getEditCanvasConfig.height),x:0,y:0,offsetX:0,offsetY:0,zIndex:0}}));return pe(()=>t.getMousePosition,se(()=>{try{if(!m.value||_.value.length!==1)return;const p=a.value.w,g=a.value.h,y=a.value.x,C=y+p/2,P=y+p,L=[y,C,P],F=a.value.y,Y=F+g/2,X=F+g,q=[F,Y,X];s.select.clear(),s.sorptioned.y=!1;const $=t.getComponentList.map(i=>({id:i.id,attr:i.attr}));$.push(u.value),s.lineArr.forEach(i=>{$.forEach(b=>{if(_.value[0]===b.id)return;const E=b.attr.w,M=b.attr.h,I=b.attr.x,r=I+E/2,d=I+E,A=[I,r,d],k=b.attr.y,G=k+M/2,N=k+M,le=[k,G,N];i.includes("rowt")&&(v(F,k)&&(s.select.set(i,{y:k}),j(f.value,y,k)),v(F,G)&&(s.select.set(i,{y:G}),j(f.value,y,G)),v(F,N)&&(s.select.set(i,{y:N}),j(f.value,y,N))),i.includes("rowc")&&(v(Y,k)&&(s.select.set(i,{y:k}),j(f.value,y,k-g/2)),v(Y,G)&&(s.select.set(i,{y:G}),j(f.value,y,G-g/2)),v(Y,N)&&(s.select.set(i,{y:N}),j(f.value,y,N-g/2))),i.includes("rowb")&&(v(X,k)&&(s.select.set(i,{y:k}),j(f.value,y,k-g)),v(X,G)&&(s.select.set(i,{y:G}),j(f.value,y,G-g)),v(X,N)&&(s.select.set(i,{y:N}),j(f.value,y,N-g))),i.includes("coll")&&(v(y,I)&&(s.select.set(i,{x:I}),j(f.value,I,F)),v(y,r)&&(s.select.set(i,{x:r}),j(f.value,r,F)),v(y,d)&&(s.select.set(i,{x:d}),j(f.value,d,F))),i.includes("colc")&&(v(C,I)&&(s.select.set(i,{x:I}),j(f.value,I-p/2,F)),v(C,r)&&(s.select.set(i,{x:r}),j(f.value,r-p/2,F)),v(C,d)&&(s.select.set(i,{x:d}),j(f.value,d-p/2,F))),i.includes("colr")&&(v(P,I)&&(s.select.set(i,{x:I}),j(f.value,I-p,F)),v(P,r)&&(s.select.set(i,{x:r}),j(f.value,r-p,F)),v(P,d)&&(s.select.set(i,{x:d}),j(f.value,d-p,F)))})})}catch(p){console.log(p)}},200),{deep:!0}),pe(()=>m.value,p=>{p||(s.select.clear(),s.sorptioned.y=!1)}),(p,g)=>(T(),z("div",Hn,[(T(!0),z(ve,null,me(s.lineArr,y=>(T(),z("div",{class:ie(["line",[y.includes("row")?"row":"col",s.select.has(y)&&"visible"]]),key:y,style:oe(h(s.select.get(y)))},null,6))),128))]))}});var $n=ce(Pn,[["__scopeId","data-v-403a9eed"]]);const Un=ue({__name:"index",setup(e){return(n,t)=>{const o=R("n-watermark");return T(),U(o,{id:"go-edit-watermark",content:l(Zt),cross:"",selectable:"","font-size":16,"line-height":16,width:500,height:150,"x-offset":12,"y-offset":80,rotate:-15},null,8,["content"])}}});var Nn=ce(Un,[["__scopeId","data-v-e5cd93da"]]);const Mt=e=>(At("data-v-71d41248"),e=e(),kt(),e),Kn=Mt(()=>W("div",{class:"select-background"},null,-1)),Yn=Mt(()=>W("div",{class:"select-border"},null,-1)),Gn=[Kn,Yn],Xn=ue({__name:"index",setup(e){Ae(w=>({c29aca42:h.value}));const n=ke(),t=re(),{isSelect:o,scale:s}=Ue(t.getEditCanvas),h=H(()=>n.getAppTheme),c=Q();return pe(()=>t.getMousePosition,w=>{if(!o.value)return;const{startX:m,startY:v,x:_,y:f}=w,a={zIndex:ft,x:0,y:0,w:0,h:0,offsetX:0,offsetY:0};_>m&&f>v?(a.x=m,a.y=v,a.w=Math.round((_-m)/s.value),a.h=Math.round((f-v)/s.value)):_>m&&f<v?(a.x=m,a.w=Math.round((_-m)/s.value),a.h=Math.round((v-f)/s.value),a.y=v-a.h):_<m&&f>v?(a.y=v,a.w=Math.round((m-_)/s.value),a.h=Math.round((f-v)/s.value),a.x=m-a.w):(a.w=Math.round((m-_)/s.value),a.h=Math.round((v-f)/s.value),a.x=m-a.w,a.y=v-a.h),c.value=K(K({},Ie(a,ft)),Ee(a))},{deep:!0}),(w,m)=>l(o)?(T(),z("div",{key:0,class:"go-edit-select",style:oe(c.value)},Gn,4)):fe("",!0)}});var Wn=ce(Xn,[["__scopeId","data-v-71d41248"]]);const zn=ue({__name:"index",setup(e){const n=re(),{getEditCanvasConfig:t,getEditCanvas:o}=Ue(n),s=H(()=>({w:t.value.width,h:t.value.height})),h=H(()=>{const w={transform:`scale(${o.value.scale})`};return K(K({},Ee(s.value)),w)}),c=H(()=>{const w=o.value.isCreate&&{"z-index":99999};return K(K({},Ee(s.value)),w)});return(w,m)=>(T(),z("div",{class:"go-edit-range go-transition",style:oe(h.value),onMousedown:m[0]||(m[0]=v=>l(On)(v,void 0))},[at(w.$slots,"default",{},void 0,!0),O(l(Nn)),O(l($n)),O(l(Wn)),W("div",{class:"go-edit-range-model",style:oe(c.value)},null,4)],36))}});var jn=ce(zn,[["__scopeId","data-v-52e445d0"]]),Bt=!!(typeof window!="undefined"&&window.document&&window.document.createElement),tt=!1,nt=!1;try{var je={get passive(){return tt=!0},get once(){return nt=tt=!0}};Bt&&(window.addEventListener("test",je,je),window.removeEventListener("test",je,!0))}catch(e){}function qn(e,n,t,o){if(o&&typeof o!="boolean"&&!nt){var s=o.once,h=o.capture,c=t;!nt&&s&&(c=t.__once||function w(m){this.removeEventListener(n,w,h),t.call(this,m)},t.__once=c),e.addEventListener(n,c,tt?o:h)}e.addEventListener(n,t,o)}function Jn(e,n,t,o){var s=o&&typeof o!="boolean"?o.capture:o;e.removeEventListener(n,t,s),t.__once&&e.removeEventListener(n,t.__once,s)}function gt(e,n,t,o){return qn(e,n,t,o),function(){Jn(e,n,t,o)}}var _t=new Date().getTime();function Vn(e){var n=new Date().getTime(),t=Math.max(0,16-(n-_t)),o=setTimeout(e,t);return _t=n,o}var Qn=["","webkit","moz","o","ms"],mt=Vn,Ct=function(n,t){return n+(n?t[0].toUpperCase()+t.substr(1):t)+"AnimationFrame"};Bt&&Qn.some(function(e){var n=Ct(e,"request");return n in window&&(Ct(e,"cancel"),mt=function(o){return window[n](o)}),!!mt});Function.prototype.bind.call(Function.prototype.call,[].slice);Function.prototype.bind.call(Function.prototype.call,[].slice);const Zn={class:"go-sketch-rule"},es={key:1,class:"fix-edit-screens-block"},qe=20,ts=ue({__name:"index",setup(e){Ae(E=>({"6f694401":F.value,ed8dd9a8:P.value,"58b617f4":f.value}));const n=re(),t=Gt(),o=ke();let s=[0,0],h=[0,0];const c=Q(),w=Q(!0),m=Q(),v=Q(),_=Q(!1),f=Q("auto"),{width:a,height:u}=Ue(n.getEditCanvasConfig),p=Q(0),g=Q(0),y=$e({h:[],v:[]}),C=H(()=>n.getEditCanvas.scale),P=H(()=>`${u.value*2}px`),L=H(()=>o.getDarkTheme?{bgColor:"#18181c",longfgColor:"#4d4d4d",shortfgColor:"#4d4d4d",fontColor:"#4d4d4d",shadowColor:"#18181c",borderColor:"#18181c",cornerActiveColor:"#18181c"}:{}),F=H(()=>o.getAppTheme),Y=E=>{if(E.ctrlKey||E.metaKey){E.preventDefault();let M=C.value;if(E.wheelDelta>=0&&C.value<2){M=C.value+.05,n.setScale(M);return}E.wheelDelta<0&&C.value>.1&&(M=C.value-.05,n.setScale(M))}},X=()=>{if(!c.value)return;const E=c.value.getBoundingClientRect(),M=m.value.getBoundingClientRect();p.value=(E.left+qe-M.left)/C.value,g.value=(E.top+qe-M.top)/C.value},q=E=>{var A,k;if(E.preventDefault(),E.stopPropagation(),E.which==2)_.value=!0;else if(!((A=window.$KeyboardActive)!=null&&A.space))return;(k=document.activeElement)==null||k.blur();const M=E.pageX,I=E.pageY,r=gt(window,"mousemove",G=>{const N=G.pageX-M,le=G.pageY-I,[he,Fe]=s,[Ne,be]=h;s=[Fe,N],h=[be,le],c.value.scrollLeft-=Fe>he?Math.abs(Fe-he):-Math.abs(Fe-he),c.value.scrollTop-=be>Ne?Math.abs(be-Ne):-Math.abs(be-Ne)}),d=gt(window,"mouseup",()=>{r(),d(),s=[0,0],h=[0,0],_.value=!1})},$=()=>{const E=document.getElementById("go-chart-edit-layout");return E?{height:E.clientHeight-25,width:E.clientWidth}:{width:a.value,height:u.value}},i=()=>{w.value=!1,setTimeout(()=>{w.value=!0},10)},b=()=>{const{width:E,height:M}=v.value.getBoundingClientRect(),{width:I,height:r}=$();c.value.scrollLeft=E/2-I/2,c.value.scrollTop=M/2-r/2};return pe(()=>o.getDarkTheme,()=>{i()}),pe(()=>C.value,(E,M)=>{M!==E?(t.setItemUnHandle(Xt.RE_POSITION_CANVAS,!1),X(),setTimeout(()=>{b(),i()},400)):se(i,20)}),pe(()=>_.value,E=>{f.value=E?"grab":"auto"}),ot(()=>{c.value&&(c.value.addEventListener("wheel",Y,{passive:!1}),b())}),St(()=>{c.value&&c.value.removeEventListener("wheel",Y)}),window.onKeySpacePressHold=E=>{_.value=E},(E,M)=>{const I=R("sketch-rule");return T(),z("div",Zn,[w.value?(T(),U(I,{key:0,thick:qe,scale:C.value,width:$().width,height:$().height,startX:p.value,startY:g.value,lines:y,palette:L.value},null,8,["scale","width","height","startX","startY","lines","palette"])):fe("",!0),W("div",{ref_key:"$app",ref:c,class:"edit-screens",onScroll:X},[W("div",{ref_key:"$container",ref:v,class:"edit-screen-container",style:oe({width:l(a)*2+"px"})},[W("div",{ref_key:"refSketchRuleBox",ref:m,class:"canvas",onMousedown:q,style:oe({marginLeft:"-"+($().width/2-25)+"px"})},[W("div",{style:oe({pointerEvents:_.value?"none":"auto"})},[at(E.$slots,"default",{},void 0,!0)],4)],36)],4)],544),l(o).getDarkTheme?(T(),z("div",es)):fe("",!0)])}}});var ns=ce(ts,[["__scopeId","data-v-12b70182"]]);const Je={[B.ADD]:"\u65B0\u589E",[B.DELETE]:"\u5220\u9664",[B.UPDATE]:"\u66F4\u65B0",[B.MOVE]:"\u79FB\u52A8",[B.PASTE]:"\u7C98\u8D34",[B.COPY]:"\u590D\u5236",[B.CUT]:"\u526A\u5207",[B.TOP]:"\u7F6E\u9876",[B.BOTTOM]:"\u7F6E\u5E95",[B.UP]:"\u4E0A\u79FB",[B.DOWN]:"\u4E0B\u79FB",[B.GROUP]:"\u6210\u7EC4",[B.UN_GROUP]:"\u89E3\u7EC4",[B.LOCK]:"\u9501\u5B9A",[B.UNLOCK]:"\u89E3\u9501",[B.HIDE]:"\u9690\u85CF",[B.SHOW]:"\u663E\u793A",[Be.CANVAS]:"\u753B\u5E03\u521D\u59CB\u5316"};var ss=Array.prototype,os=ss.reverse;function as(e){return e==null?e:os.call(e)}var rs=as;const Rt=e=>(At("data-v-5a4fd660"),e=e(),kt(),e),us={class:"go-flex-items-center"},cs=Rt(()=>W("span",{class:"btn-text"},"\u5386\u53F2\u8BB0\u5F55",-1)),ls={class:"history-list-box"},is=["title"],ds=Rt(()=>W("div",{class:"popover-modal"},null,-1)),fs=ue({__name:"index",setup(e){const{DesktopOutlineIcon:n,PencilIcon:t,TrashIcon:o,CopyIcon:s,LayersIcon:h,DuplicateIcon:c,HelpOutlineIcon:w,LockClosedOutlineIcon:m,LockOpenOutlineIcon:v,EyeOffOutlineIcon:_,EyeOutlineIcon:f}=De.ionicons5,{StackedMoveIcon:a,Carbon3DCursorIcon:u,Carbon3DSoftwareIcon:p}=De.carbon,g=Wt(),y=L=>{if(L.targetType===Be.CANVAS)return n;switch(L.actionType){case B.UPDATE:return t;case B.DELETE:return o;case B.PASTE:return s;case B.TOP:return h;case B.BOTTOM:return h;case B.UP:return h;case B.DOWN:return h;case B.MOVE:return a;case B.ADD:return c;case B.GROUP:return u;case B.UN_GROUP:return p;case B.LOCK:return m;case B.UNLOCK:return v;case B.HIDE:return _;case B.SHOW:return f;default:return t}},C=L=>{if(L.targetType===Be.CANVAS)return Je[Be.CANVAS];if(L.actionType===B.GROUP||L.actionType===B.UN_GROUP)return`${Je[L.actionType]}`;if(L.historyData.length)return`${Je[L.actionType]} - ${L.historyData[0].chartConfig.title}`},P=H(()=>{const F=g.getBackStack.map(Y=>({label:C(Y),icon:y(Y)}));return rs(F.filter(Y=>Y.label))});return(L,F)=>{const Y=R("n-button"),X=R("n-icon"),q=R("n-text"),$=R("n-scrollbar"),i=R("n-popover"),b=R("n-tooltip");return T(),z("div",us,[O(i,{class:"edit-history-popover","show-arrow":!1,size:"small",trigger:"click",placement:"top-start"},{trigger:D(()=>[O(Y,{class:"mr-10",secondary:"",size:"small",disabled:P.value.length===0},{default:D(()=>[cs]),_:1},8,["disabled"])]),default:D(()=>[W("div",ls,[O($,{style:{"max-height":"500px"}},{default:D(()=>[(T(!0),z(ve,null,me(P.value,(E,M)=>(T(),z("div",{class:"list-item go-flex-items-center go-ellipsis-1",key:M,title:E.label},[O(X,{class:"item-icon",size:"16",depth:2,component:E.icon},null,8,["component"]),O(q,{depth:"2"},{default:D(()=>[ye(de(E.label),1)]),_:2},1024)],8,is))),128))]),_:1}),ds])]),_:1}),O(b,{trigger:"hover"},{trigger:D(()=>[O(X,{size:"21",depth:3},{default:D(()=>[O(l(w))]),_:1})]),default:D(()=>[W("span",null,"\u6700\u591A\u53EA\u4FDD\u7559"+de(l(en))+"\u6761\u8BB0\u5F55",1)]),_:1})])}}});var ps=ce(fs,[["__scopeId","data-v-5a4fd660"]]);const vs={class:"go-edit-bottom"},hs=ue({__name:"index",setup(e){Ae(y=>({f3add9fc:s.value}));const{LockClosedOutlineIcon:n,LockOpenOutlineIcon:t}=De.ionicons5,o=ke(),s=Q(o.getAppTheme),h=re(),{lockScale:c,scale:w}=Ue(h.getEditCanvas);let m=[{label:"200%",value:200},{label:"150%",value:150},{label:"100%",value:100},{label:"50%",value:50},{label:"\u81EA\u9002\u5E94",value:0}];const v=Q(""),_=y=>{if(y===0){h.computedScale();return}h.setScale(y/100)},f=()=>{h.setEditCanvas(ae.LOCK_SCALE,!c.value)},a=Q(100),u=y=>`${y}%`,p=y=>{h.setScale(y/100)},g=$e({100:""});return tn(()=>{const y=(w.value*100).toFixed(0);v.value=`${y}%`,a.value=parseInt(y)}),(y,C)=>{const P=R("n-text"),L=R("n-space"),F=R("n-select"),Y=R("n-icon"),X=R("n-button"),q=R("n-tooltip"),$=R("n-slider");return T(),z("div",vs,[O(L,null,{default:D(()=>[O(l(ps)),O(P,{id:"keyboard-dress-show",depth:"3"})]),_:1}),O(L,{class:"bottom-ri"},{default:D(()=>[O(Sn),O(F,{disabled:l(c),class:"scale-btn",value:v.value,"onUpdate:value":[C[0]||(C[0]=i=>v.value=i),_],size:"mini",options:l(m)},null,8,["disabled","value","options"]),O(q,{trigger:"hover"},{trigger:D(()=>[O(X,{onClick:f,text:""},{default:D(()=>[O(Y,{class:ie(["lock-icon",{color:l(c)}]),size:"18",depth:2},{default:D(()=>[l(c)?(T(),U(l(n),{key:0})):(T(),U(l(t),{key:1}))]),_:1},8,["class"])]),_:1})]),default:D(()=>[W("span",null,de(l(c)?"\u89E3\u9501":"\u9501\u5B9A")+"\u5F53\u524D\u6BD4\u4F8B",1)]),_:1}),O($,{class:"scale-slider",value:a.value,"onUpdate:value":[C[1]||(C[1]=i=>a.value=i),p],"default-value":50,min:10,max:200,step:5,"format-tooltip":u,disabled:l(c),marks:g},null,8,["value","disabled","marks"])]),_:1})])}}});var gs=ce(hs,[["__scopeId","data-v-99a534fc"]]);const _s=ue({__name:"index",props:{modelShow:Boolean},emits:["update:modelShow"],setup(e,{emit:n}){const t=e,o=n,{HelpOutlineIcon:s,CloseIcon:h}=De.ionicons5,c=rt(),w=Q(!1),m=$e([{key:ge.ASIDE_ALL_COLLAPSED,value:c.getAsideAllCollapsed,type:"switch",name:"\u83DC\u5355\u6298\u53E0",desc:"\u9996\u9875\u83DC\u5355\u6298\u53E0\u65F6\u9690\u85CF\u81F3\u754C\u9762\u5916"},{key:ge.HIDE_PACKAGE_ONE_CATEGORY,value:c.getHidePackageOneCategory,type:"switch",name:"\u9690\u85CF\u5206\u7C7B",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u8868\u5355\u5206\u7C7B\u53EA\u6709\u5355\u9879\u65F6\u9690\u85CF"},{key:ge.CHANGE_LANG_RELOAD,value:c.getChangeLangReload,type:"switch",name:"\u5207\u6362\u8BED\u8A00",desc:"\u5207\u6362\u8BED\u8A00\u91CD\u65B0\u52A0\u8F7D\u9875\u9762",tip:"\u82E5\u9047\u5230\u90E8\u5206\u533A\u57DF\u8BED\u8A00\u5207\u6362\u5931\u8D25\uFF0C\u5219\u5EFA\u8BAE\u5F00\u542F"},{key:"divider1",type:"divider",name:"",desc:"",value:""},{key:ge.CHART_TOOLS_STATUS_HIDE,value:c.getChartToolsStatusHide,type:"switch",name:"\u9690\u85CF\u5DE5\u5177\u680F",desc:"\u9F20\u6807\u79FB\u5165\u65F6\uFF0C\u4F1A\u5C55\u793A\u5207\u6362\u5230\u5C55\u5F00\u6A21\u5F0F"},{key:ge.CHART_TOOLS_STATUS,value:c.getChartToolsStatus,type:"select",name:"\u5DE5\u5177\u680F\u5C55\u793A",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u5DE5\u5177\u680F\u5C55\u793A\u65B9\u5F0F",options:[{label:"\u4FA7\u8FB9\u680F",value:Pe.ASIDE},{label:"\u5E95\u90E8 Dock",value:Pe.DOCK}]},{key:"divider0",type:"divider",name:"",desc:"",value:""},{key:ge.CHART_MOVE_DISTANCE,value:c.getChartMoveDistance,type:"number",name:"\u79FB\u52A8\u8DDD\u79BB",min:1,step:1,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u65B9\u5411\u952E\u63A7\u5236\u79FB\u52A8\u8DDD\u79BB"},{key:ge.CHART_ALIGN_RANGE,value:c.getChartAlignRange,type:"number",name:"\u5438\u9644\u8DDD\u79BB",min:10,step:2,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u79FB\u52A8\u56FE\u8868\u65F6\u7684\u5438\u9644\u8DDD\u79BB"}]);pe(()=>t.modelShow,f=>{w.value=f});const v=()=>{o("update:modelShow",!1)},_=(f,a)=>{c.setItem(a.key,a.value)};return(f,a)=>{const u=R("n-h3"),p=R("n-icon"),g=R("n-space"),y=R("n-divider"),C=R("n-text"),P=R("n-switch"),L=R("n-input-number"),F=R("n-select"),Y=R("n-tooltip"),X=R("n-list-item"),q=R("n-list"),$=R("n-modal");return T(),U($,{show:w.value,"onUpdate:show":a[0]||(a[0]=i=>w.value=i),onAfterLeave:v},{default:D(()=>[O(q,{bordered:"",class:"go-system-setting"},{header:D(()=>[O(g,{justify:"space-between"},{default:D(()=>[O(u,{class:"go-mb-0"},{default:D(()=>[ye("\u7CFB\u7EDF\u8BBE\u7F6E")]),_:1}),O(p,{size:"20",class:"go-cursor-pointer",onClick:v},{default:D(()=>[O(l(h))]),_:1})]),_:1})]),default:D(()=>[(T(!0),z(ve,null,me(m,i=>(T(),U(X,{key:i.key},{default:D(()=>[i.type==="divider"?(T(),U(y,{key:0,style:{margin:"0"}})):(T(),U(g,{key:1,size:40},{default:D(()=>[O(g,null,{default:D(()=>[O(C,{class:"item-left"},{default:D(()=>[ye(de(i.name),1)]),_:2},1024),i.type==="switch"?(T(),U(P,{key:0,value:i.value,"onUpdate:value":[b=>i.value=b,b=>_(b,i)],size:"small"},null,8,["value","onUpdate:value"])):i.type==="number"?(T(),U(L,{key:1,value:i.value,"onUpdate:value":[b=>i.value=b,b=>_(b,i)],class:"input-num-width",size:"small",step:i.step||null,suffix:i.suffix||null,min:i.min||0},null,8,["value","onUpdate:value","step","suffix","min"])):i.type==="select"?(T(),U(F,{key:2,class:"select-min-width",value:i.value,"onUpdate:value":[b=>i.value=b,b=>_(b,i)],size:"small",options:i.options},null,8,["value","onUpdate:value","options"])):fe("",!0)]),_:2},1024),O(g,null,{default:D(()=>[O(C,{class:"item-right"},{default:D(()=>[ye(de(i.desc),1)]),_:2},1024),i.tip?(T(),U(Y,{key:0,trigger:"hover"},{trigger:D(()=>[O(p,{size:"21"},{default:D(()=>[O(l(s))]),_:1})]),default:D(()=>[W("span",null,de(i.tip),1)]),_:2},1024)):fe("",!0)]),_:2},1024)]),_:2},1024))]),_:2},1024))),128))]),_:1})]),_:1},8,["show"])}}});var ms=ce(_s,[["__scopeId","data-v-7cea0aa5"]]);const xe=re(),Cs=()=>{xe.setTargetSelectChart(void 0),nn(sn(xe.getStorageInfo||[]),void 0,"json");const e=document.querySelector(".go-edit-range"),n=document.getElementById("go-edit-watermark");if(!e||!n){window.$message.error("\u5BFC\u51FA\u5931\u8D25\uFF01");return}const t=xe.getEditCanvas.scale;xe.setScale(1,!0),n.style.display="block",setTimeout(()=>{on(e,()=>{n&&(n.style.display="none"),xe.setScale(t,!0)})},600)};var st=(e=>(e.TXT="text/plain",e.JSON="application/json",e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e))(st||{});const ys=()=>{const e=Q(),{updateComponent:n}=wt();return{importUploadFileListRef:e,importBeforeUpload:({file:s})=>{e.value=[];const h=s.file.type;return h!==st.JSON&&h!==st.TXT?(window.$message.warning("\u4EC5\u652F\u6301\u4E0A\u4F20 \u3010JSON\u3011 \u683C\u5F0F\u6587\u4EF6\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20\uFF01"),!1):!0},importCustomRequest:s=>{const{file:h}=s;an(()=>{h.file?rn(h.file).then(c=>{_n({message:"\u8BF7\u9009\u62E9\u5BFC\u5165\u65B9\u5F0F:",positiveText:"\u65B0\u589E\uFF08\u53EF\u64A4\u56DE\uFF09",negativeText:"\u8986\u76D6\uFF08\u4E0D\u53EF\u64A4\u56DE\uFF09",negativeButtonProps:{type:"info",ghost:!1},onPositiveCallback:()=>Se(void 0,null,function*(){try{c=Ve(c),yield n(c,!1,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(w){console.log(w),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}}),onNegativeCallback:()=>Se(void 0,null,function*(){try{c=Ve(c),yield n(c,!0,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(w){console.log(w),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}})})}):window.$message.error("\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u6216\u8054\u7CFB\u7BA1\u7406\u5458\uFF01")})}}},{updateComponent:Es,dataSyncUpdate:yt}=wt(),ws=re(),Ss=()=>{const e=h=>Es(h.detail,!0,!1),n=()=>Se(void 0,null,function*(){yt&&(yield yt()),dispatchEvent(new CustomEvent(Ge.CHART,{detail:ws.getStorageInfo}))}),t=()=>{addEventListener("blur",n),addEventListener(Ge.JSON,e)},o=()=>{removeEventListener(Ge.JSON,e),removeEventListener("blur",n)};return(h,c)=>{c==pt.CHART_HOME_NAME&&o(),h==pt.CHART_HOME_NAME&&t()}},Ts=()=>{const e=Ft();pe(()=>e.name,Ss(),{immediate:!0})};var _e=(e=>(e.BUTTON="button",e.IMPORTUPLOAD="importUpload",e))(_e||{});const xs={class:"btn-item"},Ds=ue({__name:"index",setup(e){const{DownloadIcon:n,ShareIcon:t,PawIcon:o,SettingsSharpIcon:s,CreateIcon:h}=De.ionicons5,c=rt(),w=re();Ft(),Ts();let m=null;const v=Q(!1),_=Q(!0),f=Q(!0),{importUploadFileListRef:a,importCustomRequest:u,importBeforeUpload:p}=ys(),g=H(()=>c.getChartToolsStatus===Pe.ASIDE),y=H(()=>c.getChartToolsStatusHide),C=H(()=>_.value&&y.value),P=H(()=>{if(!g.value)return q;const $=[];return q.map(i=>{$.unshift(i)}),$}),L=()=>{m=setTimeout(()=>{_.value&&(_.value=!1,f.value=!0)},200),setTimeout(()=>{f.value=!1},400)},F=()=>{clearTimeout(m),_.value||(_.value=!0)},Y=()=>{window.$message.warning("\u5C06\u5F00\u542F\u5931\u7126\u66F4\u65B0\uFF01"),setTimeout(()=>{const $=cn(ln.CHART_EDIT_NAME,"href");if(!$)return;const i=dn();X(i),fn($,[i],void 0,!0)},1e3)},X=$=>{const i=w.getStorageInfo,b=pn(Oe.GO_CHART_STORAGE_LIST)||[];if(b!=null&&b.length){const E=b.findIndex(M=>M.id===$);E!==-1?(b.splice(E,1,we(K({},i),{id:$})),ze(Oe.GO_CHART_STORAGE_LIST,b)):(b.push(we(K({},i),{id:$})),ze(Oe.GO_CHART_STORAGE_LIST,b))}else ze(Oe.GO_CHART_STORAGE_LIST,[we(K({},i),{id:$})])},q=[{key:"import",type:_e.IMPORTUPLOAD,name:"\u5BFC\u5165",icon:t},{key:"export",type:_e.BUTTON,name:"\u5BFC\u51FA",icon:n,handle:Cs},{key:"edit",type:_e.BUTTON,name:"\u7F16\u8F91",icon:h,handle:Y},{key:"setting",type:_e.BUTTON,name:"\u8BBE\u7F6E",icon:s,handle:()=>{v.value=!0}}];return($,i)=>{const b=R("n-icon"),E=R("n-text"),M=R("n-button"),I=R("n-upload"),r=R("n-tooltip");return T(),z(ve,null,[W("div",{class:ie(["go-chart-edit-tools",[l(c).getChartToolsStatus,C.value?"isMini":"unMini"]]),onClick:i[1]||(i[1]=d=>_.value&&(_.value=!1)),onMouseenter:L,onMouseleave:F},[Xe(O(b,{class:"asideLogo",size:"22"},{default:D(()=>[O(l(o))]),_:1},512),[[We,l(c).getChartToolsStatus===l(Pe).ASIDE&&C.value]]),(T(!0),z(ve,null,me(P.value,(d,A)=>(T(),U(r,{key:d.key,disabled:!g.value||y.value&&f.value,trigger:"hover",placement:"left"},{trigger:D(()=>[W("div",xs,[d.type===l(_e).BUTTON?(T(),U(M,{key:0,circle:g.value,secondary:"",onClick:d.handle},{icon:D(()=>[g.value?(T(),U(b,{key:0,size:"22"},{default:D(()=>[(T(),U(Ce(d.icon)))]),_:2},1024)):(T(),U(Ce(d.icon),{key:1}))]),default:D(()=>[Xe(O(E,{depth:"3"},{default:D(()=>[ye(de(d.name),1)]),_:2},1536),[[We,!g.value]])]),_:2},1032,["circle","onClick"])):d.type===l(_e).IMPORTUPLOAD?(T(),U(I,{key:1,"file-list":l(a),"onUpdate:fileList":i[0]||(i[0]=k=>un(a)?a.value=k:null),"show-file-list":!1,customRequest:l(u),onBeforeUpload:l(p)},{default:D(()=>[O(M,{circle:g.value,secondary:""},{icon:D(()=>[g.value?(T(),U(b,{key:0,size:"22"},{default:D(()=>[(T(),U(Ce(d.icon)))]),_:2},1024)):(T(),U(Ce(d.icon),{key:1}))]),default:D(()=>[Xe(O(E,{depth:"3"},{default:D(()=>[ye(de(d.name),1)]),_:2},1536),[[We,!g.value]])]),_:2},1032,["circle"])]),_:2},1032,["file-list","customRequest","onBeforeUpload"])):fe("",!0)])]),default:D(()=>[W("span",null,de(d.name),1)]),_:2},1032,["disabled"]))),128))],34),O(l(ms),{modelShow:v.value,"onUpdate:modelShow":i[2]||(i[2]=d=>v.value=d)},null,8,["modelShow"])],64)}}});var As=ce(Ds,[["__scopeId","data-v-4c257f27"]]);const ks=ue({__name:"index",setup(e){const n=re(),{handleContextMenu:t}=ut();Tn();const{mouseenterHandle:o,mouseleaveHandle:s,mousedownHandle:h,mouseClickHandle:c}=Lt(),w=(f,a,u)=>{if(n.getTargetChart.selectId.length>1)return a.filter(g=>[x.GROUP,x.DELETE].includes(g.key));const p=[];return u.status.lock?p.push(x.LOCK):p.push(x.UNLOCK),u.status.hide?p.push(x.HIDE):p.push(x.SHOW),f.filter(g=>!p.includes(g.key))},m=H(()=>n.getEditCanvasConfig.chartThemeSetting),v=H(()=>{const f=n.getEditCanvasConfig.chartThemeColor;return Et[f]});H(()=>n.getEditCanvasConfig.filterShow);const _=H(()=>{const f=n.getEditCanvasConfig.background,a=n.getEditCanvasConfig.backgroundImage,g=n.getEditCanvasConfig.selectColor?{background:f||void 0}:{background:`url(${a}) no-repeat center center / cover !important`};return we(K({},g),{width:"inherit",height:"inherit"})});return ot(()=>{kn()}),(f,a)=>(T(),U(l(wn),{id:"go-chart-edit-layout",flex:!0,showTop:!1,showBottom:!0,depth:1,xScroll:!0,disabledScroll:!0,onMousedown:l(Ot),onDrop:l(bn),onDragover:l(ht),onDragenter:l(ht)},{aside:D(()=>[O(l(As))]),bottom:D(()=>[O(l(gs))]),default:D(()=>[O(l(ns),null,{default:D(()=>[W("div",{id:"go-chart-edit-content",onContextmenu:a[0]||(a[0]=(...u)=>l(t)&&l(t)(...u))},[O(l(jn),null,{default:D(()=>[W("div",{style:oe(K(K({},l(He)(l(n).getEditCanvasConfig)),_.value))},[(T(!0),z(ve,null,me(l(n).getComponentList,(u,p)=>(T(),z("div",{key:u.id},[u.isGroup?(T(),U(l(In),{key:0,groupData:u,groupIndex:p},null,8,["groupData","groupIndex"])):(T(),U(l(et),{key:1,"data-id":u.id,index:p,style:oe(K(K({},l(Ie)(u.attr,p)),l(Dt)(u.styles))),item:u,onClick:g=>l(c)(g,u),onMousedown:g=>l(h)(g,u),onMouseenter:g=>l(o)(g,u),onMouseleave:g=>l(s)(g,u),onContextmenu:g=>l(t)(g,u,w)},{default:D(()=>{var g,y,C;return[l(mn)(u)?(T(),U(l(zt),{key:0,title:u.chartConfig.package=="Charts"&&(C=(y=(g=u.option)==null?void 0:g.title)==null?void 0:y.text)!=null?C:u.chartConfig.title,attr:u.attr},null,8,["title","attr"])):fe("",!0),l(Cn)(u)?(T(),U(l(jt),{key:1,class:"filter-content",componentIdx:u.id,attr:u.attr,filters:u.chartConfig.filters,type:u.chartConfig.category},null,8,["componentIdx","attr","filters","type"])):fe("",!0),(T(),U(Ce(u.chartConfig.chartKey),{class:ie(["edit-content-chart",l(Qe)(u.styles.animations)]),chartConfig:u,themeSetting:m.value,themeColor:v.value,style:oe(K(K(K({},l(qt)(u.attr,l(yn)(u)+l(En)(u))),l(He)(u.styles)),l(Ze)(u.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]}),_:2},1032,["data-id","index","style","item","onClick","onMousedown","onMouseenter","onMouseleave","onContextmenu"]))]))),128))],4)]),_:1})],32)]),_:1})]),_:1},8,["onMousedown","onDrop","onDragover","onDragenter"]))}});var Ns=ce(ks,[["__scopeId","data-v-39434ad2"]]);export{Ns as default};
