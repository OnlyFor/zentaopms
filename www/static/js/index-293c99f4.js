var Ht=Object.defineProperty,Pt=Object.defineProperties;var $t=Object.getOwnPropertyDescriptors;var ct=Object.getOwnPropertySymbols;var Ut=Object.prototype.hasOwnProperty,Nt=Object.prototype.propertyIsEnumerable;var lt=(e,n,t)=>n in e?Ht(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Y=(e,n)=>{for(var t in n||(n={}))Ut.call(n,t)&&lt(e,t,n[t]);if(ct)for(var t of ct(n))Nt.call(n,t)&&lt(e,t,n[t]);return e},me=(e,n)=>Pt(e,$t(n));var we=(e,n,t)=>new Promise((a,o)=>{var f=C=>{try{y(t.next(C))}catch(p){o(p)}},h=C=>{try{y(t.throw(C))}catch(p){o(p)}},y=C=>C.done?a(C.value):Promise.resolve(C.value).then(f,h);y((t=t.apply(e,n)).next())});import{u as re,E as ae,t as oe,q as Ye,r as Kt,o as Yt,s as Be,v as Gt,w as ye,c as St,x as Ie,g as Xt,C as Wt,H as B,y as Re,a as zt,b as wt,O as jt,F as qt,z as it}from"./useSync.hook-114141c3.js";import{x as ot,a6 as Tt,aJ as Jt,ah as D,c6 as xt,c7 as Dt,cm as dt,cl as Vt,c3 as Ve,cn as j,cb as Ge,ai as Qt,j as le,d as ue,bG as Ae,f as s,u as ke,a5 as H,o as w,m as z,n as at,F as he,A as _e,ad as de,aQ as ne,ab as ce,z as W,c as $,w as A,L as Ce,bT as Qe,bU as He,bV as Ze,bW as At,a4 as rt,y as $e,aj as ft,R as pe,r as I,co as Zt,a3 as Ue,v as Q,cp as pt,D as kt,E as Ft,e as L,p as Ee,t as fe,aI as en,aS as tn,cq as ve,cr as Pe,cs as nn,c2 as sn,ct as on,ak as an,cu as rn,J as bt,Q as ht,b_ as Xe,X as We,Y as ze,bQ as un,V as cn,cv as ln,cw as dn,W as fn,bR as pn,S as Oe,b$ as je}from"./index.js";import{u as ut,d as hn}from"./index-63c94ef9.js";import{a as vn,b as vt,l as gn,g as _n}from"./plugin-6e324e47.js";import{i as mn,g as Cn,a as yn,b as En,h as Sn,N as wn,o as Tn,f as xn}from"./useItem.hook-595216f7.js";import{C as Dn}from"./index-72666235.js";import{i as De}from"./icon-79c2a230.js";import{E as An}from"./index-84b59c3a.js";import"./tables_list-992ce806.js";import"./index-2885ec2e.js";import"./index-a1cbde0b.js";const Te=re(),kn=()=>{ot(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,document.getElementById("go-chart-edit-layout")),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,document.getElementById("go-chart-edit-content"));const e=Te.listenerScale();Tt(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,null),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,null),e()})})};var Ot={exports:{}};(function(e){(function(n){var t,a={},o={16:!1,18:!1,17:!1,91:!1},f="all",h={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},y={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},C=function(r){return y[r]||r.toUpperCase().charCodeAt(0)},p=[];for(t=1;t<20;t++)y["f"+t]=111+t;function _(r,l){for(var k=r.length;k--;)if(r[k]===l)return k;return-1}function i(r,l){if(r.length!=l.length)return!1;for(var k=0;k<r.length;k++)if(r[k]!==l[k])return!1;return!0}var c={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function u(r){for(t in o)o[t]=r[c[t]]}function d(r){var l,k,F,X,N,ie;if(l=r.keyCode,_(p,l)==-1&&p.push(l),(l==93||l==224)&&(l=91),l in o){o[l]=!0;for(F in h)h[F]==l&&(E[F]=!0);return}if(u(r),!!E.filter.call(this,r)&&l in a){for(ie=q(),X=0;X<a[l].length;X++)if(k=a[l][X],k.scope==ie||k.scope=="all"){N=k.mods.length>0;for(F in o)(!o[F]&&_(k.mods,+F)>-1||o[F]&&_(k.mods,+F)==-1)&&(N=!1);(k.mods.length==0&&!o[16]&&!o[18]&&!o[17]&&!o[91]||N)&&k.method(r,k)===!1&&(r.preventDefault?r.preventDefault():r.returnValue=!1,r.stopPropagation&&r.stopPropagation(),r.cancelBubble&&(r.cancelBubble=!0))}}}function g(r){var l=r.keyCode,k,F=_(p,l);if(F>=0&&p.splice(F,1),(l==93||l==224)&&(l=91),l in o){o[l]=!1;for(k in h)h[k]==l&&(E[k]=!1)}}function m(){for(t in o)o[t]=!1;for(t in h)E[t]=!1}function E(r,l,k){var F,X;F=v(r),k===void 0&&(k=l,l="all");for(var N=0;N<F.length;N++)X=[],r=F[N].split("+"),r.length>1&&(X=P(r),r=[r[r.length-1]]),r=r[0],r=C(r),r in a||(a[r]=[]),a[r].push({shortcut:F[N],scope:l,method:k,key:F[N],mods:X})}function O(r,l){var k,F,X=[],N,ie,Se;for(k=v(r),ie=0;ie<k.length;ie++){if(F=k[ie].split("+"),F.length>1&&(X=P(F),r=F[F.length-1]),r=C(r),l===void 0&&(l=q()),!a[r])return;for(N=0;N<a[r].length;N++)Se=a[r][N],Se.scope===l&&i(Se.mods,X)&&(a[r][N]={})}}function M(r){return typeof r=="string"&&(r=C(r)),_(p,r)!=-1}function b(){return p.slice(0)}function U(r){var l=(r.target||r.srcElement).tagName;return!(l=="INPUT"||l=="SELECT"||l=="TEXTAREA")}for(t in h)E[t]=!1;function G(r){f=r||"all"}function q(){return f||"all"}function x(r){var l,k,F;for(l in a)for(k=a[l],F=0;F<k.length;)k[F].scope===r?k.splice(F,1):F++}function v(r){var l;return r=r.replace(/\s/g,""),l=r.split(","),l[l.length-1]==""&&(l[l.length-2]+=","),l}function P(r){for(var l=r.slice(0,r.length-1),k=0;k<l.length;k++)l[k]=h[l[k]];return l}function K(r,l,k){r.addEventListener?r.addEventListener(l,k,!1):r.attachEvent&&r.attachEvent("on"+l,function(){k(window.event)})}K(document,"keydown",function(r){d(r)}),K(document,"keyup",g),K(window,"focus",m);var T=n.key;function R(){var r=n.key;return n.key=T,r}n.key=E,n.key.setScope=G,n.key.getScope=q,n.key.deleteScope=x,n.key.filter=U,n.key.isPressed=M,n.key.getPressedKeyCodes=b,n.key.noConflict=R,n.key.unbind=O,e.exports=E})(Jt)})(Ot);var Z=Ot.exports;const ee=re(),se=e=>`${xt.CTRL}+${e}`,Le=e=>`${xt.SHIFT}+${e}`,J={[D.ARROW_UP]:se("up"),[D.ARROW_RIGHT]:se("right"),[D.ARROW_DOWN]:se("down"),[D.ARROW_LEFT]:se("left"),[D.COPY]:se("c"),[D.CUT]:se("x"),[D.PARSE]:se("v"),[D.DELETE]:"delete",[D.BACK]:se("z"),[D.FORWORD]:se(Le("z")),[D.GROUP]:se("g"),[D.UN_GROUP]:se(Le("g")),[D.LOCK]:se("l"),[D.UNLOCK]:se(Le("l")),[D.HIDE]:se("h"),[D.SHOW]:se(Le("h"))},te=e=>`${Dt.CTRL}+${e}`,Me=e=>`${Dt.SHIFT}+${e}`,V={[D.ARROW_UP]:te("arrowup"),[D.ARROW_RIGHT]:te("arrowright"),[D.ARROW_DOWN]:te("arrowdown"),[D.ARROW_LEFT]:te("arrowleft"),[D.COPY]:te("c"),[D.CUT]:te("x"),[D.PARSE]:te("v"),[D.DELETE]:te("backspace"),[D.BACK]:te("z"),[D.FORWORD]:te(Me("z")),[D.GROUP]:te("g"),[D.UN_GROUP]:te(Me("g")),[D.LOCK]:te("l"),[D.UNLOCK]:te(Me("l")),[D.HIDE]:te("h"),[D.SHOW]:te(Me("h"))},Fn=[J.up,J.right,J.down,J.left,J.delete,J.copy,J.cut,J.parse,J.back,J.forward,J.group,J.unGroup,J.lock,J.unLock,J.hide,J.show],bn=[V.up,V.right,V.down,V.left,V.delete,V.copy,V.cut,V.parse,V.back,V.forward,V.group,V.unGroup,V.lock,V.unLock,V.hide,V.show],On=()=>{window.$KeyboardActive={ctrl:!1,space:!1},document.onkeydown=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(dt(e.keyCode),n){case 17:window.$KeyboardActive.ctrl=!0;break;case 32:window.$KeyboardActive.space=!0;break}},document.onkeyup=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(dt(),n){case 17:window.$KeyboardActive.ctrl=!1;break;case 32:window.$KeyboardActive.space=!1;break}}},Ln=()=>{const n=(t,a)=>{switch(a){case t.up:Z(a,oe(()=>(ee.setMove(D.ARROW_UP),!1),50));break;case t.right:Z(a,oe(()=>(ee.setMove(D.ARROW_RIGHT),!1),50));break;case t.down:Z(a,oe(()=>(ee.setMove(D.ARROW_DOWN),!1),50));break;case t.left:Z(a,oe(()=>(ee.setMove(D.ARROW_LEFT),!1),50));break;case t.delete:Z(a,Ye(()=>(ee.removeComponentList(),!1),50));break;case t.copy:Z(a,Ye(()=>(ee.setCopy(),!1),50));break;case t.cut:Z(a,Ye(()=>(ee.setCut(),!1),50));break;case t.parse:Z(a,oe(()=>(ee.setParse(),!1),50));break;case t.back:Z(a,oe(()=>(ee.setBack(),!1),50));break;case t.forward:Z(a,oe(()=>(ee.setForward(),!1),50));break;case t.group:Z(a,oe(()=>(ee.setGroup(),!1),50));break;case t.unGroup:Z(a,oe(()=>(ee.setUnGroup(),!1),50));break;case t.lock:Z(a,oe(()=>(ee.setLock(),!1),50));break;case t.unLock:Z(a,oe(()=>(ee.setUnLock(),!1),50));break;case t.hide:Z(a,oe(()=>(ee.setHide(),!1),50));break;case t.show:Z(a,oe(()=>(ee.setShow(),!1),50));break}};Fn.forEach(t=>{n(J,t)}),bn.forEach(t=>{n(V,t)}),On()},S=re(),{onClickOutSide:Mn}=ut(),Rn=e=>we(void 0,null,function*(){e.preventDefault();try{vn();const n=e.dataTransfer.getData(Vt.DRAG_KEY);if(!n){vt();return}S.setEditCanvas(ae.IS_CREATE,!1);const t=Ve(n);let a;if(t.sourceID){let f=yield Kt(t.sourceID,t.category);if(!f){window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...");return}a=f.chartConfig}else a=t;let o=yield Yt(a);j(o,e.offsetX-o.attr.w/2,e.offsetY-o.attr.h/2),S.addComponentList(o,!1,!0),S.setTargetSelectChart(o.id),vt()}catch(n){gn(),window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...")}}),gt=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")},Lt=(e,n)=>{if(n){S.setTargetSelectChart(n.id);return}S.setTargetSelectChart(void 0)},Bn=(e,n)=>{var p;if(e.which==2||(p=window.$KeyboardActive)!=null&&p.space)return;Lt();const t=e.offsetX,a=e.offsetY,o=e.screenX,f=e.screenY,h=S.getEditCanvas.scale;S.setMousePosition(void 0,void 0,t,a);const y=Be.exports.throttle(_=>{S.setTargetSelectChart(),S.setEditCanvas(ae.IS_SELECT,!0);const i=t+_.screenX-o,c=a+_.screenY-f;S.setMousePosition(i,c);const u={x1:0,y1:0,x2:0,y2:0};i>t&&c>a?(u.x1=t,u.y1=a,u.x2=Math.round(t+(_.screenX-o)/h),u.y2=Math.round(a+(_.screenY-f)/h)):i>t&&c<a?(u.x1=t,u.y1=Math.round(a-(f-_.screenY)/h),u.x2=Math.round(t+(_.screenX-o)/h),u.y2=a):i<t&&c>a?(u.x1=Math.round(t-(o-_.screenX)/h),u.y1=a,u.x2=t,u.y2=Math.round(a+(_.screenY-f)/h)):(u.x1=Math.round(t-(o-_.screenX)/h),u.y1=Math.round(a-(f-_.screenY)/h),u.x2=t,u.y2=a),S.getComponentList.forEach(d=>{if(!S.getTargetChart.selectId.includes(d.id)){const{x:g,y:m,w:E,h:O}=d.attr,M={x1:g,y1:m,x2:g+E,y2:m+O};M.x1-u.x1>=0&&M.y1-u.y1>=0&&M.x2-u.x2<=0&&M.y2-u.y2<=0&&!d.status.lock&&!d.status.hide&&S.setTargetSelectChart(d.id,!0)}})},30),C=()=>{y.cancel(),S.setEditCanvas(ae.IS_SELECT,!1),S.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",C)};document.addEventListener("mousemove",y),document.addEventListener("mouseup",C)},Mt=()=>({mouseClickHandle:(o,f)=>{var h;if(o.preventDefault(),o.stopPropagation(),!f.status.lock&&(h=window.$KeyboardActive)!=null&&h.ctrl)if(S.targetChart.selectId.includes(f.id)){const y=S.targetChart.selectId.filter(C=>C!==f.id);S.setTargetSelectChart(y)}else S.setTargetSelectChart(f.id,!0)},mousedownHandle:(o,f)=>{var m;if(o.preventDefault(),o.stopPropagation(),f.status.lock||(Mn(),o.buttons===Ge.LEFT&&((m=window.$KeyboardActive)==null?void 0:m.ctrl)))return;const h=S.getTargetChart.selectId;if(o.buttons===Ge.RIGHT&&h.length>1&&h.includes(f.id)||(S.setTargetSelectChart(f.id),o.buttons===Ge.RIGHT))return;const y=S.getEditCanvas.scale,C=S.getEditCanvasConfig.width,p=S.getEditCanvasConfig.height,_=new Map;S.getTargetChart.selectId.forEach(E=>{const O=S.fetchTargetIndex(E);if(O!==-1){const{x:M,y:b,w:U,h:G}=Qt(S.getComponentList[O]).attr;_.set(E,{x:M,y:b,w:U,h:G})}});const i=o.screenX,c=o.screenY;let u=[];S.getTargetChart.selectId.forEach(E=>{if(!_.has(E))return;const O=S.fetchTargetIndex(E);u.push(Be.exports.cloneDeep(S.getComponentList[O]))}),S.setMousePosition(void 0,void 0,i,c);const d=Be.exports.throttle(E=>{S.setEditCanvas(ae.IS_DRAG,!0),S.setMousePosition(E.screenX,E.screenY);let O=(E.screenX-i)/y,M=(E.screenY-c)/y;S.getTargetChart.selectId.forEach(b=>{if(!_.has(b))return;const U=S.fetchTargetIndex(b),{x:G,y:q,w:x,h:v}=_.get(b),P=S.getComponentList[U];let K=Math.round(G+O),T=Math.round(q+M);const R=50;K=K<-x+R?-x+R:K,T=T<-v+R?-v+R:T,K=K>C-R?C-R:K,T=T>p-R?p-R:T,P&&!Number.isNaN(K)&&!Number.isNaN(T)&&(P.attr=Object.assign(P.attr,{x:K,y:T}))})},20),g=()=>{try{S.setMousePosition(0,0,0,0),S.setEditCanvas(ae.IS_DRAG,!1),u.length&&(S.getTargetChart.selectId.forEach(E=>{if(!_.has(E))return;const O=S.fetchTargetIndex(E),M=S.getComponentList[O];u.forEach(b=>{b.id===E&&(b.attr=Object.assign(b.attr,{offsetX:M.attr.x-b.attr.x,offsetY:M.attr.y-b.attr.y}))})}),S.moveComponentList(u)),document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",g)}catch(E){console.log(E)}};document.addEventListener("mousemove",d),document.addEventListener("mouseup",g)},mouseenterHandle:(o,f)=>{o.preventDefault(),o.stopPropagation(),S.getEditCanvas.isSelect||S.setTargetHoverChart(f.id)},mouseleaveHandle:(o,f)=>{o.preventDefault(),o.stopPropagation(),S.setEditCanvas(ae.IS_DRAG,!1),S.setTargetHoverChart(void 0)}}),In=(e,n,t)=>{e.stopPropagation(),e.preventDefault(),S.setEditCanvas(ae.IS_DRAG,!0);const a=S.getEditCanvas.scale,o=t.x,f=t.y,h=t.w,y=t.h,C=t.lockScale,p=t.scaleRatio,_=e.screenX,i=e.screenY;S.setMousePosition(_,i);const c=Be.exports.throttle(d=>{S.setMousePosition(d.screenX,d.screenY);let g=Math.round((d.screenX-_)/a),m=Math.round((d.screenY-i)/a);const E=/t/.test(n),O=/b/.test(n),M=/l/.test(n),b=/r/.test(n);let U=y+(E?-m:O?m:0),G=h+(M?-g:b?g:0);C&&((E||O)&&(G=Math.round(U*p)),(M||b)&&(U=Math.round(G/p))),t.h=U>0?U:0,t.w=G>0?G:0,t.x=o+(M?g:0),t.y=f+(E?m:0)},50),u=()=>{S.setEditCanvas(ae.IS_DRAG,!1),S.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",u)};document.addEventListener("mousemove",c),document.addEventListener("mouseup",u)};const Hn=["onMousedown"],Pn=ue({__name:"index",props:{item:{type:Object,required:!0},hiddenPoint:{type:Boolean,required:!1}},setup(e){const n=e;Ae(c=>({59251946:s(y)}));const t=ke(),a=re(),o=["t","r","b","l","lt","rt","lb","rb"],f=H(()=>n.item.attr.disabledHeight?["r","l"]:o),h=["n","e","s","w","nw","ne","sw","se"],y=H(()=>t.getAppTheme),C=H(()=>n.item.status.lock?!1:n.item.id===a.getTargetChart.hoverId),p=H(()=>{const c=n.item.id;return n.item.status.lock?!1:a.getTargetChart.selectId.find(u=>u===c)}),_=H(()=>n.item.status.lock),i=H(()=>n.item.status.hide);return(c,u)=>(w(),z("div",{class:de(["go-shape-box",{lock:s(_),hide:s(i)}])},[at(c.$slots,"default",{},void 0,!0),e.hiddenPoint?ce("",!0):(w(!0),z(he,{key:0},_e(s(p)?s(f):[],(d,g)=>(w(),z("div",{class:de(`shape-point ${d}`),key:g,style:ne(s(Gt)(d,g,e.item.attr,h)),onMousedown:m=>s(In)(m,d,e.item.attr)},null,46,Hn))),128)),W("div",{class:"shape-modal",style:ne(s(ye)(e.item.attr))},[W("div",{class:de(["shape-modal-select",{active:s(p)}])},null,2),W("div",{class:de(["shape-modal-change",{selectActive:s(p),hoverActive:s(C)}])},null,2)],4)],2))}});var et=le(Pn,[["__scopeId","data-v-5d701d3e"]]);const $n={class:"go-edit-group-box"},Un=ue({__name:"index",props:{groupData:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){const n=re(),{handleContextMenu:t}=ut(),{mouseenterHandle:a,mouseleaveHandle:o,mousedownHandle:f,mouseClickHandle:h}=Mt(),y=(_,i,c)=>{const u=d=>i.filter(g=>d.includes(g.key));if(n.getTargetChart.selectId.length>1)return u([D.GROUP,D.DELETE]);{const d=[];c.status.lock?d.push(D.LOCK):d.push(D.UNLOCK),c.status.hide?d.push(D.HIDE):d.push(D.SHOW);const g=[D.UN_GROUP];return[...u(g),hn(),..._.filter(m=>!d.includes(m.key))]}},C=H(()=>{const _=n.getEditCanvasConfig.chartThemeColor;return St[_]}),p=H(()=>n.getEditCanvasConfig.chartThemeSetting);return(_,i)=>(w(),z("div",$n,[(w(),$(s(et),{key:e.groupData.id,"data-id":e.groupData.id,index:e.groupIndex,item:e.groupData,hiddenPoint:!0,class:de(s(Qe)(e.groupData.styles.animations)),style:ne(Y(Y(Y(Y(Y({},s(Ie)(e.groupData.attr,e.groupIndex)),s(ye)(e.groupData.attr)),s(He)(e.groupData.styles)),s(Ze)(e.groupData.styles)),s(At)(e.groupData.styles))),onClick:i[0]||(i[0]=c=>s(h)(c,e.groupData)),onMousedown:i[1]||(i[1]=c=>s(f)(c,e.groupData)),onMouseenter:i[2]||(i[2]=c=>s(a)(c,e.groupData)),onMouseleave:i[3]||(i[3]=c=>s(o)(c,e.groupData)),onContextmenu:i[4]||(i[4]=c=>s(t)(c,e.groupData,y))},{default:A(()=>[(w(!0),z(he,null,_e(e.groupData.groupList,c=>(w(),$(s(et),{key:c.id,"data-id":c.id,index:e.groupIndex,item:c,hiddenPoint:!0,style:ne(Y({},s(Ie)(c.attr,e.groupIndex)))},{default:A(()=>[(w(),$(Ce(c.chartConfig.chartKey),{class:de(["edit-content-chart",s(Qe)(c.styles.animations)]),chartConfig:c,themeSetting:s(p),themeColor:s(C),style:ne(Y(Y(Y({},s(ye)(c.attr)),s(He)(c.styles)),s(Ze)(c.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","item","style"]))),128))]),_:1},8,["data-id","index","item","class","style"]))]))}});const Nn={class:"go-edit-align-line"},Kn=ue({__name:"index",setup(e){Ae(d=>({"32d4d33a":s(h)}));const n=ke(),t=re(),a=rt(),o=$e({lineArr:["rowt","rowc","rowb","coll","colc","colr"],select:new Map,sorptioned:{x:!1,y:!1}}),f=d=>d?{left:`${d.x?d.x:0}px`,top:`${d.y?d.y:0}px`}:{},h=H(()=>n.getAppTheme),y=H(()=>a.getChartAlignRange),C=H(()=>t.getEditCanvas[ae.IS_DRAG]),p=(d,g)=>Math.abs(d-g)<=y.value,_=H(()=>t.getTargetChart.selectId),i=H(()=>t.getComponentList[t.fetchTargetIndex()]),c=H(()=>{var d;return((d=i.value)==null?void 0:d.attr)||{}}),u=H(()=>({id:"0",attr:{w:ft(t.getEditCanvasConfig.width),h:ft(t.getEditCanvasConfig.height),x:0,y:0,offsetX:0,offsetY:0,zIndex:0,scaleRatio:1.5,lockScale:!1,disabledHeight:!1,minWidth:50}}));return pe(()=>t.getMousePosition,oe(()=>{try{if(!C.value||_.value.length!==1)return;const d=c.value.w,g=c.value.h,m=c.value.x,E=m+d/2,O=m+d,M=[m,E,O],b=c.value.y,U=b+g/2,G=b+g,q=[b,U,G];o.select.clear(),o.sorptioned.y=!1;const x=t.getComponentList.map(v=>({id:v.id,attr:v.attr}));x.push(u.value),o.lineArr.forEach(v=>{x.forEach(P=>{if(_.value[0]===P.id)return;const K=P.attr.w,T=P.attr.h,R=P.attr.x,r=R+K/2,l=R+K,k=[R,r,l],F=P.attr.y,X=F+T/2,N=F+T,ie=[F,X,N];v.includes("rowt")&&(p(b,F)&&(o.select.set(v,{y:F}),j(i.value,m,F)),p(b,X)&&(o.select.set(v,{y:X}),j(i.value,m,X)),p(b,N)&&(o.select.set(v,{y:N}),j(i.value,m,N))),v.includes("rowc")&&(p(U,F)&&(o.select.set(v,{y:F}),j(i.value,m,F-g/2)),p(U,X)&&(o.select.set(v,{y:X}),j(i.value,m,X-g/2)),p(U,N)&&(o.select.set(v,{y:N}),j(i.value,m,N-g/2))),v.includes("rowb")&&(p(G,F)&&(o.select.set(v,{y:F}),j(i.value,m,F-g)),p(G,X)&&(o.select.set(v,{y:X}),j(i.value,m,X-g)),p(G,N)&&(o.select.set(v,{y:N}),j(i.value,m,N-g))),v.includes("coll")&&(p(m,R)&&(o.select.set(v,{x:R}),j(i.value,R,b)),p(m,r)&&(o.select.set(v,{x:r}),j(i.value,r,b)),p(m,l)&&(o.select.set(v,{x:l}),j(i.value,l,b))),v.includes("colc")&&(p(E,R)&&(o.select.set(v,{x:R}),j(i.value,R-d/2,b)),p(E,r)&&(o.select.set(v,{x:r}),j(i.value,r-d/2,b)),p(E,l)&&(o.select.set(v,{x:l}),j(i.value,l-d/2,b))),v.includes("colr")&&(p(O,R)&&(o.select.set(v,{x:R}),j(i.value,R-d,b)),p(O,r)&&(o.select.set(v,{x:r}),j(i.value,r-d,b)),p(O,l)&&(o.select.set(v,{x:l}),j(i.value,l-d,b)))})})}catch(d){console.log(d)}},200),{deep:!0}),pe(()=>C.value,d=>{d||(o.select.clear(),o.sorptioned.y=!1)}),(d,g)=>(w(),z("div",Nn,[(w(!0),z(he,null,_e(o.lineArr,m=>(w(),z("div",{class:de(["line",[m.includes("row")?"row":"col",o.select.has(m)&&"visible"]]),key:m,style:ne(f(o.select.get(m)))},null,6))),128))]))}});var Yn=le(Kn,[["__scopeId","data-v-41123ead"]]);const Gn=ue({__name:"index",setup(e){return(n,t)=>{const a=I("n-watermark");return w(),$(a,{id:"go-edit-watermark",content:s(Zt),cross:"",selectable:"","font-size":16,"line-height":16,width:500,height:150,"x-offset":12,"y-offset":80,rotate:-15},null,8,["content"])}}});var Xn=le(Gn,[["__scopeId","data-v-e5cd93da"]]);const Rt=e=>(kt("data-v-6aae2e54"),e=e(),Ft(),e),Wn=Rt(()=>W("div",{class:"select-background"},null,-1)),zn=Rt(()=>W("div",{class:"select-border"},null,-1)),jn=[Wn,zn],qn=ue({__name:"index",setup(e){Ae(y=>({bb49f51e:s(f)}));const n=ke(),t=re(),{isSelect:a,scale:o}=Ue(t.getEditCanvas),f=H(()=>n.getAppTheme),h=Q();return pe(()=>t.getMousePosition,y=>{if(!a.value)return;const{startX:C,startY:p,x:_,y:i}=y,c={zIndex:pt,x:0,y:0,w:0,h:0,offsetX:0,offsetY:0,lockScale:!1,scaleRatio:1.5,disabledHeight:!1,minWidth:50};_>C&&i>p?(c.x=C,c.y=p,c.w=Math.round((_-C)/o.value),c.h=Math.round((i-p)/o.value)):_>C&&i<p?(c.x=C,c.w=Math.round((_-C)/o.value),c.h=Math.round((p-i)/o.value),c.y=p-c.h):_<C&&i>p?(c.y=p,c.w=Math.round((C-_)/o.value),c.h=Math.round((i-p)/o.value),c.x=C-c.w):(c.w=Math.round((C-_)/o.value),c.h=Math.round((p-i)/o.value),c.x=C-c.w,c.y=p-c.h),h.value=Y(Y({},Ie(c,pt)),ye(c))},{deep:!0}),(y,C)=>s(a)?(w(),z("div",{key:0,class:"go-edit-select",style:ne(h.value)},jn,4)):ce("",!0)}});var Jn=le(qn,[["__scopeId","data-v-6aae2e54"]]);const Vn=ue({__name:"index",setup(e){const n=re(),{getEditCanvasConfig:t,getEditCanvas:a}=Ue(n),o=H(()=>({w:t.value.width,h:t.value.height})),f=H(()=>{const y={transform:`scale(${a.value.scale})`};return Y(Y({},ye(o.value)),y)}),h=H(()=>{const y=a.value.isCreate&&{"z-index":99999};return Y(Y({},ye(o.value)),y)});return(y,C)=>(w(),z("div",{class:"go-edit-range go-transition",style:ne(s(f)),onMousedown:C[0]||(C[0]=p=>s(Bn)(p,void 0))},[at(y.$slots,"default",{},void 0,!0),L(s(Xn)),L(s(Yn)),L(s(Jn)),W("div",{class:"go-edit-range-model",style:ne(s(h))},null,4)],36))}});var Qn=le(Vn,[["__scopeId","data-v-52e445d0"]]),Bt=!!(typeof window!="undefined"&&window.document&&window.document.createElement),tt=!1,nt=!1;try{var qe={get passive(){return tt=!0},get once(){return nt=tt=!0}};Bt&&(window.addEventListener("test",qe,qe),window.removeEventListener("test",qe,!0))}catch(e){}function Zn(e,n,t,a){if(a&&typeof a!="boolean"&&!nt){var o=a.once,f=a.capture,h=t;!nt&&o&&(h=t.__once||function y(C){this.removeEventListener(n,y,f),t.call(this,C)},t.__once=h),e.addEventListener(n,h,tt?a:f)}e.addEventListener(n,t,a)}function es(e,n,t,a){var o=a&&typeof a!="boolean"?a.capture:a;e.removeEventListener(n,t,o),t.__once&&e.removeEventListener(n,t.__once,o)}function _t(e,n,t,a){return Zn(e,n,t,a),function(){es(e,n,t,a)}}var mt=new Date().getTime();function ts(e){var n=new Date().getTime(),t=Math.max(0,16-(n-mt)),a=setTimeout(e,t);return mt=n,a}var ns=["","webkit","moz","o","ms"],Ct=ts,yt=function(n,t){return n+(n?t[0].toUpperCase()+t.substr(1):t)+"AnimationFrame"};Bt&&ns.some(function(e){var n=yt(e,"request");return n in window&&(yt(e,"cancel"),Ct=function(a){return window[n](a)}),!!Ct});Function.prototype.bind.call(Function.prototype.call,[].slice);Function.prototype.bind.call(Function.prototype.call,[].slice);const ss={class:"go-sketch-rule"},os={key:1,class:"fix-edit-screens-block"},as=ue({__name:"index",setup(e){Ae(T=>({"6f694401":s(U),ed8dd9a8:s(M),"58b617f4":c.value}));const n=re(),t=Xt(),a=ke(),o=20;let f=[0,0],h=[0,0];const y=Q(),C=Q(!0),p=Q(),_=Q(),i=Q(!1),c=Q("auto"),{width:u,height:d}=Ue(n.getEditCanvasConfig),g=Q(0),m=Q(0),E=$e({h:[],v:[]}),O=H(()=>n.getEditCanvas.scale),M=H(()=>`${d.value*2}px`),b=H(()=>a.getDarkTheme?{bgColor:"#18181c",longfgColor:"#4d4d4d",shortfgColor:"#4d4d4d",fontColor:"#4d4d4d",shadowColor:"#18181c",borderColor:"#18181c",cornerActiveColor:"#18181c"}:{}),U=H(()=>a.getAppTheme),G=T=>{if(T.ctrlKey||T.metaKey){T.preventDefault();let R=O.value;if(T.wheelDelta>=0&&O.value<2){R=O.value+.05,n.setScale(R);return}T.wheelDelta<0&&O.value>.1&&(R=O.value-.05,n.setScale(R))}},q=()=>{if(!y.value)return;const T=y.value.getBoundingClientRect(),R=p.value.getBoundingClientRect();g.value=(T.left+o-R.left)/O.value,m.value=(T.top+o-R.top)/O.value},x=T=>{var F,X;if(T.preventDefault(),T.stopPropagation(),T.which==2)i.value=!0;else if(!((F=window.$KeyboardActive)!=null&&F.space))return;(X=document.activeElement)==null||X.blur();const R=T.pageX,r=T.pageY,l=_t(window,"mousemove",N=>{const ie=N.pageX-R,Se=N.pageY-r,[Ne,Fe]=f,[Ke,be]=h;f=[Fe,ie],h=[be,Se],y.value.scrollLeft-=Fe>Ne?Math.abs(Fe-Ne):-Math.abs(Fe-Ne),y.value.scrollTop-=be>Ke?Math.abs(be-Ke):-Math.abs(be-Ke)}),k=_t(window,"mouseup",()=>{l(),k(),f=[0,0],h=[0,0],i.value=!1})},v=()=>{const T=document.getElementById("go-chart-edit-layout");return T?{height:T.clientHeight-25,width:T.clientWidth}:{width:u.value,height:d.value}},P=()=>{C.value=!1,setTimeout(()=>{C.value=!0},10)},K=()=>{const{width:T,height:R}=_.value.getBoundingClientRect(),{width:r,height:l}=v();y.value.scrollLeft=T/2-r/2,y.value.scrollTop=R/2-l/2};return pe(()=>a.getDarkTheme,()=>{P()}),pe(()=>O.value,(T,R)=>{R!==T?(t.setItemUnHandle(Wt.RE_POSITION_CANVAS,!1),q(),setTimeout(()=>{K(),P()},400)):oe(P,20)}),pe(()=>i.value,T=>{c.value=T?"grab":"auto"}),ot(()=>{y.value&&(y.value.addEventListener("wheel",G,{passive:!1}),K())}),Tt(()=>{y.value&&y.value.removeEventListener("wheel",G)}),window.onKeySpacePressHold=T=>{i.value=T},(T,R)=>{const r=I("sketch-rule");return w(),z("div",ss,[C.value?(w(),$(r,{key:0,thick:o,scale:s(O),width:v().width,height:v().height,startX:g.value,startY:m.value,lines:E,palette:s(b)},null,8,["scale","width","height","startX","startY","lines","palette"])):ce("",!0),W("div",{ref_key:"$app",ref:y,class:"edit-screens",onScroll:q},[W("div",{ref_key:"$container",ref:_,class:"edit-screen-container",style:ne({width:s(u)*2+"px"})},[W("div",{ref_key:"refSketchRuleBox",ref:p,class:"canvas",onMousedown:x,style:ne({marginLeft:"-"+(v().width/2-25)+"px"})},[W("div",{style:ne({pointerEvents:i.value?"none":"auto"})},[at(T.$slots,"default",{},void 0,!0)],4)],36)],4)],544),s(a).getDarkTheme?(w(),z("div",os)):ce("",!0)])}}});var rs=le(as,[["__scopeId","data-v-12b70182"]]);const Je={[B.ADD]:"\u65B0\u589E",[B.DELETE]:"\u5220\u9664",[B.UPDATE]:"\u66F4\u65B0",[B.MOVE]:"\u79FB\u52A8",[B.PASTE]:"\u7C98\u8D34",[B.COPY]:"\u590D\u5236",[B.CUT]:"\u526A\u5207",[B.TOP]:"\u7F6E\u9876",[B.BOTTOM]:"\u7F6E\u5E95",[B.UP]:"\u4E0A\u79FB",[B.DOWN]:"\u4E0B\u79FB",[B.GROUP]:"\u6210\u7EC4",[B.UN_GROUP]:"\u89E3\u7EC4",[B.LOCK]:"\u9501\u5B9A",[B.UNLOCK]:"\u89E3\u9501",[B.HIDE]:"\u9690\u85CF",[B.SHOW]:"\u663E\u793A",[Re.CANVAS]:"\u753B\u5E03\u521D\u59CB\u5316"};var us=Array.prototype,cs=us.reverse;function ls(e){return e==null?e:cs.call(e)}var is=ls;const It=e=>(kt("data-v-5a4fd660"),e=e(),Ft(),e),ds={class:"go-flex-items-center"},fs=It(()=>W("span",{class:"btn-text"},"\u5386\u53F2\u8BB0\u5F55",-1)),ps={class:"history-list-box"},hs=["title"],vs=It(()=>W("div",{class:"popover-modal"},null,-1)),gs=ue({__name:"index",setup(e){const{DesktopOutlineIcon:n,PencilIcon:t,TrashIcon:a,CopyIcon:o,LayersIcon:f,DuplicateIcon:h,HelpOutlineIcon:y,LockClosedOutlineIcon:C,LockOpenOutlineIcon:p,EyeOffOutlineIcon:_,EyeOutlineIcon:i}=De.ionicons5,{StackedMoveIcon:c,Carbon3DCursorIcon:u,Carbon3DSoftwareIcon:d}=De.carbon,g=zt(),m=M=>{if(M.targetType===Re.CANVAS)return n;switch(M.actionType){case B.UPDATE:return t;case B.DELETE:return a;case B.PASTE:return o;case B.TOP:return f;case B.BOTTOM:return f;case B.UP:return f;case B.DOWN:return f;case B.MOVE:return c;case B.ADD:return h;case B.GROUP:return u;case B.UN_GROUP:return d;case B.LOCK:return C;case B.UNLOCK:return p;case B.HIDE:return _;case B.SHOW:return i;default:return t}},E=M=>{if(M.targetType===Re.CANVAS)return Je[Re.CANVAS];if(M.actionType===B.GROUP||M.actionType===B.UN_GROUP)return`${Je[M.actionType]}`;if(M.historyData.length)return`${Je[M.actionType]} - ${M.historyData[0].chartConfig.title}`},O=H(()=>{const b=g.getBackStack.map(U=>({label:E(U),icon:m(U)}));return is(b.filter(U=>U.label))});return(M,b)=>{const U=I("n-button"),G=I("n-icon"),q=I("n-text"),x=I("n-scrollbar"),v=I("n-popover"),P=I("n-tooltip");return w(),z("div",ds,[L(v,{class:"edit-history-popover","show-arrow":!1,size:"small",trigger:"click",placement:"top-start"},{trigger:A(()=>[L(U,{class:"mr-10",secondary:"",size:"small",disabled:s(O).length===0},{default:A(()=>[fs]),_:1},8,["disabled"])]),default:A(()=>[W("div",ps,[L(x,{style:{"max-height":"500px"}},{default:A(()=>[(w(!0),z(he,null,_e(s(O),(K,T)=>(w(),z("div",{class:"list-item go-flex-items-center go-ellipsis-1",key:T,title:K.label},[L(G,{class:"item-icon",size:"16",depth:2,component:K.icon},null,8,["component"]),L(q,{depth:"2"},{default:A(()=>[Ee(fe(K.label),1)]),_:2},1024)],8,hs))),128))]),_:1}),vs])]),_:1}),L(P,{trigger:"hover"},{trigger:A(()=>[L(G,{size:"21",depth:3},{default:A(()=>[L(s(y))]),_:1})]),default:A(()=>[W("span",null,"\u6700\u591A\u53EA\u4FDD\u7559"+fe(s(en))+"\u6761\u8BB0\u5F55",1)]),_:1})])}}});var _s=le(gs,[["__scopeId","data-v-5a4fd660"]]);const ms={class:"go-edit-bottom"},Cs=ue({__name:"index",setup(e){Ae(m=>({f3add9fc:o.value}));const{LockClosedOutlineIcon:n,LockOpenOutlineIcon:t}=De.ionicons5,a=ke(),o=Q(a.getAppTheme),f=re(),{lockScale:h,scale:y}=Ue(f.getEditCanvas);let C=[{label:"200%",value:200},{label:"150%",value:150},{label:"100%",value:100},{label:"50%",value:50},{label:"\u81EA\u9002\u5E94",value:0}];const p=Q(""),_=m=>{if(m===0){f.computedScale();return}f.setScale(m/100)},i=()=>{f.setEditCanvas(ae.LOCK_SCALE,!h.value)},c=Q(100),u=m=>`${m}%`,d=m=>{f.setScale(m/100)},g=$e({100:""});return tn(()=>{const m=(y.value*100).toFixed(0);p.value=`${m}%`,c.value=parseInt(m)}),(m,E)=>{const O=I("n-text"),M=I("n-space"),b=I("n-select"),U=I("n-icon"),G=I("n-button"),q=I("n-tooltip"),x=I("n-slider");return w(),z("div",ms,[L(M,null,{default:A(()=>[L(s(_s)),L(O,{id:"keyboard-dress-show",depth:"3"})]),_:1}),L(M,{class:"bottom-ri"},{default:A(()=>[L(An),L(b,{disabled:s(h),class:"scale-btn",value:p.value,"onUpdate:value":[E[0]||(E[0]=v=>p.value=v),_],size:"mini",options:s(C)},null,8,["disabled","value","options"]),L(q,{trigger:"hover"},{trigger:A(()=>[L(G,{onClick:i,text:""},{default:A(()=>[L(U,{class:de(["lock-icon",{color:s(h)}]),size:"18",depth:2},{default:A(()=>[s(h)?(w(),$(s(n),{key:0})):(w(),$(s(t),{key:1}))]),_:1},8,["class"])]),_:1})]),default:A(()=>[W("span",null,fe(s(h)?"\u89E3\u9501":"\u9501\u5B9A")+"\u5F53\u524D\u6BD4\u4F8B",1)]),_:1}),L(x,{class:"scale-slider",value:c.value,"onUpdate:value":[E[1]||(E[1]=v=>c.value=v),d],"default-value":50,min:10,max:200,step:5,"format-tooltip":u,disabled:s(h),marks:g},null,8,["value","disabled","marks"])]),_:1})])}}});var ys=le(Cs,[["__scopeId","data-v-99a534fc"]]);const Es=Ee("\u7CFB\u7EDF\u8BBE\u7F6E"),Ss=ue({__name:"index",props:{modelShow:Boolean},emits:["update:modelShow"],setup(e,{emit:n}){const t=e,{HelpOutlineIcon:a,CloseIcon:o}=De.ionicons5,f=rt(),h=Q(!1),y=$e([{key:ve.ASIDE_ALL_COLLAPSED,value:f.getAsideAllCollapsed,type:"switch",name:"\u83DC\u5355\u6298\u53E0",desc:"\u9996\u9875\u83DC\u5355\u6298\u53E0\u65F6\u9690\u85CF\u81F3\u754C\u9762\u5916"},{key:ve.HIDE_PACKAGE_ONE_CATEGORY,value:f.getHidePackageOneCategory,type:"switch",name:"\u9690\u85CF\u5206\u7C7B",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u8868\u5355\u5206\u7C7B\u53EA\u6709\u5355\u9879\u65F6\u9690\u85CF"},{key:ve.CHANGE_LANG_RELOAD,value:f.getChangeLangReload,type:"switch",name:"\u5207\u6362\u8BED\u8A00",desc:"\u5207\u6362\u8BED\u8A00\u91CD\u65B0\u52A0\u8F7D\u9875\u9762",tip:"\u82E5\u9047\u5230\u90E8\u5206\u533A\u57DF\u8BED\u8A00\u5207\u6362\u5931\u8D25\uFF0C\u5219\u5EFA\u8BAE\u5F00\u542F"},{key:"divider1",type:"divider",name:"",desc:"",value:""},{key:ve.CHART_TOOLS_STATUS_HIDE,value:f.getChartToolsStatusHide,type:"switch",name:"\u9690\u85CF\u5DE5\u5177\u680F",desc:"\u9F20\u6807\u79FB\u5165\u65F6\uFF0C\u4F1A\u5C55\u793A\u5207\u6362\u5230\u5C55\u5F00\u6A21\u5F0F"},{key:ve.CHART_TOOLS_STATUS,value:f.getChartToolsStatus,type:"select",name:"\u5DE5\u5177\u680F\u5C55\u793A",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u5DE5\u5177\u680F\u5C55\u793A\u65B9\u5F0F",options:[{label:"\u4FA7\u8FB9\u680F",value:Pe.ASIDE},{label:"\u5E95\u90E8 Dock",value:Pe.DOCK}]},{key:"divider0",type:"divider",name:"",desc:"",value:""},{key:ve.CHART_MOVE_DISTANCE,value:f.getChartMoveDistance,type:"number",name:"\u79FB\u52A8\u8DDD\u79BB",min:1,step:1,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u65B9\u5411\u952E\u63A7\u5236\u79FB\u52A8\u8DDD\u79BB"},{key:ve.CHART_ALIGN_RANGE,value:f.getChartAlignRange,type:"number",name:"\u5438\u9644\u8DDD\u79BB",min:10,step:2,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u79FB\u52A8\u56FE\u8868\u65F6\u7684\u5438\u9644\u8DDD\u79BB"}]);pe(()=>t.modelShow,_=>{h.value=_});const C=()=>{n("update:modelShow",!1)},p=(_,i)=>{f.setItem(i.key,i.value)};return(_,i)=>{const c=I("n-h3"),u=I("n-icon"),d=I("n-space"),g=I("n-divider"),m=I("n-text"),E=I("n-switch"),O=I("n-input-number"),M=I("n-select"),b=I("n-tooltip"),U=I("n-list-item"),G=I("n-list"),q=I("n-modal");return w(),$(q,{show:h.value,"onUpdate:show":i[0]||(i[0]=x=>h.value=x),onAfterLeave:C},{default:A(()=>[L(G,{bordered:"",class:"go-system-setting"},{header:A(()=>[L(d,{justify:"space-between"},{default:A(()=>[L(c,{class:"go-mb-0"},{default:A(()=>[Es]),_:1}),L(u,{size:"20",class:"go-cursor-pointer",onClick:C},{default:A(()=>[L(s(o))]),_:1})]),_:1})]),default:A(()=>[(w(!0),z(he,null,_e(y,x=>(w(),$(U,{key:x.key},{default:A(()=>[x.type==="divider"?(w(),$(g,{key:0,style:{margin:"0"}})):(w(),$(d,{key:1,size:40},{default:A(()=>[L(d,null,{default:A(()=>[L(m,{class:"item-left"},{default:A(()=>[Ee(fe(x.name),1)]),_:2},1024),x.type==="switch"?(w(),$(E,{key:0,value:x.value,"onUpdate:value":[v=>x.value=v,v=>p(v,x)],size:"small"},null,8,["value","onUpdate:value"])):x.type==="number"?(w(),$(O,{key:1,value:x.value,"onUpdate:value":[v=>x.value=v,v=>p(v,x)],class:"input-num-width",size:"small",step:x.step||null,suffix:x.suffix||null,min:x.min||0},null,8,["value","onUpdate:value","step","suffix","min"])):x.type==="select"?(w(),$(M,{key:2,class:"select-min-width",value:x.value,"onUpdate:value":[v=>x.value=v,v=>p(v,x)],size:"small",options:x.options},null,8,["value","onUpdate:value","options"])):ce("",!0)]),_:2},1024),L(d,null,{default:A(()=>[L(m,{class:"item-right"},{default:A(()=>[Ee(fe(x.desc),1)]),_:2},1024),x.tip?(w(),$(b,{key:0,trigger:"hover"},{trigger:A(()=>[L(u,{size:"21"},{default:A(()=>[L(s(a))]),_:1})]),default:A(()=>[W("span",null,fe(x.tip),1)]),_:2},1024)):ce("",!0)]),_:2},1024)]),_:2},1024))]),_:2},1024))),128))]),_:1})]),_:1},8,["show"])}}});var ws=le(Ss,[["__scopeId","data-v-7cea0aa5"]]);const xe=re(),Ts=()=>{xe.setTargetSelectChart(void 0),nn(sn(xe.getStorageInfo||[]),void 0,"json");const e=document.querySelector(".go-edit-range"),n=document.getElementById("go-edit-watermark");if(!e||!n){window.$message.error("\u5BFC\u51FA\u5931\u8D25\uFF01");return}const t=xe.getEditCanvas.scale;xe.setScale(1,!0),n.style.display="block",setTimeout(()=>{on(e,()=>{n&&(n.style.display="none"),xe.setScale(t,!0)})},600)};var st=(e=>(e.TXT="text/plain",e.JSON="application/json",e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e))(st||{});const xs=()=>{const e=Q(),{updateComponent:n}=wt();return{importUploadFileListRef:e,importBeforeUpload:({file:o})=>{e.value=[];const f=o.file.type;return f!==st.JSON&&f!==st.TXT?(window.$message.warning("\u4EC5\u652F\u6301\u4E0A\u4F20 \u3010JSON\u3011 \u683C\u5F0F\u6587\u4EF6\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20\uFF01"),!1):!0},importCustomRequest:o=>{const{file:f}=o;an(()=>{f.file?rn(f.file).then(h=>{_n({message:"\u8BF7\u9009\u62E9\u5BFC\u5165\u65B9\u5F0F:",positiveText:"\u65B0\u589E\uFF08\u53EF\u64A4\u56DE\uFF09",negativeText:"\u8986\u76D6\uFF08\u4E0D\u53EF\u64A4\u56DE\uFF09",negativeButtonProps:{type:"info",ghost:!1},onPositiveCallback:()=>we(void 0,null,function*(){try{h=Ve(h),yield n(h,!1,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(y){console.log(y),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}}),onNegativeCallback:()=>we(void 0,null,function*(){try{h=Ve(h),yield n(h,!0,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(y){console.log(y),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}})})}):window.$message.error("\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u6216\u8054\u7CFB\u7BA1\u7406\u5458\uFF01")})}}},{updateComponent:Ds,dataSyncUpdate:Et}=wt(),As=re(),ks=()=>{const e=f=>Ds(f.detail,!0,!1),n=()=>we(void 0,null,function*(){Et&&(yield Et()),dispatchEvent(new CustomEvent(Xe.CHART,{detail:As.getStorageInfo}))}),t=()=>{addEventListener("blur",n),addEventListener(Xe.JSON,e)},a=()=>{removeEventListener(Xe.JSON,e),removeEventListener("blur",n)};return(f,h)=>{h==ht.CHART_HOME_NAME&&a(),f==ht.CHART_HOME_NAME&&t()}},Fs=()=>{const e=bt();pe(()=>e.name,ks(),{immediate:!0})};var ge=(e=>(e.BUTTON="button",e.IMPORTUPLOAD="importUpload",e))(ge||{});const bs={class:"btn-item"},Os=ue({__name:"index",setup(e){const{DownloadIcon:n,ShareIcon:t,PawIcon:a,SettingsSharpIcon:o,CreateIcon:f}=De.ionicons5,h=rt(),y=re();bt(),Fs();let C=null;const p=Q(!1),_=Q(!0),i=Q(!0),{importUploadFileListRef:c,importCustomRequest:u,importBeforeUpload:d}=xs(),g=H(()=>h.getChartToolsStatus===Pe.ASIDE),m=H(()=>h.getChartToolsStatusHide),E=H(()=>_.value&&m.value),O=H(()=>{if(!g.value)return q;const x=[];return q.map(v=>{x.unshift(v)}),x}),M=()=>{C=setTimeout(()=>{_.value&&(_.value=!1,i.value=!0)},200),setTimeout(()=>{i.value=!1},400)},b=()=>{clearTimeout(C),_.value||(_.value=!0)},U=()=>{window.$message.warning("\u5C06\u5F00\u542F\u5931\u7126\u66F4\u65B0\uFF01"),setTimeout(()=>{const x=cn(ln.CHART_EDIT_NAME,"href");if(!x)return;const v=dn();G(v),fn(x,[v],void 0,!0)},1e3)},G=x=>{const v=y.getStorageInfo,P=pn(Oe.GO_CHART_STORAGE_LIST)||[];if(P!=null&&P.length){const K=P.findIndex(T=>T.id===x);K!==-1?(P.splice(K,1,me(Y({},v),{id:x})),je(Oe.GO_CHART_STORAGE_LIST,P)):(P.push(me(Y({},v),{id:x})),je(Oe.GO_CHART_STORAGE_LIST,P))}else je(Oe.GO_CHART_STORAGE_LIST,[me(Y({},v),{id:x})])},q=[{key:"import",type:ge.IMPORTUPLOAD,name:"\u5BFC\u5165",icon:t},{key:"export",type:ge.BUTTON,name:"\u5BFC\u51FA",icon:n,handle:Ts},{key:"edit",type:ge.BUTTON,name:"\u7F16\u8F91",icon:f,handle:U},{key:"setting",type:ge.BUTTON,name:"\u8BBE\u7F6E",icon:o,handle:()=>{p.value=!0}}];return(x,v)=>{const P=I("n-icon"),K=I("n-text"),T=I("n-button"),R=I("n-upload"),r=I("n-tooltip");return w(),z(he,null,[W("div",{class:de(["go-chart-edit-tools",[s(h).getChartToolsStatus,s(E)?"isMini":"unMini"]]),onClick:v[1]||(v[1]=l=>_.value&&(_.value=!1)),onMouseenter:M,onMouseleave:b},[We(L(P,{class:"asideLogo",size:"22"},{default:A(()=>[L(s(a))]),_:1},512),[[ze,s(h).getChartToolsStatus===s(Pe).ASIDE&&s(E)]]),(w(!0),z(he,null,_e(s(O),(l,k)=>(w(),$(r,{key:l.key,disabled:!s(g)||s(m)&&i.value,trigger:"hover",placement:"left"},{trigger:A(()=>[W("div",bs,[l.type===s(ge).BUTTON?(w(),$(T,{key:0,circle:s(g),secondary:"",onClick:l.handle},{icon:A(()=>[s(g)?(w(),$(P,{key:0,size:"22"},{default:A(()=>[(w(),$(Ce(l.icon)))]),_:2},1024)):(w(),$(Ce(l.icon),{key:1}))]),default:A(()=>[We(L(K,{depth:"3"},{default:A(()=>[Ee(fe(l.name),1)]),_:2},1536),[[ze,!s(g)]])]),_:2},1032,["circle","onClick"])):l.type===s(ge).IMPORTUPLOAD?(w(),$(R,{key:1,"file-list":s(c),"onUpdate:file-list":v[0]||(v[0]=F=>un(c)?c.value=F:null),"show-file-list":!1,customRequest:s(u),onBeforeUpload:s(d)},{default:A(()=>[L(T,{circle:s(g),secondary:""},{icon:A(()=>[s(g)?(w(),$(P,{key:0,size:"22"},{default:A(()=>[(w(),$(Ce(l.icon)))]),_:2},1024)):(w(),$(Ce(l.icon),{key:1}))]),default:A(()=>[We(L(K,{depth:"3"},{default:A(()=>[Ee(fe(l.name),1)]),_:2},1536),[[ze,!s(g)]])]),_:2},1032,["circle"])]),_:2},1032,["file-list","customRequest","onBeforeUpload"])):ce("",!0)])]),default:A(()=>[W("span",null,fe(l.name),1)]),_:2},1032,["disabled"]))),128))],34),L(s(ws),{modelShow:p.value,"onUpdate:modelShow":v[2]||(v[2]=l=>p.value=l)},null,8,["modelShow"])],64)}}});var Ls=le(Os,[["__scopeId","data-v-4c257f27"]]);const Ms=ue({__name:"index",setup(e){const n=re(),{handleContextMenu:t}=ut();kn();const{mouseenterHandle:a,mouseleaveHandle:o,mousedownHandle:f,mouseClickHandle:h}=Mt(),y=(i,c,u)=>{if(n.getTargetChart.selectId.length>1)return c.filter(g=>[D.GROUP,D.DELETE].includes(g.key));const d=[];return u.status.lock?d.push(D.LOCK):d.push(D.UNLOCK),u.status.hide?d.push(D.HIDE):d.push(D.SHOW),i.filter(g=>!d.includes(g.key))},C=H(()=>n.getEditCanvasConfig.chartThemeSetting),p=H(()=>{const i=n.getEditCanvasConfig.chartThemeColor;return St[i]});H(()=>n.getEditCanvasConfig.filterShow);const _=H(()=>{const i=n.getEditCanvasConfig.background,c=n.getEditCanvasConfig.backgroundImage,g=n.getEditCanvasConfig.selectColor?{background:i||void 0}:{background:`url(${c}) no-repeat center center / cover !important`};return me(Y({},g),{width:"inherit",height:"inherit"})});return ot(()=>{Ln()}),(i,c)=>(w(),$(s(Dn),{id:"go-chart-edit-layout",flex:!0,showTop:!1,showBottom:!0,depth:1,xScroll:!0,disabledScroll:!0,onMousedown:s(Lt),onDrop:s(Rn),onDragover:s(gt),onDragenter:s(gt)},{aside:A(()=>[L(s(Ls))]),bottom:A(()=>[L(s(ys))]),default:A(()=>[L(s(rs),null,{default:A(()=>[W("div",{id:"go-chart-edit-content",onContextmenu:c[0]||(c[0]=(...u)=>s(t)&&s(t)(...u))},[L(s(Qn),null,{default:A(()=>[W("div",{style:ne(Y(Y({},s(He)(s(n).getEditCanvasConfig)),s(_)))},[(w(!0),z(he,null,_e(s(n).getComponentList,(u,d)=>(w(),z("div",{key:u.id},[u.isGroup?(w(),$(s(Un),{key:0,groupData:u,groupIndex:d},null,8,["groupData","groupIndex"])):(w(),$(s(et),{key:1,"data-id":u.id,index:d,style:ne(Y(Y({},s(Ie)(u.attr,d)),s(At)(u.styles))),item:u,onClick:g=>s(h)(g,u),onMousedown:g=>s(f)(g,u),onMouseenter:g=>s(a)(g,u),onMouseleave:g=>s(o)(g,u),onContextmenu:g=>s(t)(g,u,y)},{default:A(()=>{var g,m,E,O;return[s(mn)(u)&&!((g=u.option)!=null&&g.isDeleted)?(w(),$(s(jt),{key:0,title:s(Cn)(u),attr:u.attr,titleSize:s(yn)(u),titleStyle:s(En)(u)},null,8,["title","attr","titleSize","titleStyle"])):ce("",!0),s(Sn)(u)&&!((m=u.option)!=null&&m.isDeleted)?(w(),$(s(qt),{key:1,class:"filter-content",componentIdx:u.id,attr:u.attr,filters:u.chartConfig.filters,type:u.chartConfig.category},null,8,["componentIdx","attr","filters","type"])):ce("",!0),(E=u.option)!=null&&E.isDeleted?(w(),$(s(wn),{key:2,item:u,style:ne(me(Y({},s(it)(u.attr,0)),{lineHeight:u.attr.h+"px"}))},null,8,["item","style"])):ce("",!0),(O=u.option)!=null&&O.isDeleted?ce("",!0):(w(),$(Ce(u.chartConfig.chartKey),{key:3,class:de(["edit-content-chart",s(Qe)(u.styles.animations)]),chartConfig:u,themeSetting:s(C),themeColor:s(p),style:ne(Y(Y(Y({},s(it)(u.attr,s(Tn)(u)+s(xn)(u))),s(He)(u.styles)),s(Ze)(u.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]}),_:2},1032,["data-id","index","style","item","onClick","onMousedown","onMouseenter","onMouseleave","onContextmenu"]))]))),128))],4)]),_:1})],32)]),_:1})]),_:1},8,["onMousedown","onDrop","onDragover","onDragenter"]))}});var Ws=le(Ms,[["__scopeId","data-v-f20efb74"]]);export{Ws as default};
