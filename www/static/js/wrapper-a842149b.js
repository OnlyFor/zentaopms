var te=Object.defineProperty,ne=Object.defineProperties;var oe=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var W=(e,t,n)=>t in e?te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,u=(e,t)=>{for(var n in t||(t={}))se.call(t,n)&&W(e,n,t[n]);if(T)for(var n of T(t))ie.call(t,n)&&W(e,n,t[n]);return e},P=(e,t)=>ne(e,oe(t));var F=(e,t,n)=>new Promise((s,i)=>{var a=d=>{try{l(n.next(d))}catch(o){i(o)}},r=d=>{try{l(n.throw(d))}catch(o){i(o)}},l=d=>d.done?s(d.value):Promise.resolve(d.value).then(a,r);l((n=n.apply(e,t)).next())});import{g as re}from"./storage-636f3f7b.js";import{aG as _,bT as ae,d as R,h as w,A as B,F as b,o as h,ad as E,f as c,bU as V,aP as m,bV as $,bW as j,bX as A,c as p,bY as U,bZ as q,L as G,p as L,q as v,a5 as C,x as k,a9 as I,z as f,b_ as g,a6 as S,e as z,al as ce,b$ as H,c0 as de,S as le}from"./index.js";import{t as x,u as X,c as ue,d as he,O as we,F as pe,b as ve,l as ge}from"./useSync.hook-11ebbc2f.js";import{i as ye,g as fe,a as _e,h as Se,o as me,f as Ce}from"./useItem.hook-a34707ac.js";import"./plugin-ab4d6157.js";import"./icon-65308562.js";import"./tables_list-38e71280.js";const Re=(e,t,n,s)=>{const i=e,a=t,r={width:1,height:1},l=parseFloat((i/a).toFixed(5)),d=()=>{const ee=parseFloat((window.innerWidth/window.innerHeight).toFixed(5));n&&(ee>l?(r.width=parseFloat((window.innerHeight*l/i).toFixed(5)),r.height=parseFloat((window.innerHeight/a).toFixed(5)),n.style.transform=`scale(${r.width}, ${r.height})`):(r.height=parseFloat((window.innerWidth/l/a).toFixed(5)),r.width=parseFloat((window.innerWidth/i).toFixed(5)),n.style.transform=`scale(${r.width}, ${r.height})`),s&&s(r))},o=x(()=>{d()},200);return{calcRate:d,windowResize:()=>{window.addEventListener("resize",o)},unWindowResize:()=>{window.removeEventListener("resize",o)}}},xe=(e,t,n,s)=>{const i=e,a=t,r={width:1,height:1},l=parseFloat((i/a).toFixed(5)),d=()=>{n&&(r.height=parseFloat((window.innerWidth/l/a).toFixed(5)),r.width=parseFloat((window.innerWidth/i).toFixed(5)),n.style.transform=`scale(${r.width}, ${r.height})`,s&&s(r))},o=x(()=>{d()},200);return{calcRate:d,windowResize:()=>{window.addEventListener("resize",o)},unWindowResize:()=>{window.removeEventListener("resize",o)}}},Fe=(e,t,n,s)=>{const i=e,a=t,r={height:1,width:1},l=parseFloat((i/a).toFixed(5)),d=()=>{n&&(r.width=parseFloat((window.innerHeight*l/i).toFixed(5)),r.height=parseFloat((window.innerHeight/a).toFixed(5)),n.style.transform=`scale(${r.width}, ${r.height})`,s&&s(r))},o=x(()=>{d()},200);return{calcRate:d,windowResize:()=>{window.addEventListener("resize",o)},unWindowResize:()=>{window.removeEventListener("resize",o)}}},ze=(e,t,n,s)=>{const i={width:1,height:1},a=()=>{n&&(i.width=parseFloat((window.innerWidth/e).toFixed(5)),i.height=parseFloat((window.innerHeight/t).toFixed(5)),n.style.transform=`scale(${i.width}, ${i.height})`,s&&s(i))},r=x(()=>{a()},200);return{calcRate:a,windowResize:()=>{window.addEventListener("resize",r)},unWindowResize:()=>{window.removeEventListener("resize",r)}}},Y={},N={echarts:ae},K=e=>{if(!e.events)return{};const t={};for(const i in e.events.baseEvent){const a=e.events.baseEvent[i];a&&(t[i]=be(a))}const n=e.events.advancedEvents||{},s={[_.VNODE_BEFORE_MOUNT](i){Y[e.id]=i.component;const a=(n[_.VNODE_BEFORE_MOUNT]||"").trim();D(a,i)},[_.VNODE_MOUNTED](i){const a=(n[_.VNODE_MOUNTED]||"").trim();D(a,i)}};return u(u({},t),s)};function be(e){try{return new Function(`
      return (
        async function(mouseEvent){
          ${e}
        }
      )`)()}catch(t){console.error(t)}}function D(e,t){try{Function(`
      "use strict";
      return (
        async function(e, components, node_modules){
          const {${Object.keys(N).join()}} = node_modules;
          ${e}
        }
      )`)().bind(t==null?void 0:t.component)(t,Y,N)}catch(n){console.error(n)}}const J=(e,t)=>({zIndex:t+1,left:`${e.x}px`,top:`${e.y}px`}),Ee=(e,t)=>({width:`${t?t*e.w:e.w}px`,height:`${t?t*e.h:e.h}px`}),$e=(e,t,n)=>e?{width:`${n?n*e.w:e.w}px`,height:`${n?n*e.h-t:e.h-t}px`}:{},Z=e=>({display:e.hide?"none":"block"}),Q=e=>{const t={};return e&&e.overFlowHidden&&(t.overflow="hidden"),t},Le=e=>{const t=e.selectColor?{background:e.background}:{background:`url(${e.backgroundImage}) center center / cover no-repeat !important`};return u({position:"relative",width:e.width?`${e.width||100}px`:"100%",height:e.height?`${e.height}px`:"100%"},t)};const ke=R({__name:"index",props:{groupData:{type:Object,required:!0},themeSetting:{type:Object,required:!0},themeColor:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){return(t,n)=>(h(!0),w(b,null,B(e.groupData.groupList,s=>(h(),w("div",{class:E(["chart-item",c(V)(s.styles.animations)]),key:s.id,style:m(u(u(u(u(u(u({},c(J)(s.attr,e.groupIndex)),c($)(s.styles)),c(j)(s.styles)),c(Z)(s.status)),c(Q)(s.preview)),c(A)(s.styles)))},[(h(),p(G(s.chartConfig.chartKey),U({id:s.id,chartConfig:s,themeSetting:e.themeSetting,themeColor:e.themeColor,style:u({},c(Ee)(s.attr))},q(c(K)(s))),null,16,["id","chartConfig","themeSetting","themeColor","style"]))],6))),128))}});var Oe=L(ke,[["__scopeId","data-v-3933053a"]]);const Te=R({__name:"index",setup(e){const t=v(!1),{initDataPond:n,clearMittDataPondMap:s}=ue(),i=X(),a=C(()=>i.editCanvasConfig.chartThemeSetting),r=C(()=>{const l=i.editCanvasConfig.chartThemeColor;return he[l]});return s(),k(()=>{n(i.requestGlobalConfig)}),(l,d)=>(h(!0),w(b,null,B(c(i).componentList,(o,y)=>(h(),w("div",{key:o.id,class:"chart-item",style:m(u(u(u(u(u(u({},c(J)(o.attr,y)),c($)(o.styles)),c(j)(o.styles)),c(Z)(o.status)),c(Q)(o.preview)),c(A)(o.styles)))},[c(ye)(o)?(h(),p(c(we),{key:0,title:c(fe)(o),attr:o.attr,titleSize:c(_e)(o)},null,8,["title","attr","titleSize"])):I("",!0),c(Se)(o)?(h(),p(c(pe),{key:1,class:"filter-content",componentIdx:o.id,attr:o.attr,filters:o.chartConfig.filters,type:o.chartConfig.category},null,8,["componentIdx","attr","filters","type"])):I("",!0),f("div",{class:E(c(V)(o.styles.animations))},[o.isGroup?(h(),p(c(Oe),{key:0,groupData:o,groupIndex:y,themeSetting:a.value,themeColor:r.value},null,8,["groupData","groupIndex","themeSetting","themeColor"])):(h(),p(G(o.chartConfig.chartKey),U({key:1,id:o.id,chartConfig:o,themeSetting:a.value,themeColor:r.value,style:u({},c($e)(o.attr,c(me)(o)+c(Ce)(o))),scrollMode:t.value?"manual":"auto"},q(c(K)(o))),null,16,["id","chartConfig","themeSetting","themeColor","style","scrollMode"]))],2)],4))),128))}});var M=L(Te,[["__scopeId","data-v-6cab8b90"]]);const We=e=>{const t=v(),n=v(),s=v(e.editCanvasConfig.width),i=v(e.editCanvasConfig.height);return k(()=>{switch(e.editCanvasConfig.previewScaleType){case g.FIT:(()=>{const{calcRate:a,windowResize:r,unWindowResize:l}=Re(s.value,i.value,n.value);a(),r(),S(()=>{l()})})();break;case g.SCROLL_Y:(()=>{const{calcRate:a,windowResize:r,unWindowResize:l}=xe(s.value,i.value,n.value,d=>{const o=t.value;o.style.width=`${s.value*d.width}px`,o.style.height=`${i.value*d.height}px`});a(),r(),S(()=>{l()})})();break;case g.SCROLL_X:(()=>{const{calcRate:a,windowResize:r,unWindowResize:l}=Fe(s.value,i.value,n.value,d=>{const o=t.value;o.style.width=`${s.value*d.width}px`,o.style.height=`${i.value*d.height}px`});a(),r(),S(()=>{l()})})();break;case g.FULL:(()=>{const{calcRate:a,windowResize:r,unWindowResize:l}=ze(s.value,i.value,n.value);a(),r(),S(()=>{l()})})();break}}),{entityRef:t,previewRef:n}};const Pe=R({__name:"index",setup(e){const{dataSyncFetch:t}=ve(),n=X(),s=ge(()=>ce(()=>import("./index-60730383.js"),["static/js/index-60730383.js","static/js/useSync.hook-11ebbc2f.js","static/css/useSync.hook-04a696d6.css","static/js/index.js","static/css/index-a1e82c00.css","static/js/plugin-ab4d6157.js","static/js/icon-65308562.js","static/js/tables_list-38e71280.js"])),i=C(()=>u(u({},Le(n.editCanvasConfig)),$(n.editCanvasConfig))),a=C(()=>{const d=n.editCanvasConfig.previewScaleType;return d===g.SCROLL_Y||d===g.SCROLL_X}),{entityRef:r,previewRef:l}=We(n.getStorageInfo);return k(()=>F(this,null,function*(){yield t("preview")})),(d,o)=>(h(),w(b,null,[f("div",{class:E(`go-preview ${c(n).editCanvasConfig.previewScaleType}`)},[a.value?(h(),w("div",{key:0,ref_key:"entityRef",ref:r,class:"go-preview-entity"},[f("div",{ref_key:"previewRef",ref:l,class:"go-preview-scale"},[f("div",{style:m(i.value)},[z(c(M))],4)],512)],512)):(h(),w("div",{key:1,ref_key:"previewRef",ref:l,class:"go-preview-scale"},[f("div",{style:m(i.value)},[z(c(M))],4)],512))],2),z(c(s))],64))}});var Ie=L(Pe,[["__scopeId","data-v-187c9882"]]);const Ue=R({__name:"wrapper",setup(e){let t=v(Date.now());return[H.JSON,H.CHART].forEach(n=>{!window.opener||window.opener.addEventListener(n,s=>F(this,null,function*(){const i=yield re();de(le.GO_CHART_STORAGE_LIST,[P(u({},s.detail),{id:i.id})]),t.value=Date.now()}))}),(n,s)=>(h(),p(Ie,{key:c(t)}))}});export{Ue as default};
